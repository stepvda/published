var on=Object.defineProperty,an=Object.defineProperties,sn=Object.getOwnPropertyDescriptors,Qe=Object.getOwnPropertySymbols,un=Object.prototype.hasOwnProperty,cn=Object.prototype.propertyIsEnumerable,tn=(Ut,zt,Yt)=>zt in Ut?on(Ut,zt,{enumerable:!0,configurable:!0,writable:!0,value:Yt}):Ut[zt]=Yt,Qt=(Ut,zt)=>{for(var Yt in zt||(zt={}))un.call(zt,Yt)&&tn(Ut,Yt,zt[Yt]);if(Qe)for(var Yt of Qe(zt))cn.call(zt,Yt)&&tn(Ut,Yt,zt[Yt]);return Ut},Ie=(Ut,zt)=>an(Ut,sn(zt));(self.webpackChunkng_rolls_2=self.webpackChunkng_rolls_2||[]).push([[429],{5948:(Ut,zt,Yt)=>{"use strict";const he="undefined"!=typeof globalThis&&globalThis,ve="undefined"!=typeof window&&window,Kt="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,E=he||"undefined"!=typeof global&&global||ve||Kt,b=function(P,...q){if(b.translate){const tt=b.translate(P,q);P=tt[0],q=tt[1]}let Q=l(P[0],P.raw[0]);for(let tt=1;tt<P.length;tt++)Q+=q[tt-1]+l(P[tt],P.raw[tt]);return Q};function l(P,q){return":"===q.charAt(0)?P.substring(function o(P,q){for(let Q=1,tt=1;Q<P.length;Q++,tt++)if("\\"===q[tt])tt++;else if(":"===P[Q])return Q;throw new Error(`Unterminated $localize metadata block in "${q}".`)}(P,q)+1):P}E.$localize=b,Yt(2546),Yt(609);const d=P=>.5*(1-Math.cos(Math.PI*P)),c=()=>"scrollBehavior"in document.documentElement.style,a={_elementScroll:void 0,get elementScroll(){return this._elementScroll||(this._elementScroll=HTMLElement.prototype.scroll||HTMLElement.prototype.scrollTo||function(P,q){this.scrollLeft=P,this.scrollTop=q})},_elementScrollIntoView:void 0,get elementScrollIntoView(){return this._elementScrollIntoView||(this._elementScrollIntoView=HTMLElement.prototype.scrollIntoView)},_windowScroll:void 0,get windowScroll(){return this._windowScroll||(this._windowScroll=window.scroll||window.scrollTo)}},n=P=>{[HTMLElement.prototype,SVGElement.prototype,Element.prototype].forEach(Q=>P(Q))},p=()=>{var P,q,Q;return null!==(Q=null===(q=null===(P=window.performance)||void 0===P?void 0:P.now)||void 0===q?void 0:q.call(P))&&void 0!==Q?Q:Date.now()},u=P=>{const Q=(p()-P.timeStamp)/(P.duration||500);if(Q>1)return P.method(P.targetX,P.targetY),void P.callback();const tt=(P.timingFunc||d)(Q);P.method(P.startX+(P.targetX-P.startX)*tt,P.startY+(P.targetY-P.startY)*tt),P.rafId=requestAnimationFrame(()=>{u(P)})},m=P=>isFinite(P)?Number(P):0,t=P=>{const q=typeof P;return null!==P&&("object"===q||"function"===q)},r=(P,q)=>{var Q,tt;const ut=a.elementScroll.bind(P);if(void 0===q.left&&void 0===q.top)return;const pt=P.scrollLeft,xt=P.scrollTop,qt=m(null!==(Q=q.left)&&void 0!==Q?Q:pt),te=m(null!==(tt=q.top)&&void 0!==tt?tt:xt);if("smooth"!==q.behavior)return ut(qt,te);const ne=()=>{window.removeEventListener("wheel",de),window.removeEventListener("touchmove",de)},re={timeStamp:p(),duration:q.duration,startX:pt,startY:xt,targetX:qt,targetY:te,rafId:0,method:ut,timingFunc:q.timingFunc,callback:ne},de=()=>{cancelAnimationFrame(re.rafId),ne()};window.addEventListener("wheel",de,{passive:!0,once:!0}),window.addEventListener("touchmove",de,{passive:!0,once:!0}),u(re)},A=(P,q)=>{const Q=m(q.left||0)+P.scrollLeft,tt=m(q.top||0)+P.scrollTop;return r(P,Ie(Qt({},q),{left:Q,top:tt}))},k=(P,q,Q,tt,ut,pt,xt,qt)=>pt<P&&xt>q||pt>P&&xt<q?0:pt<=P&&qt<=Q||xt>=q&&qt>=Q?pt-P-tt:xt>q&&qt<Q||pt<P&&qt>Q?xt-q+ut:0,O=P=>"visible"!==P&&"clip"!==P,R=(P,q)=>(P.clientHeight<P.scrollHeight||P.clientWidth<P.scrollWidth)&&(O(q.overflowY)||O(q.overflowX)||(P=>{const q=(P=>{if(!P.ownerDocument||!P.ownerDocument.defaultView)return null;try{return P.ownerDocument.defaultView.frameElement}catch(q){return null}})(P);return!!q&&(q.clientHeight<P.scrollHeight||q.clientWidth<P.scrollWidth)})(P)),T=P=>{const q=P.parentNode;return null!==q&&q.nodeType===Node.DOCUMENT_FRAGMENT_NODE?q.host:q},C=(P,q)=>P<-q?-q:P>q?q:P,x=P=>P in document.documentElement.style,ft=(P,q)=>{if(!1===P.isConnected)return;const Q=document.scrollingElement||document.documentElement,tt=[],ut=getComputedStyle(document.documentElement);for(let Ot=T(P);null!==Ot;Ot=T(Ot)){if(Ot===Q){tt.push(Ot);break}const be=getComputedStyle(Ot);if((Ot!==document.body||!R(Ot,be)||R(document.documentElement,ut))&&(R(Ot,be)&&tt.push(Ot),"fixed"===be.position))break}const pt=window.visualViewport?window.visualViewport.width:innerWidth,xt=window.visualViewport?window.visualViewport.height:innerHeight,qt=window.scrollX||window.pageXOffset,te=window.scrollY||window.pageYOffset,ne=getComputedStyle(P),[re,de,ke,Ce]=((P,q)=>{const{top:Q,right:tt,bottom:ut,left:pt}=P.getBoundingClientRect(),[xt,qt,te,ne]=["top","right","bottom","left"].map(re=>{const de=["scroll-margin","scroll-snap-margin"].filter(x)[0],ke=q.getPropertyValue(`${de}-${re}`);return parseInt(ke,10)||0});return[Q-xt,tt+qt,ut+te,pt-ne]})(P,ne),me=ke-re,_e=de-Ce,Ue=(P=>{switch(P){case"horizontal-tb":case"lr":case"lr-tb":case"rl":case"rl-tb":return 0;case"vertical-rl":case"tb":case"tb-rl":return 1;case"vertical-lr":case"tb-lr":return 2;case"sideways-rl":return 3;case"sideways-lr":return 4}return 0})(ne.writingMode||ne.getPropertyValue("-webkit-writing-mode")||ne.getPropertyValue("-ms-writing-mode")),ye="rtl"!==ne.direction,[Me,Be]=((P,q,Q)=>{let[tt,ut]=[P.block||"start",P.inline||"nearest"],pt=0;switch(Q||(pt^=2),q){case 0:pt=pt>>1|(1&pt)<<1,[tt,ut]=[ut,tt];break;case 1:case 3:pt^=1;break;case 4:pt^=2}return[tt,ut].map((xt,qt)=>{switch(xt){case"center":return 1;case"nearest":return 0;default:return"start"===xt==!(pt>>qt&1)?2:3}})})(q,Ue,ye);let ce=(()=>{switch(Be){case 1:return re+me/2;case 2:case 0:return re;case 3:return ke}})(),ae=(()=>{switch(Me){case 1:return Ce+_e/2;case 3:return de;case 2:case 0:return Ce}})();const Fe=[];tt.forEach(Ot=>{const{height:be,width:je,top:We,right:qe,bottom:ze,left:Ve}=Ot.getBoundingClientRect(),xe=getComputedStyle(Ot),Se=parseInt(xe.borderLeftWidth,10),Re=parseInt(xe.borderTopWidth,10),De=parseInt(xe.borderRightWidth,10),Le=parseInt(xe.borderBottomWidth,10);let ie=0,se=0;const Oe="offsetWidth"in Ot?Ot.offsetWidth-Ot.clientWidth-Se-De:0,Ae="offsetHeight"in Ot?Ot.offsetHeight-Ot.clientHeight-Re-Le:0;if(Q===Ot){switch(Be){case 2:ie=ce;break;case 3:ie=ce-xt;break;case 1:ie=ce-xt/2;break;case 0:ie=k(te,te+xt,xt,Re,Le,te+ce,te+ce+me,me)}switch(Me){case 2:se=ae;break;case 3:se=ae-pt;break;case 1:se=ae-pt/2;break;case 0:se=k(qt,qt+pt,pt,Se,De,qt+ae,qt+ae+_e,_e)}ie+=te,se+=qt}else{switch(Be){case 2:ie=ce-We-Re;break;case 3:ie=ce-ze+Le+Ae;break;case 1:ie=ce-(We+be/2)+Ae/2;break;case 0:ie=k(We,ze,be,Re,Le+Ae,ce,ce+me,me)}switch(Me){case 2:se=ae-Ve-Se;break;case 3:se=ae-qe+De+Oe;break;case 1:se=ae-(Ve+je/2)+Oe/2;break;case 0:se=k(Ve,qe,je,Se,De+Oe,ae,ae+_e,_e)}const{scrollLeft:we,scrollTop:Ze}=Ot;ie=C(Ze+ie,Ot.scrollHeight-be+Ae),se=C(we+se,Ot.scrollWidth-je+Oe),ce+=Ze-ie,ae+=we-se}Fe.push(()=>r(Ot,Ie(Qt({},q),{top:ie,left:se})))}),Fe.forEach(Ot=>Ot())},Dt=P=>{var q,Q;const tt=a.windowScroll.bind(window);if(void 0===P.left&&void 0===P.top)return;const ut=window.scrollX||window.pageXOffset,pt=window.scrollY||window.pageYOffset,xt=m(null!==(q=P.left)&&void 0!==q?q:ut),qt=m(null!==(Q=P.top)&&void 0!==Q?Q:pt);if("smooth"!==P.behavior)return tt(xt,qt);const te=()=>{window.removeEventListener("wheel",re),window.removeEventListener("touchmove",re)},ne={timeStamp:p(),duration:P.duration,startX:ut,startY:pt,targetX:xt,targetY:qt,rafId:0,method:tt,timingFunc:P.timingFunc,callback:te},re=()=>{cancelAnimationFrame(ne.rafId),te()};window.addEventListener("wheel",re,{passive:!0,once:!0}),window.addEventListener("touchmove",re,{passive:!0,once:!0}),u(ne)},fe=P=>{const q=m(P.left||0)+(window.scrollX||window.pageXOffset),Q=m(P.top||0)+(window.scrollY||window.pageYOffset);return"smooth"!==P.behavior?a.windowScroll.call(window,q,Q):Dt(Ie(Qt({},P),{left:q,top:Q}))};var P;Array.prototype.uniq=function(P){return P?Object.values(this.reduce((q,Q)=>{const tt=P instanceof Function?P(Q):Q[P];return q.hasOwnProperty(tt)||(q[tt]=Q),q},{})):[...new Set(this)]},Array.prototype.sortBy=function(P,q){const Q=this.reduce((ut,pt)=>{const xt=P instanceof Function?P(pt):pt[P];return(ut[xt]||(ut[xt]=[])).push(pt),ut},{});let tt=Object.keys(Q).sort().map(ut=>Q[ut]).flat();return q&&(tt=tt.reverse()),tt},c()||((P=>{if(c())return;const q=a.windowScroll;window.scroll=function(){if(1===arguments.length){const tt=arguments[0];if(!t(tt))throw new TypeError("Failed to execute 'scroll' on 'Window': parameter 1 ('options') is not an object.");return Dt(Qt(Qt({},tt),P))}return q.apply(this,arguments)}})(P),(P=>{if(c())return;const q=a.windowScroll;window.scrollTo=function(){if(1===arguments.length){const tt=arguments[0];if(!t(tt))throw new TypeError("Failed to execute 'scrollTo' on 'Window': parameter 1 ('options') is not an object.");const ut=Number(tt.left),pt=Number(tt.top);return Dt(Qt(Ie(Qt({},tt),{left:ut,top:pt}),P))}return q.apply(this,arguments)}})(P),(P=>{c()||(window.scrollBy=function(){if(1===arguments.length){const ut=arguments[0];if(!t(ut))throw new TypeError("Failed to execute 'scrollBy' on 'Window': parameter 1 ('options') is not an object.");return fe(Qt(Qt({},ut),P))}const Q=Number(arguments[0]),tt=Number(arguments[1]);return fe({left:Q,top:tt})})})(P),(P=>{if(c())return;const q=a.elementScroll;n(Q=>Q.scroll=function(){if(1===arguments.length){const ut=arguments[0];if(!t(ut))throw new TypeError("Failed to execute 'scroll' on 'Element': parameter 1 ('options') is not an object.");return r(this,Qt(Qt({},ut),P))}return q.apply(this,arguments)})})(P),(P=>{if(c())return;const q=a.elementScroll;n(Q=>Q.scrollTo=function(){if(1===arguments.length){const ut=arguments[0];if(!t(ut))throw new TypeError("Failed to execute 'scrollTo' on 'Element': parameter 1 ('options') is not an object.");const pt=Number(ut.left),xt=Number(ut.top);return r(this,Qt(Ie(Qt({},ut),{left:pt,top:xt}),P))}return q.apply(this,arguments)})})(P),(P=>{c()||n(q=>q.scrollBy=function(){if(1===arguments.length){const pt=arguments[0];if(!t(pt))throw new TypeError("Failed to execute 'scrollBy' on 'Element': parameter 1 ('options') is not an object.");return A(this,Qt(Qt({},pt),P))}const tt=Number(arguments[0]),ut=Number(arguments[1]);return A(this,{left:tt,top:ut})})})(P),(P=>{if(c())return;const q=a.elementScrollIntoView;n(Q=>Q.scrollIntoView=function(){const ut=arguments[0];return 1===arguments.length&&t(ut)?ft(this,Qt(Qt({},ut),P)):q.apply(this,arguments)})})(P))},2546:function(Ut,zt,Yt){var he,ve;(function(){}).call(this),function(){null==window.Set&&(window.Set=function(){function v(){this.clear()}return v.prototype.clear=function(){return this.values=[]},v.prototype.has=function(E){return-1!==this.values.indexOf(E)},v.prototype.add=function(E){return this.has(E)||this.values.push(E),this},v.prototype.delete=function(E){var b;return-1!==(b=this.values.indexOf(E))&&(this.values.splice(b,1),!0)},v.prototype.forEach=function(){var E;return(E=this.values).forEach.apply(E,arguments)},v}())}.call(this),function(Kt){function v(){}function b(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(n,this)}function y(n,p){for(;3===n._state;)n=n._value;return 0===n._state?void n._deferreds.push(p):(n._handled=!0,void c(function(){var u=1===n._state?p.onFulfilled:p.onRejected;if(null!==u){var m;try{m=u(n._value)}catch(t){return void o(p.promise,t)}l(p.promise,m)}else(1===n._state?l:o)(p.promise,n._value)}))}function l(n,p){try{if(p===n)throw new TypeError("A promise cannot be resolved with itself.");if(p&&("object"==typeof p||"function"==typeof p)){var u=p.then;if(p instanceof b)return n._state=3,n._value=p,void e(n);if("function"==typeof u)return void d(function E(n,p){return function(){n.apply(p,arguments)}}(u,p),n)}n._state=1,n._value=p,e(n)}catch(m){o(n,m)}}function o(n,p){n._state=2,n._value=p,e(n)}function e(n){2===n._state&&0===n._deferreds.length&&setTimeout(function(){n._handled||a(n._value)},1);for(var p=0,u=n._deferreds.length;u>p;p++)y(n,n._deferreds[p]);n._deferreds=null}function s(n,p,u){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof p?p:null,this.promise=u}function d(n,p){var u=!1;try{n(function(m){u||(u=!0,l(p,m))},function(m){u||(u=!0,o(p,m))})}catch(m){if(u)return;u=!0,o(p,m)}}var i=setTimeout,c="function"==typeof setImmediate&&setImmediate||function(n){i(n,1)},a=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)};b.prototype.catch=function(n){return this.then(null,n)},b.prototype.then=function(n,p){var u=new b(v);return y(this,new s(n,p,u)),u},b.all=function(n){var p=Array.prototype.slice.call(n);return new b(function(u,m){function t(A,f){try{if(f&&("object"==typeof f||"function"==typeof f)){var g=f.then;if("function"==typeof g)return void g.call(f,function(w){t(A,w)},m)}p[A]=f,0==--r&&u(p)}catch(w){m(w)}}if(0===p.length)return u([]);for(var r=p.length,h=0;h<p.length;h++)t(h,p[h])})},b.resolve=function(n){return n&&"object"==typeof n&&n.constructor===b?n:new b(function(p){p(n)})},b.reject=function(n){return new b(function(p,u){u(n)})},b.race=function(n){return new b(function(p,u){for(var m=0,t=n.length;t>m;m++)n[m].then(p,u)})},b._setImmediateFn=function(n){c=n},b._setUnhandledRejectionFn=function(n){a=n},Ut.exports?Ut.exports=b:Kt.Promise||(Kt.Promise=b)}(this),function(){var b,y,l,Kt="object"==typeof window.customElements,v="function"==typeof document.registerElement;Kt||v||("undefined"==typeof WeakMap&&(b=Object.defineProperty,y=Date.now()%1e9,(l=function(){this.name="__st"+(1e9*Math.random()>>>0)+y+++"__"}).prototype={set:function(o,e){var s=o[this.name];return s&&s[0]===o?s[1]=e:b(o,this.name,{value:[o,e],writable:!0}),this},get:function(o){var e;return(e=o[this.name])&&e[0]===o?e[1]:void 0},delete:function(o){var e=o[this.name];return!(!e||e[0]!==o||(e[0]=e[1]=void 0,0))},has:function(o){var e=o[this.name];return!!e&&e[0]===o}},window.WeakMap=l),function(b){function o(){g=!1;var L=w;w=[],L.sort(function(T,C){return T.uid_-C.uid_});var R=!1;L.forEach(function(T){var C=T.takeRecords();(function e(L){L.nodes_.forEach(function(R){var T=h.get(R);T&&T.forEach(function(C){C.observer===L&&C.removeTransientObservers()})})})(T),C.length&&(T.callback_(C,T),R=!0)}),R&&o()}function s(L,R){for(var T=L;T;T=T.parentNode){var C=h.get(T);if(C)for(var x=0;x<C.length;x++){var B=C[x],Z=B.options;if(T===L||Z.subtree){var ft=R(Z);ft&&B.enqueue(ft)}}}}function d(L){this.callback_=L,this.nodes_=[],this.records_=[],this.uid_=++k}function i(L,R){this.type=L,this.target=R,this.addedNodes=[],this.removedNodes=[],this.previousSibling=null,this.nextSibling=null,this.attributeName=null,this.attributeNamespace=null,this.oldValue=null}function a(L,R){return O=new i(L,R)}function n(L){return j||(j=function c(L){var R=new i(L.type,L.target);return R.addedNodes=L.addedNodes.slice(),R.removedNodes=L.removedNodes.slice(),R.previousSibling=L.previousSibling,R.nextSibling=L.nextSibling,R.attributeName=L.attributeName,R.attributeNamespace=L.attributeNamespace,R.oldValue=L.oldValue,R}(O),j.oldValue=L,j)}function t(L,R,T){this.observer=L,this.target=R,this.options=T,this.transientObservedNodes=[]}if(!b.JsMutationObserver){var r,h=new WeakMap;if(/Trident|Edge/.test(navigator.userAgent))r=setTimeout;else if(window.setImmediate)r=window.setImmediate;else{var A=[],f=String(Math.random());window.addEventListener("message",function(L){if(L.data===f){var R=A;A=[],R.forEach(function(T){T()})}}),r=function(L){A.push(L),window.postMessage(f,"*")}}var O,j,g=!1,w=[],k=0;d.prototype={observe:function(L,R){if(L=function l(L){return window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(L)||L}(L),!R.childList&&!R.attributes&&!R.characterData||R.attributeOldValue&&!R.attributes||R.attributeFilter&&R.attributeFilter.length&&!R.attributes||R.characterDataOldValue&&!R.characterData)throw new SyntaxError;var T=h.get(L);T||h.set(L,T=[]);for(var C,x=0;x<T.length;x++)if(T[x].observer===this){(C=T[x]).removeListeners(),C.options=R;break}C||(C=new t(this,L,R),T.push(C),this.nodes_.push(L)),C.addListeners()},disconnect:function(){this.nodes_.forEach(function(L){for(var R=h.get(L),T=0;T<R.length;T++){var C=R[T];if(C.observer===this){C.removeListeners(),R.splice(T,1);break}}},this),this.records_=[]},takeRecords:function(){var L=this.records_;return this.records_=[],L}},t.prototype={enqueue:function(L){var R=this.observer.records_,T=R.length;if(R.length>0){var x=function m(L,R){return L===R?L:j&&function u(L){return L===j||L===O}(L)?j:null}(R[T-1],L);if(x)return void(R[T-1]=x)}else!function y(L){w.push(L),g||(g=!0,r(o))}(this.observer);R[T]=L},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(L){var R=this.options;R.attributes&&L.addEventListener("DOMAttrModified",this,!0),R.characterData&&L.addEventListener("DOMCharacterDataModified",this,!0),R.childList&&L.addEventListener("DOMNodeInserted",this,!0),(R.childList||R.subtree)&&L.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(L){var R=this.options;R.attributes&&L.removeEventListener("DOMAttrModified",this,!0),R.characterData&&L.removeEventListener("DOMCharacterDataModified",this,!0),R.childList&&L.removeEventListener("DOMNodeInserted",this,!0),(R.childList||R.subtree)&&L.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(L){if(L!==this.target){this.addListeners_(L),this.transientObservedNodes.push(L);var R=h.get(L);R||h.set(L,R=[]),R.push(this)}},removeTransientObservers:function(){var L=this.transientObservedNodes;this.transientObservedNodes=[],L.forEach(function(R){this.removeListeners_(R);for(var T=h.get(R),C=0;C<T.length;C++)if(T[C]===this){T.splice(C,1);break}},this)},handleEvent:function(L){switch(L.stopImmediatePropagation(),L.type){case"DOMAttrModified":var R=L.attrName,T=L.relatedNode.namespaceURI;(Dt=new a("attributes",C=L.target)).attributeName=R,Dt.attributeNamespace=T;var x=L.attrChange===MutationEvent.ADDITION?null:L.prevValue;s(C,function(Zt){return!Zt.attributes||Zt.attributeFilter&&Zt.attributeFilter.length&&-1===Zt.attributeFilter.indexOf(R)&&-1===Zt.attributeFilter.indexOf(T)?void 0:Zt.attributeOldValue?n(x):Dt});break;case"DOMCharacterDataModified":var C,Dt=a("characterData",C=L.target);x=L.prevValue,s(C,function(Zt){return Zt.characterData?Zt.characterDataOldValue?n(x):Dt:void 0});break;case"DOMNodeRemoved":this.addTransientObserver(L.target);case"DOMNodeInserted":var B,Z,ft=L.target;"DOMNodeInserted"===L.type?(B=[ft],Z=[]):(B=[],Z=[ft]);var At=ft.previousSibling,Wt=ft.nextSibling;(Dt=a("childList",L.target.parentNode)).addedNodes=B,Dt.removedNodes=Z,Dt.previousSibling=At,Dt.nextSibling=Wt,s(L.relatedNode,function(Zt){return Zt.childList?Dt:void 0})}!function p(){O=j=void 0}()}},b.JsMutationObserver=d,b.MutationObserver||(b.MutationObserver=d,d._isPolyfilled=!0)}}(self),function(){"use strict";if(!window.performance||!window.performance.now){var b=Date.now();window.performance={now:function(){return Date.now()-b}}}var s;window.requestAnimationFrame||(window.requestAnimationFrame=(s=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame)?function(d){return s(function(){d(performance.now())})}:function(d){return window.setTimeout(d,1e3/60)}),window.cancelAnimationFrame||(window.cancelAnimationFrame=window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(s){clearTimeout(s)});var y=function(){var s=document.createEvent("Event");return s.initEvent("foo",!0,!0),s.preventDefault(),s.defaultPrevented}();if(!y){var l=Event.prototype.preventDefault;Event.prototype.preventDefault=function(){this.cancelable&&(l.call(this),Object.defineProperty(this,"defaultPrevented",{get:function(){return!0},configurable:!0}))}}var o=/Trident/.test(navigator.userAgent);if((!window.CustomEvent||o&&"function"!=typeof window.CustomEvent)&&(window.CustomEvent=function(s,d){d=d||{};var i=document.createEvent("CustomEvent");return i.initCustomEvent(s,Boolean(d.bubbles),Boolean(d.cancelable),d.detail),i},window.CustomEvent.prototype=window.Event.prototype),!window.Event||o&&"function"!=typeof window.Event){var e=window.Event;window.Event=function(s,d){d=d||{};var i=document.createEvent("Event");return i.initEvent(s,Boolean(d.bubbles),Boolean(d.cancelable)),i},window.Event.prototype=e.prototype}}(window),window.CustomElements=window.CustomElements||{flags:{}},function(b){var y=b.flags,l=[];b.addModule=function(s){l.push(s)},b.initializeModules=function(){l.forEach(function(s){s(b)})},b.hasNative=Boolean(document.registerElement),b.isIE=/Trident/.test(navigator.userAgent),b.useNative=!y.register&&b.hasNative&&!window.ShadowDOMPolyfill&&(!window.HTMLImports||window.HTMLImports.useNative)}(window.CustomElements),window.CustomElements.addModule(function(b){function y(i,c){l(i,function(a){return!!c(a)||void o(a,c)}),o(i,c)}function l(i,c,a){var n=i.firstElementChild;if(!n)for(n=i.firstChild;n&&n.nodeType!==Node.ELEMENT_NODE;)n=n.nextSibling;for(;n;)!0!==c(n,a)&&l(n,c,a),n=n.nextElementSibling;return null}function o(i,c){for(var a=i.shadowRoot;a;)y(a,c),a=a.olderShadowRoot}function s(i,c,a){if(i=window.wrap(i),!(a.indexOf(i)>=0)){a.push(i);for(var n,p=i.querySelectorAll("link[rel="+d+"]"),u=0,m=p.length;m>u&&(n=p[u]);u++)n.import&&s(n.import,c,a);c(i)}}var d=window.HTMLImports?window.HTMLImports.IMPORT_LINK_TYPE:"none";b.forDocumentTree=function e(i,c){s(i,c,[])},b.forSubtree=y}),window.CustomElements.addModule(function(b){function y(T,C){return l(T,C)||o(T,C)}function l(T,C){return!!b.upgrade(T,C)||void(C&&d(T))}function o(T,C){g(T,function(x){return!!l(x,C)||void 0})}function e(T){j.push(T),O||(O=!0,setTimeout(s))}function s(){O=!1;for(var T,C=j,x=0,B=C.length;B>x&&(T=C[x]);x++)T();j=[]}function d(T){k?e(function(){i(T)}):i(T)}function i(T){T.__upgraded__&&!T.__attached&&(T.__attached=!0,T.attachedCallback&&T.attachedCallback())}function a(T){k?e(function(){n(T)}):n(T)}function n(T){T.__upgraded__&&T.__attached&&(T.__attached=!1,T.detachedCallback&&T.detachedCallback())}function m(T,C){if(f.dom){var x=C[0];if(x&&"childList"===x.type&&x.addedNodes&&x.addedNodes){for(var B=x.addedNodes[0];B&&B!==document&&!B.host;)B=B.parentNode;var Z=B&&(B.URL||B._URL||B.host&&B.host.localName)||"";Z=Z.split("/?").shift().split("/").pop()}console.group("mutations (%d) [%s]",C.length,Z||"")}var ft=function p(T){for(var C=T,x=window.wrap(document);C;){if(C==x)return!0;C=C.parentNode||C.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&C.host}}(T);C.forEach(function(At){"childList"===At.type&&(L(At.addedNodes,function(Wt){Wt.localName&&y(Wt,ft)}),L(At.removedNodes,function(Wt){Wt.localName&&function c(T){a(T),g(T,function(C){a(C)})}(Wt)}))}),f.dom&&console.groupEnd()}function r(T){if(!T.__observer){var C=new MutationObserver(m.bind(this,T));C.observe(T,{childList:!0,subtree:!0}),T.__observer=C}}function h(T){T=window.wrap(T),f.dom&&console.group("upgradeDocument: ",T.baseURI.split("/").pop()),y(T,T===window.wrap(document)),r(T),f.dom&&console.groupEnd()}var f=b.flags,g=b.forSubtree,w=b.forDocumentTree,k=window.MutationObserver._isPolyfilled&&f["throttle-attached"];b.hasPolyfillMutations=k,b.hasThrottledAttached=k;var O=!1,j=[],L=Array.prototype.forEach.call.bind(Array.prototype.forEach),R=Element.prototype.createShadowRoot;R&&(Element.prototype.createShadowRoot=function(){var T=R.call(this);return window.CustomElements.watchShadow(this),T}),b.watchShadow=function u(T){if(T.shadowRoot&&!T.shadowRoot.__watched){f.dom&&console.log("watching shadow-root for: ",T.localName);for(var C=T.shadowRoot;C;)r(C),C=C.olderShadowRoot}},b.upgradeDocumentTree=function A(T){w(T,h)},b.upgradeDocument=h,b.upgradeSubtree=o,b.upgradeAll=y,b.attached=d,b.takeRecords=function t(T){for((T=window.wrap(T))||(T=window.wrap(document));T.parentNode;)T=T.parentNode;var C=T.__observer;C&&(m(T,C.takeRecords()),s())}}),window.CustomElements.addModule(function(b){function l(i,c,a){return d.upgrade&&console.group("upgrade:",i.localName),c.is&&i.setAttribute("is",c.is),o(i,c),i.__upgraded__=!0,function s(i){i.createdCallback&&i.createdCallback()}(i),a&&b.attached(i),b.upgradeSubtree(i,a),d.upgrade&&console.groupEnd(),i}function o(i,c){Object.__proto__||function e(i,c,a){for(var n={},p=c;p!==a&&p!==HTMLElement.prototype;){for(var u,m=Object.getOwnPropertyNames(p),t=0;u=m[t];t++)n[u]||(Object.defineProperty(i,u,Object.getOwnPropertyDescriptor(p,u)),n[u]=1);p=Object.getPrototypeOf(p)}}(i,c.prototype,c.native),i.__proto__=c.prototype}var d=b.flags;b.upgrade=function y(i,c){if("template"===i.localName&&window.HTMLTemplateElement&&HTMLTemplateElement.decorate&&HTMLTemplateElement.decorate(i),!i.__upgraded__&&i.nodeType===Node.ELEMENT_NODE){var a=i.getAttribute("is"),n=b.getRegisteredDefinition(i.localName)||b.getRegisteredDefinition(a);if(n&&(a&&n.tag==i.localName||!a&&!n.extends))return l(i,n,c)}},b.upgradeWithDefinition=l,b.implementPrototype=o}),window.CustomElements.addModule(function(b){function o(T,C,x){T=T.toLowerCase();var B=this.getAttribute(T);x.apply(this,arguments);var Z=this.getAttribute(T);this.attributeChangedCallback&&Z!==B&&this.attributeChangedCallback(T,B,Z)}function s(T){var C=a(T);return C?s(C.extends).concat([C]):[]}function a(T){return T?O[T.toLowerCase()]:void 0}function m(T,C){T&&(T=T.toLowerCase()),C&&(C=C.toLowerCase());var B,x=a(C||T);if(x){if(T==x.tag&&C==x.is)return new x.ctor;if(!C&&!x.is)return new x.ctor}return C?((B=m(T)).setAttribute("is",C),B):(B=L(T),T.indexOf("-")>=0&&g(B,HTMLElement),B)}function t(T,C){var x=T[C];T[C]=function(){var B=x.apply(this,arguments);return A(B),B}}var r,h=b.upgradeDocumentTree,A=b.upgradeAll,f=b.upgradeWithDefinition,g=b.implementPrototype,w=b.useNative,k=["annotation-xml","color-profile","font-face","font-face-src","font-face-uri","font-face-format","font-face-name","missing-glyph"],O={},L=document.createElement.bind(document),R=document.createElementNS.bind(document);r=Object.__proto__||w?function(T,C){return T instanceof C}:function(T,C){if(T instanceof C)return!0;for(var x=T;x;){if(x===C.prototype)return!0;x=x.__proto__}return!1},t(Node.prototype,"cloneNode"),t(document,"importNode"),document.registerElement=function y(T,C){var x=C||{};if(!T)throw new Error("document.registerElement: first argument `name` must not be empty");if(T.indexOf("-")<0)throw new Error("document.registerElement: first argument ('name') must contain a dash ('-'). Argument provided was '"+String(T)+"'.");if(function e(T){for(var C=0;C<k.length;C++)if(T===k[C])return!0}(T))throw new Error("Failed to execute 'registerElement' on 'Document': Registration failed for type '"+String(T)+"'. The type name is invalid.");if(a(T))throw new Error("DuplicateDefinitionError: a type with name '"+String(T)+"' is already registered");return x.prototype||(x.prototype=Object.create(HTMLElement.prototype)),x.__name=T.toLowerCase(),x.extends&&(x.extends=x.extends.toLowerCase()),x.lifecycle=x.lifecycle||{},x.ancestry=s(x.extends),function d(T){for(var C,x=T.extends,B=0;C=T.ancestry[B];B++)x=C.is&&C.tag;T.tag=x||T.__name,x&&(T.is=T.__name)}(x),function i(T){if(!Object.__proto__){var C=HTMLElement.prototype;if(T.is){var x=document.createElement(T.tag);C=Object.getPrototypeOf(x)}for(var B,Z=T.prototype,ft=!1;Z;)Z==C&&(ft=!0),(B=Object.getPrototypeOf(Z))&&(Z.__proto__=B),Z=B;ft||console.warn(T.tag+" prototype not found in prototype chain for "+T.is),T.native=C}}(x),function l(T){if(!T.setAttribute._polyfilled){var C=T.setAttribute;T.setAttribute=function(B,Z){o.call(this,B,Z,C)};var x=T.removeAttribute;T.removeAttribute=function(B){o.call(this,B,null,x)},T.setAttribute._polyfilled=!0}}(x.prototype),function n(T,C){O[T]=C}(x.__name,x),x.ctor=function p(T){return function(){return function c(T){return f(L(T.tag),T)}(T)}}(x),x.ctor.prototype=x.prototype,x.prototype.constructor=x.ctor,b.ready&&h(document),x.ctor},document.createElement=m,document.createElementNS=function u(T,C,x){return"http://www.w3.org/1999/xhtml"===T?m(C,x):R(T,C)},b.registry=O,b.instanceof=r,b.reservedTagList=k,b.getRegisteredDefinition=a,document.register=document.registerElement}),function(b){function y(){s(window.wrap(document)),window.CustomElements.ready=!0,(window.requestAnimationFrame||function(a){setTimeout(a,16)})(function(){setTimeout(function(){window.CustomElements.readyTime=Date.now(),window.HTMLImports&&(window.CustomElements.elapsed=window.CustomElements.readyTime-window.HTMLImports.readyTime),document.dispatchEvent(new CustomEvent("WebComponentsReady",{bubbles:!0}))})})}var o=b.initializeModules;if(b.useNative){var e=function(){};b.watchShadow=e,b.upgrade=e,b.upgradeAll=e,b.upgradeDocumentTree=e,b.upgradeSubtree=e,b.takeRecords=e,b.instanceof=function(c,a){return c instanceof a}}else o();var s=b.upgradeDocumentTree,d=b.upgradeDocument;if(window.wrap||(window.ShadowDOMPolyfill?(window.wrap=window.ShadowDOMPolyfill.wrapIfNeeded,window.unwrap=window.ShadowDOMPolyfill.unwrapIfNeeded):window.wrap=window.unwrap=function(c){return c}),window.HTMLImports&&(window.HTMLImports.__importsParsingHook=function(c){c.import&&d(wrap(c.import))}),"complete"===document.readyState||b.flags.eager)y();else if("interactive"!==document.readyState||window.attachEvent||window.HTMLImports&&!window.HTMLImports.ready){var i=window.HTMLImports&&!window.HTMLImports.ready?"HTMLImportsLoaded":"DOMContentLoaded";window.addEventListener(i,y)}else y()}(window.CustomElements))}.call(this),function(){}.call(this),function(){(function(){(function(){this.Trix={VERSION:"1.3.1",ZERO_WIDTH_SPACE:"\ufeff",NON_BREAKING_SPACE:"\xa0",OBJECT_REPLACEMENT_CHARACTER:"\ufffc",browser:{composesExistingText:/Android.*Chrome/.test(navigator.userAgent),forcesObjectResizing:/Trident.*rv:11/.test(navigator.userAgent),supportsInputEvents:function(){var E,b,l;if("undefined"==typeof InputEvent)return!1;for(E=0,b=(l=["data","getTargetRanges","inputType"]).length;b>E;E++)if(!(l[E]in InputEvent.prototype))return!1;return!0}()},config:{}}}).call(this)}).call(this);var v=this.Trix;(function(){(function(){v.BasicObject=function(){function E(){}var b,y,l;return E.proxyMethod=function(o){var e,s,d,i,c;return d=y(o),i=d.toMethod,c=d.toProperty,s=d.optional,this.prototype[e=d.name]=function(){var a,n;return a=null!=i?s?"function"==typeof this[i]?this[i]():void 0:this[i]():null!=c?this[c]:void 0,s?null!=(n=null!=a?a[e]:void 0)?b.call(n,a,arguments):void 0:b.call(n=a[e],a,arguments)}},y=function(o){var e,s;if(!(s=o.match(l)))throw new Error("can't parse @proxyMethod expression: "+o);return e={name:s[4]},null!=s[2]?e.toMethod=s[1]:e.toProperty=s[1],null!=s[3]&&(e.optional=!0),e},b=Function.prototype.apply,l=/^(.+?)(\(\))?(\?)?\.(.+?)$/,E}()}).call(this),function(){var b={}.hasOwnProperty;v.Object=function(y){function l(){this.id=++o}var o;return function(y,l){function o(){this.constructor=y}for(var e in l)b.call(l,e)&&(y[e]=l[e]);o.prototype=l.prototype,y.prototype=new o,y.__super__=l.prototype}(l,y),o=0,l.fromJSONString=function(e){return this.fromJSON(JSON.parse(e))},l.prototype.hasSameConstructorAs=function(e){return this.constructor===(null!=e?e.constructor:void 0)},l.prototype.isEqualTo=function(e){return this===e},l.prototype.inspect=function(){var e,s;return e=function(){var i,c,a;for(s in a=[],c=null!=(i=this.contentsForInspection())?i:{})a.push(s+"="+c[s]);return a}.call(this),"#<"+this.constructor.name+":"+this.id+(e.length?" "+e.join(", "):"")+">"},l.prototype.contentsForInspection=function(){},l.prototype.toJSONString=function(){return JSON.stringify(this)},l.prototype.toUTF16String=function(){return v.UTF16String.box(this)},l.prototype.getCacheKey=function(){return this.id.toString()},l}(v.BasicObject)}.call(this),function(){v.extend=function(E){var b;for(b in E)this[b]=E[b];return this}}.call(this),function(){v.extend({defer:function(E){return setTimeout(E,1)}})}.call(this),function(){var E,b;v.extend({normalizeSpaces:function(y){return y.replace(RegExp(""+v.ZERO_WIDTH_SPACE,"g"),"").replace(RegExp(""+v.NON_BREAKING_SPACE,"g")," ")},normalizeNewlines:function(y){return y.replace(/\r\n/g,"\n")},breakableWhitespacePattern:RegExp("[^\\S"+v.NON_BREAKING_SPACE+"]"),squishBreakableWhitespace:function(y){return y.replace(RegExp(""+v.breakableWhitespacePattern.source,"g")," ").replace(/\ {2,}/g," ")},summarizeStringChange:function(y,l){var o,e,s,d;return y=v.UTF16String.box(y),(l=v.UTF16String.box(l)).length<y.length?(d=(e=b(y,l))[0],o=e[1]):(o=(s=b(l,y))[0],d=s[1]),{added:o,removed:d}}}),b=function(y,l){var o,e,s,d,i;return y.isEqualTo(l)?["",""]:(s=(d=(e=E(y,l)).utf16String.length)?(o=y.codepoints.slice(0,i=e.offset).concat(y.codepoints.slice(i+d)),E(l,v.UTF16String.fromCodepoints(o))):E(l,y),[e.utf16String.toString(),s.utf16String.toString()])},E=function(y,l){var o,e,s;for(o=0,e=y.length,s=l.length;e>o&&y.charAt(o).isEqualTo(l.charAt(o));)o++;for(;e>o+1&&y.charAt(e-1).isEqualTo(l.charAt(s-1));)e--,s--;return{utf16String:y.slice(o,e),offset:o}}}.call(this),function(){v.extend({copyObject:function(E){var b,y;for(b in null==E&&(E={}),y={},E)y[b]=E[b];return y},objectsAreEqual:function(E,b){var y;if(null==E&&(E={}),null==b&&(b={}),Object.keys(E).length!==Object.keys(b).length)return!1;for(y in E)if(E[y]!==b[y])return!1;return!0}})}.call(this),function(){var E=[].slice;v.extend({arraysAreEqual:function(b,y){var l,o,e;if(null==b&&(b=[]),null==y&&(y=[]),b.length!==y.length)return!1;for(o=l=0,e=b.length;e>l;o=++l)if(b[o]!==y[o])return!1;return!0},arrayStartsWith:function(b,y){return null==b&&(b=[]),null==y&&(y=[]),v.arraysAreEqual(b.slice(0,y.length),y)},spliceArray:function(){var b,y,l;return y=arguments[0],b=2<=arguments.length?E.call(arguments,1):[],(l=y.slice(0)).splice.apply(l,b),l},summarizeArrayChange:function(b,y){var l,o,e,s,d,i,c,a,n,p,u;for(null==b&&(b=[]),null==y&&(y=[]),l=[],p=[],e=new Set,s=0,c=b.length;c>s;s++)e.add(u=b[s]);for(o=new Set,d=0,a=y.length;a>d;d++)o.add(u=y[d]),e.has(u)||l.push(u);for(i=0,n=b.length;n>i;i++)o.has(u=b[i])||p.push(u);return{added:l,removed:p}}})}.call(this),function(){var E,b,y,l;E=null,b=null,l=null,y=null,v.extend({getAllAttributeNames:function(){return null!=E?E:E=v.getTextAttributeNames().concat(v.getBlockAttributeNames())},getBlockConfig:function(o){return v.config.blockAttributes[o]},getBlockAttributeNames:function(){return null!=b?b:b=Object.keys(v.config.blockAttributes)},getTextConfig:function(o){return v.config.textAttributes[o]},getTextAttributeNames:function(){return null!=l?l:l=Object.keys(v.config.textAttributes)},getListAttributeNames:function(){var o,e;return null!=y?y:y=function(){var s,d;for(o in d=[],s=v.config.blockAttributes)null!=(e=s[o].listAttribute)&&d.push(e);return d}()}})}.call(this),function(){var E,b,y,l,o,e=[].indexOf||function(s){for(var d=0,i=this.length;i>d;d++)if(d in this&&this[d]===s)return d;return-1};E=document.documentElement,b=null!=(y=null!=(l=null!=(o=E.matchesSelector)?o:E.webkitMatchesSelector)?l:E.msMatchesSelector)?y:E.mozMatchesSelector,v.extend({handleEvent:function(s,d){var c,a,u,m,t,r,h,A,f;return m=(t=null!=d?d:{}).preventDefault,h=t.times,c=null!=(u=t.onElement)?u:E,r=t.matchingSelector,f=t.withCallback,A="capturing"===t.inPhase,(a=function(g){var w;return null!=h&&0==--h&&a.destroy(),null!=(w=v.findClosestElementFromNode(g.target,{matchingSelector:r}))&&(null!=f&&f.call(w,g,w),m)?g.preventDefault():void 0}).destroy=function(){return c.removeEventListener(s,a,A)},c.addEventListener(s,a,A),a},handleEventOnce:function(s,d){return null==d&&(d={}),d.times=1,v.handleEvent(s,d)},triggerEvent:function(s,d){var i,c,a,n,p,u,m;return i=(m=null!=d?d:{}).attributes,n=null!=(u=m.onElement)?u:E,c=!1!==(c=m.bubbles),a=!1!==(a=m.cancelable),(p=document.createEvent("Events")).initEvent(s,c,a),null!=i&&v.extend.call(p,i),n.dispatchEvent(p)},elementMatchesSelector:function(s,d){return 1===(null!=s?s.nodeType:void 0)?b.call(s,d):void 0},findClosestElementFromNode:function(s,d){var i,c,a;for(i=(c=null!=d?d:{}).matchingSelector,a=c.untilNode;null!=s&&s.nodeType!==Node.ELEMENT_NODE;)s=s.parentNode;if(null!=s){if(null==i)return s;if(s.closest&&null==a)return s.closest(i);for(;s&&s!==a;){if(v.elementMatchesSelector(s,i))return s;s=s.parentNode}}},findInnerElement:function(s){for(;null!=s?s.firstElementChild:void 0;)s=s.firstElementChild;return s},innerElementIsActive:function(s){return document.activeElement!==s&&v.elementContainsNode(s,document.activeElement)},elementContainsNode:function(s,d){if(s&&d)for(;d;){if(d===s)return!0;d=d.parentNode}},findNodeFromContainerAndOffset:function(s,d){var i;if(s)return s.nodeType===Node.TEXT_NODE?s:0===d?null!=(i=s.firstChild)?i:s:s.childNodes.item(d-1)},findElementFromContainerAndOffset:function(s,d){var i;return i=v.findNodeFromContainerAndOffset(s,d),v.findClosestElementFromNode(i)},findChildIndexOfNode:function(s){var d;if(null!=s?s.parentNode:void 0){for(d=0;s=s.previousSibling;)d++;return d}},removeNode:function(s){var d;return null!=s&&null!=(d=s.parentNode)?d.removeChild(s):void 0},walkTree:function(s,d){var i,c,a,n,p;return c=(a=null!=d?d:{}).onlyNodesOfType,n=a.usingFilter,i=a.expandEntityReferences,p=function(){switch(c){case"element":return NodeFilter.SHOW_ELEMENT;case"text":return NodeFilter.SHOW_TEXT;case"comment":return NodeFilter.SHOW_COMMENT;default:return NodeFilter.SHOW_ALL}}(),document.createTreeWalker(s,p,null!=n?n:null,!0===i)},tagName:function(s){var d;return null!=s&&null!=(d=s.tagName)?d.toLowerCase():void 0},makeElement:function(s,d){var a,n,p,u,m,t,r,h,A,f,g;if(null==d&&(d={}),"object"==typeof s?s=(d=s).tagName:d={attributes:d},a=document.createElement(s),null!=d.editable&&(null==d.attributes&&(d.attributes={}),d.attributes.contenteditable=d.editable),d.attributes)for(u in r=d.attributes)a.setAttribute(u,r[u]);if(d.style)for(u in h=d.style)a.style[u]=h[u];if(d.data)for(u in A=d.data)a.dataset[u]=A[u];if(d.className)for(n=0,m=(f=d.className.split(" ")).length;m>n;n++)a.classList.add(f[n]);if(d.textContent&&(a.textContent=d.textContent),d.childNodes)for(p=0,t=(g=[].concat(d.childNodes)).length;t>p;p++)a.appendChild(g[p]);return a},getBlockTagNames:function(){var s,d;return null!=v.blockTagNames?v.blockTagNames:v.blockTagNames=function(){var i,c;for(s in c=[],i=v.config.blockAttributes)(d=i[s].tagName)&&c.push(d);return c}()},nodeIsBlockContainer:function(s){return v.nodeIsBlockStartComment(null!=s?s.firstChild:void 0)},nodeProbablyIsBlockContainer:function(s){var d,i;return d=v.tagName(s),e.call(v.getBlockTagNames(),d)>=0&&(i=v.tagName(s.firstChild),e.call(v.getBlockTagNames(),i)<0)},nodeIsBlockStart:function(s,d){return(null!=d?d:{strict:!0}).strict?v.nodeIsBlockStartComment(s):v.nodeIsBlockStartComment(s)||!v.nodeIsBlockStartComment(s.firstChild)&&v.nodeProbablyIsBlockContainer(s)},nodeIsBlockStartComment:function(s){return v.nodeIsCommentNode(s)&&"block"===(null!=s?s.data:void 0)},nodeIsCommentNode:function(s){return(null!=s?s.nodeType:void 0)===Node.COMMENT_NODE},nodeIsCursorTarget:function(s,d){var i;return i=(null!=d?d:{}).name,s?v.nodeIsTextNode(s)?s.data===v.ZERO_WIDTH_SPACE?!i||s.parentNode.dataset.trixCursorTarget===i:void 0:v.nodeIsCursorTarget(s.firstChild):void 0},nodeIsAttachmentElement:function(s){return v.elementMatchesSelector(s,v.AttachmentView.attachmentSelector)},nodeIsEmptyTextNode:function(s){return v.nodeIsTextNode(s)&&""===(null!=s?s.data:void 0)},nodeIsTextNode:function(s){return(null!=s?s.nodeType:void 0)===Node.TEXT_NODE}})}.call(this),function(){var E,b,y,l,o;E=v.copyObject,l=v.objectsAreEqual,v.extend({normalizeRange:y=function(e){var s;if(null!=e)return Array.isArray(e)||(e=[e,e]),[b(e[0]),b(null!=(s=e[1])?s:e[0])]},rangeIsCollapsed:function(e){var d;if(null!=e)return d=y(e),o(d[0],d[1])},rangesAreEqual:function(e,s){var d,i,c,a,n;if(null!=e&&null!=s)return i=(c=y(e))[0],d=c[1],n=(a=y(s))[1],o(i,a[0])&&o(d,n)}}),b=function(e){return"number"==typeof e?e:E(e)},o=function(e,s){return"number"==typeof e?e===s:l(e,s)}}.call(this),function(){var E,b,y,l,o,e,s,d;v.registerElement=function(d,i){var c,a;return null==i&&(i={}),d=d.toLowerCase(),i=s(i),(c=(a=e(i)).defaultCSS)&&(delete a.defaultCSS,l(c,d)),o(d,a)},l=function(d,i){return y(i).textContent=d.replace(/%t/g,i)},y=function(d){var i,c;return(i=document.createElement("style")).setAttribute("type","text/css"),i.setAttribute("data-tag-name",d.toLowerCase()),(c=E())&&i.setAttribute("nonce",c),document.head.insertBefore(i,document.head.firstChild),i},E=function(){var d;return(d=b("trix-csp-nonce")||b("csp-nonce"))?d.getAttribute("content"):void 0},b=function(d){return document.head.querySelector("meta[name="+d+"]")},e=function(d){var i,c,a;for(i in c={},d)c[i]="function"==typeof(a=d[i])?{value:a}:a;return c},d=function(i){var c,a,n,p,u;for(c={},a=0,p=(u=["initialize","connect","disconnect"]).length;p>a;a++)c[n=u[a]]=i[n],delete i[n];return c},s=window.customElements?function(i){var c,a,n,p,u;return c=(u=d(i)).connect,a=u.disconnect,(n=u.initialize)&&(p=c,c=function(){return this.initialized||(this.initialized=!0,n.call(this)),null!=p?p.call(this):void 0}),c&&(i.connectedCallback=c),a&&(i.disconnectedCallback=a),i}:function(i){var c,a,n,p;return c=(p=d(i)).connect,a=p.disconnect,(n=p.initialize)&&(i.createdCallback=n),c&&(i.attachedCallback=c),a&&(i.detachedCallback=a),i},o=window.customElements?function(d,i){var c;return c=function(){return"object"==typeof Reflect?Reflect.construct(HTMLElement,[],c):HTMLElement.apply(this)},Object.setPrototypeOf(c.prototype,HTMLElement.prototype),Object.setPrototypeOf(c,HTMLElement),Object.defineProperties(c.prototype,i),window.customElements.define(d,c),c}:function(d,i){var c,a;return a=Object.create(HTMLElement.prototype,i),c=document.registerElement(d,{prototype:a}),Object.defineProperty(a,"constructor",{value:c}),c}}.call(this),function(){var E,b;v.extend({getDOMSelection:function(){var y;return(y=window.getSelection()).rangeCount>0?y:void 0},getDOMRange:function(){var y,l;return(y=null!=(l=v.getDOMSelection())?l.getRangeAt(0):void 0)&&!E(y)?y:void 0},setDOMRange:function(y){var l;return(l=window.getSelection()).removeAllRanges(),l.addRange(y),v.selectionChangeObserver.update()}}),E=function(y){return b(y.startContainer)||b(y.endContainer)},b=function(y){return!Object.getPrototypeOf(y)}}.call(this),function(){var E;E={"application/x-trix-feature-detection":"test"},v.extend({dataTransferIsPlainText:function(b){var y,l,o;return o=b.getData("text/plain"),l=b.getData("text/html"),o&&l?(y=(new DOMParser).parseFromString(l,"text/html").body).textContent===o?!y.querySelector("*"):void 0:null!=o?o.length:void 0},dataTransferIsWritable:function(b){var y,l;if(null!=(null!=b?b.setData:void 0)){for(y in E)if(l=E[y],!function(){try{return b.setData(y,l),b.getData(y)===l}catch(o){}}())return;return!0}},keyEventIsKeyboardCommand:/Mac|^iP/.test(navigator.platform)?function(b){return b.metaKey}:function(b){return b.ctrlKey}})}.call(this),function(){var E,b,y,l;v.extend({RTL_PATTERN:/[\u05BE\u05C0\u05C3\u05D0-\u05EA\u05F0-\u05F4\u061B\u061F\u0621-\u063A\u0640-\u064A\u066D\u0671-\u06B7\u06BA-\u06BE\u06C0-\u06CE\u06D0-\u06D5\u06E5\u06E6\u200F\u202B\u202E\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE72\uFE74\uFE76-\uFEFC]/,getDirection:(b=v.makeElement("input",{dir:"auto",name:"x",dirName:"x.dir"}),(E=v.makeElement("form")).appendChild(b),y=function(){try{return new FormData(E).has(b.dirName)}catch(o){}}(),l=function(){try{return b.matches(":dir(ltr),:dir(rtl)")}catch(o){}}(),y?function(o){return b.value=o,new FormData(E).get(b.dirName)}:l?function(o){return b.value=o,b.matches(":dir(rtl)")?"rtl":"ltr"}:function(o){var e;return e=o.trim().charAt(0),v.RTL_PATTERN.test(e)?"rtl":"ltr"})})}.call(this),function(){}.call(this),function(){var E,y={}.hasOwnProperty;E=v.arraysAreEqual,v.Hash=function(l){function o(a){null==a&&(a={}),this.values=s(a),o.__super__.constructor.apply(this,arguments)}var e,s,d,i,c;return function(l,o){function e(){this.constructor=l}for(var s in o)y.call(o,s)&&(l[s]=o[s]);e.prototype=o.prototype,l.prototype=new e,l.__super__=o.prototype}(o,l),o.fromCommonAttributesOfObjects=function(a){var n,p,u,m,r;if(null==a&&(a=[]),!a.length)return new this;for(u=(n=e(a[0])).getKeys(),p=0,m=(r=a.slice(1)).length;m>p;p++)u=n.getKeysCommonToHash(e(r[p])),n=n.slice(u);return n},o.box=function(a){return e(a)},o.prototype.add=function(a,n){return this.merge(i(a,n))},o.prototype.remove=function(a){return new v.Hash(s(this.values,a))},o.prototype.get=function(a){return this.values[a]},o.prototype.has=function(a){return a in this.values},o.prototype.merge=function(a){return new v.Hash(d(this.values,c(a)))},o.prototype.slice=function(a){var n,p,u,m;for(m={},n=0,u=a.length;u>n;n++)this.has(p=a[n])&&(m[p]=this.values[p]);return new v.Hash(m)},o.prototype.getKeys=function(){return Object.keys(this.values)},o.prototype.getKeysCommonToHash=function(a){var n,p,u,m,t;for(a=e(a),t=[],n=0,u=(m=this.getKeys()).length;u>n;n++)this.values[p=m[n]]===a.values[p]&&t.push(p);return t},o.prototype.isEqualTo=function(a){return E(this.toArray(),e(a).toArray())},o.prototype.isEmpty=function(){return 0===this.getKeys().length},o.prototype.toArray=function(){var a,n;return(null!=this.array?this.array:this.array=function(){var u;for(a in n=[],u=this.values)n.push(a,u[a]);return n}.call(this)).slice(0)},o.prototype.toObject=function(){return s(this.values)},o.prototype.toJSON=function(){return this.toObject()},o.prototype.contentsForInspection=function(){return{values:JSON.stringify(this.values)}},i=function(a,n){var p;return(p={})[a]=n,p},d=function(a,n){var p,u;for(p in u=s(a),n)u[p]=n[p];return u},s=function(a,n){var p,u,m,t,r;for(t={},p=0,m=(r=Object.keys(a).sort()).length;m>p;p++)(u=r[p])!==n&&(t[u]=a[u]);return t},e=function(a){return a instanceof v.Hash?a:new v.Hash(a)},c=function(a){return a instanceof v.Hash?a.values:a},o}(v.Object)}.call(this),function(){v.ObjectGroup=function(){function E(b,y){var l;this.objects=null!=b?b:[],(l=y.asTree)&&(this.depth=y.depth,this.objects=this.constructor.groupObjects(this.objects,{asTree:l,depth:this.depth+1}))}return E.groupObjects=function(b,y){var l,o,e,s,d,i,c,a,n;for(null==b&&(b=[]),e=(n=null!=y?y:{}).depth,(l=n.asTree)&&null==e&&(e=0),a=[],d=0,i=b.length;i>d;d++){if(c=b[d],s){if(("function"==typeof c.canBeGrouped?c.canBeGrouped(e):void 0)&&("function"==typeof(o=s[s.length-1]).canBeGroupedWith?o.canBeGroupedWith(c,e):void 0)){s.push(c);continue}a.push(new this(s,{depth:e,asTree:l})),s=null}("function"==typeof c.canBeGrouped?c.canBeGrouped(e):void 0)?s=[c]:a.push(c)}return s&&a.push(new this(s,{depth:e,asTree:l})),a},E.prototype.getObjects=function(){return this.objects},E.prototype.getDepth=function(){return this.depth},E.prototype.getCacheKey=function(){var b,y,l,e;for(y=["objectGroup"],b=0,l=(e=this.getObjects()).length;l>b;b++)y.push(e[b].getCacheKey());return y.join("/")},E}()}.call(this),function(){var b={}.hasOwnProperty;v.ObjectMap=function(y){function l(o){var e,s,d,i,c;for(null==o&&(o=[]),this.objects={},d=0,i=o.length;i>d;d++)c=o[d],s=JSON.stringify(c),null==(e=this.objects)[s]&&(e[s]=c)}return function(y,l){function o(){this.constructor=y}for(var e in l)b.call(l,e)&&(y[e]=l[e]);o.prototype=l.prototype,y.prototype=new o,y.__super__=l.prototype}(l,y),l.prototype.find=function(o){var e;return e=JSON.stringify(o),this.objects[e]},l}(v.BasicObject)}.call(this),function(){v.ElementStore=function(){function E(y){this.reset(y)}var b;return E.prototype.add=function(y){var l;return l=b(y),this.elements[l]=y},E.prototype.remove=function(y){var l,o;return l=b(y),(o=this.elements[l])?(delete this.elements[l],o):void 0},E.prototype.reset=function(y){var o,e;for(null==y&&(y=[]),this.elements={},o=0,e=y.length;e>o;o++)this.add(y[o]);return y},b=function(y){return y.dataset.trixStoreKey},E}()}.call(this),function(){}.call(this),function(){var b={}.hasOwnProperty;v.Operation=function(y){function l(){return l.__super__.constructor.apply(this,arguments)}return function(y,l){function o(){this.constructor=y}for(var e in l)b.call(l,e)&&(y[e]=l[e]);o.prototype=l.prototype,y.prototype=new o,y.__super__=l.prototype}(l,y),l.prototype.isPerforming=function(){return!0===this.performing},l.prototype.hasPerformed=function(){return!0===this.performed},l.prototype.hasSucceeded=function(){return this.performed&&this.succeeded},l.prototype.hasFailed=function(){return this.performed&&!this.succeeded},l.prototype.getPromise=function(){return null!=this.promise?this.promise:this.promise=new Promise((o=this,function(e,s){return o.performing=!0,o.perform(function(d,i){return o.succeeded=d,o.performing=!1,o.performed=!0,o.succeeded?e(i):s(i)})}));var o},l.prototype.perform=function(o){return o(!1)},l.prototype.release=function(){var o;return null!=(o=this.promise)&&"function"==typeof o.cancel&&o.cancel(),this.promise=null,this.performing=null,this.performed=null,this.succeeded=null},l.proxyMethod("getPromise().then"),l.proxyMethod("getPromise().catch"),l}(v.BasicObject)}.call(this),function(){var E,b,y,l,o,s={}.hasOwnProperty;v.UTF16String=function(d){function i(c,a){this.ucs2String=c,this.codepoints=a,this.length=this.codepoints.length,this.ucs2Length=this.ucs2String.length}return function(d,i){function c(){this.constructor=d}for(var a in i)s.call(i,a)&&(d[a]=i[a]);c.prototype=i.prototype,d.prototype=new c,d.__super__=i.prototype}(i,d),i.box=function(c){return null==c&&(c=""),c instanceof this?c:this.fromUCS2String(null!=c?c.toString():void 0)},i.fromUCS2String=function(c){return new this(c,l(c))},i.fromCodepoints=function(c){return new this(o(c),c)},i.prototype.offsetToUCS2Offset=function(c){return o(this.codepoints.slice(0,Math.max(0,c))).length},i.prototype.offsetFromUCS2Offset=function(c){return l(this.ucs2String.slice(0,Math.max(0,c))).length},i.prototype.slice=function(){var c;return this.constructor.fromCodepoints((c=this.codepoints).slice.apply(c,arguments))},i.prototype.charAt=function(c){return this.slice(c,c+1)},i.prototype.isEqualTo=function(c){return this.constructor.box(c).ucs2String===this.ucs2String},i.prototype.toJSON=function(){return this.ucs2String},i.prototype.getCacheKey=function(){return this.ucs2String},i.prototype.toString=function(){return this.ucs2String},i}(v.BasicObject),E=1===("function"==typeof Array.from?Array.from("\u{1f47c}").length:void 0),b=null!=("function"==typeof" ".codePointAt?" ".codePointAt(0):void 0),y=" \u{1f47c}"===("function"==typeof String.fromCodePoint?String.fromCodePoint(32,128124):void 0),l=E&&b?function(d){return Array.from(d).map(function(i){return i.codePointAt(0)})}:function(d){var i,c,a,n,p;for(n=[],i=0,a=d.length;a>i;)(p=d.charCodeAt(i++))>=55296&&56319>=p&&a>i&&(56320==(64512&(c=d.charCodeAt(i++)))?p=((1023&p)<<10)+(1023&c)+65536:i--),n.push(p);return n},o=y?function(d){return String.fromCodePoint.apply(String,d)}:function(d){var c,a;return function(){var n,p,u;for(u=[],n=0,p=d.length;p>n;n++)c="",(a=d[n])>65535&&(a-=65536,c+=String.fromCharCode(a>>>10&1023|55296),a=56320|1023&a),u.push(c+String.fromCharCode(a));return u}().join("")}}.call(this),function(){}.call(this),function(){}.call(this),function(){v.config.lang={attachFiles:"Attach Files",bold:"Bold",bullets:"Bullets",byte:"Byte",bytes:"Bytes",captionPlaceholder:"Add a caption\u2026",code:"Code",heading1:"Heading",indent:"Increase Level",italic:"Italic",link:"Link",numbers:"Numbers",outdent:"Decrease Level",quote:"Quote",redo:"Redo",remove:"Remove",strike:"Strikethrough",undo:"Undo",unlink:"Unlink",url:"URL",urlPlaceholder:"Enter a URL\u2026",GB:"GB",KB:"KB",MB:"MB",PB:"PB",TB:"TB"}}.call(this),function(){v.config.css={attachment:"attachment",attachmentCaption:"attachment__caption",attachmentCaptionEditor:"attachment__caption-editor",attachmentMetadata:"attachment__metadata",attachmentMetadataContainer:"attachment__metadata-container",attachmentName:"attachment__name",attachmentProgress:"attachment__progress",attachmentSize:"attachment__size",attachmentToolbar:"attachment__toolbar",attachmentGallery:"attachment-gallery"}}.call(this),function(){var E;v.config.blockAttributes=E={default:{tagName:"div",parse:!1},quote:{tagName:"blockquote",nestable:!0},heading1:{tagName:"h1",terminal:!0,breakOnReturn:!0,group:!1},code:{tagName:"pre",terminal:!0,text:{plaintext:!0}},bulletList:{tagName:"ul",parse:!1},bullet:{tagName:"li",listAttribute:"bulletList",group:!1,nestable:!0,test:function(b){return v.tagName(b.parentNode)===E[this.listAttribute].tagName}},numberList:{tagName:"ol",parse:!1},number:{tagName:"li",listAttribute:"numberList",group:!1,nestable:!0,test:function(b){return v.tagName(b.parentNode)===E[this.listAttribute].tagName}},attachmentGallery:{tagName:"div",exclusive:!0,terminal:!0,parse:!1,group:!1}}}.call(this),function(){var E,b;b=[(E=v.config.lang).bytes,E.KB,E.MB,E.GB,E.TB,E.PB],v.config.fileSize={prefix:"IEC",precision:2,formatter:function(y){var l,o;switch(y){case 0:return"0 "+E.bytes;case 1:return"1 "+E.byte;default:return l=function(){switch(this.prefix){case"SI":return 1e3;case"IEC":return 1024}}.call(this),o=Math.floor(Math.log(y)/Math.log(l)),(y/Math.pow(l,o)).toFixed(this.precision).replace(/0*$/,"").replace(/\.$/,"")+" "+b[o]}}}}.call(this),function(){v.config.textAttributes={bold:{tagName:"strong",inheritable:!0,parser:function(E){var b;return"bold"===(b=window.getComputedStyle(E)).fontWeight||b.fontWeight>=600}},italic:{tagName:"em",inheritable:!0,parser:function(E){return"italic"===window.getComputedStyle(E).fontStyle}},href:{groupTagName:"a",parser:function(E){var y;return(y=v.findClosestElementFromNode(E,{matchingSelector:"a:not("+v.AttachmentView.attachmentSelector+")"}))?y.getAttribute("href"):void 0}},strike:{tagName:"del",inheritable:!0},frozen:{style:{backgroundColor:"highlight"}}}}.call(this),function(){var E,b,l;l=["contenteditable","data-trix-id","data-trix-store-key","data-trix-mutable","data-trix-placeholder","tabindex"],b="data-trix-serialized-attributes",E=new RegExp("\x3c!--block--\x3e","g"),v.extend({serializers:{"application/json":function(e){var s;if(e instanceof v.Document)s=e;else{if(!(e instanceof HTMLElement))throw new Error("unserializable object");s=v.Document.fromHTML(e.innerHTML)}return s.toSerializableDocument().toJSONString()},"text/html":function(e){var s,d,i,c,a,n,p,u,m,t,r,h,A,f,g,w;if(e instanceof v.Document)c=v.DocumentView.render(e);else{if(!(e instanceof HTMLElement))throw new Error("unserializable object");c=e.cloneNode(!0)}for(a=0,m=(f=c.querySelectorAll("[data-trix-serialize=false]")).length;m>a;a++)v.removeNode(i=f[a]);for(n=0,t=l.length;t>n;n++)for(p=0,r=(g=c.querySelectorAll("["+(s=l[n])+"]")).length;r>p;p++)(i=g[p]).removeAttribute(s);for(u=0,h=(w=c.querySelectorAll("[data-trix-serialized-attributes]")).length;h>u;u++){i=w[u];try{for(A in d=JSON.parse(i.getAttribute(b)),i.removeAttribute(b),d)i.setAttribute(A,d[A])}catch(O){}}return c.innerHTML.replace(E,"")}},deserializers:{"application/json":function(e){return v.Document.fromJSONString(e)},"text/html":function(e){return v.Document.fromHTML(e)}},serializeToContentType:function(e,s){var d;if(d=v.serializers[s])return d(e);throw new Error("unknown content type: "+s)},deserializeFromContentType:function(e,s){var d;if(d=v.deserializers[s])return d(e);throw new Error("unknown content type: "+s)}})}.call(this),function(){var E;E=v.config.lang,v.config.toolbar={getDefaultHTML:function(){return'<div class="trix-button-row">\n  <span class="trix-button-group trix-button-group--text-tools" data-trix-button-group="text-tools">\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-bold" data-trix-attribute="bold" data-trix-key="b" title="'+E.bold+'" tabindex="-1">'+E.bold+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-italic" data-trix-attribute="italic" data-trix-key="i" title="'+E.italic+'" tabindex="-1">'+E.italic+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-strike" data-trix-attribute="strike" title="'+E.strike+'" tabindex="-1">'+E.strike+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-link" data-trix-attribute="href" data-trix-action="link" data-trix-key="k" title="'+E.link+'" tabindex="-1">'+E.link+'</button>\n  </span>\n\n  <span class="trix-button-group trix-button-group--block-tools" data-trix-button-group="block-tools">\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-heading-1" data-trix-attribute="heading1" title="'+E.heading1+'" tabindex="-1">'+E.heading1+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-quote" data-trix-attribute="quote" title="'+E.quote+'" tabindex="-1">'+E.quote+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-code" data-trix-attribute="code" title="'+E.code+'" tabindex="-1">'+E.code+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-bullet-list" data-trix-attribute="bullet" title="'+E.bullets+'" tabindex="-1">'+E.bullets+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-number-list" data-trix-attribute="number" title="'+E.numbers+'" tabindex="-1">'+E.numbers+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-decrease-nesting-level" data-trix-action="decreaseNestingLevel" title="'+E.outdent+'" tabindex="-1">'+E.outdent+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-increase-nesting-level" data-trix-action="increaseNestingLevel" title="'+E.indent+'" tabindex="-1">'+E.indent+'</button>\n  </span>\n\n  <span class="trix-button-group trix-button-group--file-tools" data-trix-button-group="file-tools">\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-attach" data-trix-action="attachFiles" title="'+E.attachFiles+'" tabindex="-1">'+E.attachFiles+'</button>\n  </span>\n\n  <span class="trix-button-group-spacer"></span>\n\n  <span class="trix-button-group trix-button-group--history-tools" data-trix-button-group="history-tools">\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-undo" data-trix-action="undo" data-trix-key="z" title="'+E.undo+'" tabindex="-1">'+E.undo+'</button>\n    <button type="button" class="trix-button trix-button--icon trix-button--icon-redo" data-trix-action="redo" data-trix-key="shift+z" title="'+E.redo+'" tabindex="-1">'+E.redo+'</button>\n  </span>\n</div>\n\n<div class="trix-dialogs" data-trix-dialogs>\n  <div class="trix-dialog trix-dialog--link" data-trix-dialog="href" data-trix-dialog-attribute="href">\n    <div class="trix-dialog__link-fields">\n      <input type="url" name="href" class="trix-input trix-input--dialog" placeholder="'+E.urlPlaceholder+'" aria-label="'+E.url+'" required data-trix-input>\n      <div class="trix-button-group">\n        <input type="button" class="trix-button trix-button--dialog" value="'+E.link+'" data-trix-method="setAttribute">\n        <input type="button" class="trix-button trix-button--dialog" value="'+E.unlink+'" data-trix-method="removeAttribute">\n      </div>\n    </div>\n  </div>\n</div>'}}}.call(this),function(){v.config.undoInterval=5e3}.call(this),function(){v.config.attachments={preview:{presentation:"gallery",caption:{name:!0,size:!0}},file:{caption:{size:!0}}}}.call(this),function(){v.config.keyNames={8:"backspace",9:"tab",13:"return",27:"escape",37:"left",39:"right",46:"delete",68:"d",72:"h",79:"o"}}.call(this),function(){v.config.input={level2Enabled:!0,getLevel:function(){return this.level2Enabled&&v.browser.supportsInputEvents?2:0},pickFiles:function(E){var b;return(b=v.makeElement("input",{type:"file",multiple:!0,hidden:!0,id:this.fileInputId})).addEventListener("change",function(){return E(b.files),v.removeNode(b)}),v.removeNode(document.getElementById(this.fileInputId)),document.body.appendChild(b),b.click()},fileInputId:"trix-file-input-"+Date.now().toString(16)}}.call(this),function(){}.call(this),function(){v.registerElement("trix-toolbar",{defaultCSS:"%t {\n  display: block;\n}\n\n%t {\n  white-space: nowrap;\n}\n\n%t [data-trix-dialog] {\n  display: none;\n}\n\n%t [data-trix-dialog][data-trix-active] {\n  display: block;\n}\n\n%t [data-trix-dialog] [data-trix-validate]:invalid {\n  background-color: #ffdddd;\n}",initialize:function(){return""===this.innerHTML?this.innerHTML=v.config.toolbar.getDefaultHTML():void 0}})}.call(this),function(){var b={}.hasOwnProperty,y=[].indexOf||function(l){for(var o=0,e=this.length;e>o;o++)if(o in this&&this[o]===l)return o;return-1};v.ObjectView=function(l){function o(e,s){this.object=e,this.options=null!=s?s:{},this.childViews=[],this.rootView=this}return function(l,o){function e(){this.constructor=l}for(var s in o)b.call(o,s)&&(l[s]=o[s]);e.prototype=o.prototype,l.prototype=new e,l.__super__=o.prototype}(o,l),o.prototype.getNodes=function(){var e,s,i,c;for(null==this.nodes&&(this.nodes=this.createNodes()),c=[],e=0,s=(i=this.nodes).length;s>e;e++)c.push(i[e].cloneNode(!0));return c},o.prototype.invalidate=function(){var e;return this.nodes=null,this.childViews=[],null!=(e=this.parentView)?e.invalidate():void 0},o.prototype.invalidateViewForObject=function(e){var s;return null!=(s=this.findViewForObject(e))?s.invalidate():void 0},o.prototype.findOrCreateCachedChildView=function(e,s){var d;return(d=this.getCachedViewForObject(s))?this.recordChildView(d):(d=this.createChildView.apply(this,arguments),this.cacheViewForObject(d,s)),d},o.prototype.createChildView=function(e,s,d){var i;return null==d&&(d={}),s instanceof v.ObjectGroup&&(d.viewClass=e,e=v.ObjectGroupView),i=new e(s,d),this.recordChildView(i)},o.prototype.recordChildView=function(e){return e.parentView=this,e.rootView=this.rootView,this.childViews.push(e),e},o.prototype.getAllChildViews=function(){var e,s,d,i,c;for(c=[],s=0,d=(i=this.childViews).length;d>s;s++)c.push(e=i[s]),c=c.concat(e.getAllChildViews());return c},o.prototype.findElement=function(){return this.findElementForObject(this.object)},o.prototype.findElementForObject=function(e){var s;return(s=null!=e?e.id:void 0)?this.rootView.element.querySelector("[data-trix-id='"+s+"']"):void 0},o.prototype.findViewForObject=function(e){var s,d,i,c;for(s=0,d=(i=this.getAllChildViews()).length;d>s;s++)if((c=i[s]).object===e)return c},o.prototype.getViewCache=function(){return this.rootView!==this?this.rootView.getViewCache():this.isViewCachingEnabled()?null!=this.viewCache?this.viewCache:this.viewCache={}:void 0},o.prototype.isViewCachingEnabled=function(){return!1!==this.shouldCacheViews},o.prototype.enableViewCaching=function(){return this.shouldCacheViews=!0},o.prototype.disableViewCaching=function(){return this.shouldCacheViews=!1},o.prototype.getCachedViewForObject=function(e){var s;return null!=(s=this.getViewCache())?s[e.getCacheKey()]:void 0},o.prototype.cacheViewForObject=function(e,s){var d;return null!=(d=this.getViewCache())?d[s.getCacheKey()]=e:void 0},o.prototype.garbageCollectCachedViews=function(){var e,s,d,i,a;if(e=this.getViewCache()){for(s in a=this.getAllChildViews().concat(this),d=function(){var n,p,u;for(u=[],n=0,p=a.length;p>n;n++)u.push(a[n].object.getCacheKey());return u}(),i=[],e)y.call(d,s)<0&&i.push(delete e[s]);return i}},o}(v.BasicObject)}.call(this),function(){var b={}.hasOwnProperty;v.ObjectGroupView=function(y){function l(){l.__super__.constructor.apply(this,arguments),this.objectGroup=this.object,this.viewClass=this.options.viewClass,delete this.options.viewClass}return function(y,l){function o(){this.constructor=y}for(var e in l)b.call(l,e)&&(y[e]=l[e]);o.prototype=l.prototype,y.prototype=new o,y.__super__=l.prototype}(l,y),l.prototype.getChildViews=function(){var o,e,d;if(!this.childViews.length)for(o=0,e=(d=this.objectGroup.getObjects()).length;e>o;o++)this.findOrCreateCachedChildView(this.viewClass,d[o],this.options);return this.childViews},l.prototype.createNodes=function(){var o,e,s,d,i,a,n;for(o=this.createContainerElement(),e=0,d=(a=this.getChildViews()).length;d>e;e++)for(s=0,i=(n=a[e].getNodes()).length;i>s;s++)o.appendChild(n[s]);return[o]},l.prototype.createContainerElement=function(o){return null==o&&(o=this.objectGroup.getDepth()),this.getChildViews()[0].createContainerElement(o)},l}(v.ObjectView)}.call(this),function(){var b={}.hasOwnProperty;v.Controller=function(y){function l(){return l.__super__.constructor.apply(this,arguments)}return function(y,l){function o(){this.constructor=y}for(var e in l)b.call(l,e)&&(y[e]=l[e]);o.prototype=l.prototype,y.prototype=new o,y.__super__=l.prototype}(l,y),l}(v.BasicObject)}.call(this),function(){var E,b,y,l,o,e,i={}.hasOwnProperty,c=[].indexOf||function(a){for(var n=0,p=this.length;p>n;n++)if(n in this&&this[n]===a)return n;return-1};E=v.findClosestElementFromNode,y=v.nodeIsEmptyTextNode,b=v.nodeIsBlockStartComment,l=v.normalizeSpaces,o=v.summarizeStringChange,e=v.tagName,v.MutationObserver=function(a){function n(r){this.element=r,this.didMutate=function(a,n){return function(){return a.apply(n,arguments)}}(this.didMutate,this),this.observer=new window.MutationObserver(this.didMutate),this.start()}var p,t;return function(a,n){function p(){this.constructor=a}for(var u in n)i.call(n,u)&&(a[u]=n[u]);p.prototype=n.prototype,a.prototype=new p,a.__super__=n.prototype}(n,a),"data-trix-mutable",t={attributes:!0,childList:!0,characterData:!0,characterDataOldValue:!0,subtree:!0},n.prototype.start=function(){return this.reset(),this.observer.observe(this.element,t)},n.prototype.stop=function(){return this.observer.disconnect()},n.prototype.didMutate=function(r){var h,A;return(h=this.mutations).push.apply(h,this.findSignificantMutations(r)),this.mutations.length?(null!=(A=this.delegate)&&"function"==typeof A.elementDidMutate&&A.elementDidMutate(this.getMutationSummary()),this.reset()):void 0},n.prototype.reset=function(){return this.mutations=[]},n.prototype.findSignificantMutations=function(r){var h,A,f,g;for(g=[],h=0,A=r.length;A>h;h++)this.mutationIsSignificant(f=r[h])&&g.push(f);return g},n.prototype.mutationIsSignificant=function(r){var h,A,g;if(this.nodeIsMutable(r.target))return!1;for(h=0,A=(g=this.nodesModifiedByMutation(r)).length;A>h;h++)if(this.nodeIsSignificant(g[h]))return!0;return!1},n.prototype.nodeIsSignificant=function(r){return r!==this.element&&!this.nodeIsMutable(r)&&!y(r)},n.prototype.nodeIsMutable=function(r){return E(r,{matchingSelector:"[data-trix-mutable]"})},n.prototype.nodesModifiedByMutation=function(r){var h;switch(h=[],r.type){case"attributes":"data-trix-mutable"!==r.attributeName&&h.push(r.target);break;case"characterData":h.push(r.target.parentNode),h.push(r.target);break;case"childList":h.push.apply(h,r.addedNodes),h.push.apply(h,r.removedNodes)}return h},n.prototype.getMutationSummary=function(){return this.getTextMutationSummary()},n.prototype.getTextMutationSummary=function(){var r,h,A,f,g,w,k,O,j,L,R;for(A=(O=this.getTextChangesFromCharacterData()).additions,g=O.deletions,w=0,k=(j=(R=this.getTextChangesFromChildList()).additions).length;k>w;w++)c.call(A,h=j[w])<0&&A.push(h);return g.push.apply(g,R.deletions),L={},(r=A.join(""))&&(L.textAdded=r),(f=g.join(""))&&(L.textDeleted=f),L},n.prototype.getMutationsByType=function(r){var h,A,f,g,w;for(w=[],h=0,A=(g=this.mutations).length;A>h;h++)(f=g[h]).type===r&&w.push(f);return w},n.prototype.getTextChangesFromChildList=function(){var r,h,A,f,g,w,k,j,L,R;for(r=[],k=[],h=0,f=(w=this.getMutationsByType("childList")).length;f>h;h++)r.push.apply(r,(g=w[h]).addedNodes),k.push.apply(k,g.removedNodes);return 0===r.length&&1===k.length&&b(k[0])?(L=[],R=["\n"]):(L=p(r),R=p(k)),{additions:function(){var T,C,x;for(x=[],A=T=0,C=L.length;C>T;A=++T)(j=L[A])!==R[A]&&x.push(l(j));return x}(),deletions:function(){var T,C,x;for(x=[],A=T=0,C=R.length;C>T;A=++T)(j=R[A])!==L[A]&&x.push(l(j));return x}()}},n.prototype.getTextChangesFromCharacterData=function(){var r,h,A,f,g,w,k;return(h=this.getMutationsByType("characterData")).length&&(A=h[h.length-1],g=l(h[0].oldValue),f=l(A.target.data),r=(w=o(g,f)).added,k=w.removed),{additions:r?[r]:[],deletions:k?[k]:[]}},p=function(r){var h,A,f,g;for(null==r&&(r=[]),g=[],h=0,A=r.length;A>h;h++)switch(f=r[h],f.nodeType){case Node.TEXT_NODE:g.push(f.data);break;case Node.ELEMENT_NODE:"br"===e(f)?g.push("\n"):g.push.apply(g,p(f.childNodes))}return g},n}(v.BasicObject)}.call(this),function(){var b={}.hasOwnProperty;v.FileVerificationOperation=function(y){function l(o){this.file=o}return function(y,l){function o(){this.constructor=y}for(var e in l)b.call(l,e)&&(y[e]=l[e]);o.prototype=l.prototype,y.prototype=new o,y.__super__=l.prototype}(l,y),l.prototype.perform=function(o){var e,s;return(e=new FileReader).onerror=function(){return o(!1)},e.onload=(s=this,function(){e.onerror=null;try{e.abort()}catch(d){}return o(!0,s.file)}),e.readAsArrayBuffer(this.file)},l}(v.Operation)}.call(this),function(){var E,b,l={}.hasOwnProperty;E=v.handleEvent,b=v.innerElementIsActive,v.InputController=function(o){function e(s){var d;for(d in this.element=s,this.mutationObserver=new v.MutationObserver(this.element),this.mutationObserver.delegate=this,this.events)E(d,{onElement:this.element,withCallback:this.handlerFor(d)})}return function(o,e){function s(){this.constructor=o}for(var d in e)l.call(e,d)&&(o[d]=e[d]);s.prototype=e.prototype,o.prototype=new s,o.__super__=e.prototype}(e,o),e.prototype.events={},e.prototype.elementDidMutate=function(){},e.prototype.editorWillSyncDocumentView=function(){return this.mutationObserver.stop()},e.prototype.editorDidSyncDocumentView=function(){return this.mutationObserver.start()},e.prototype.requestRender=function(){var s;return null!=(s=this.delegate)&&"function"==typeof s.inputControllerDidRequestRender?s.inputControllerDidRequestRender():void 0},e.prototype.requestReparse=function(){var s;return null!=(s=this.delegate)&&"function"==typeof s.inputControllerDidRequestReparse&&s.inputControllerDidRequestReparse(),this.requestRender()},e.prototype.attachFiles=function(s){var i,c;return i=function(){var c,a,n;for(n=[],c=0,a=s.length;a>c;c++)n.push(new v.FileVerificationOperation(s[c]));return n}(),Promise.all(i).then((c=this,function(a){return c.handleInput(function(){var n,p;return null!=(n=this.delegate)&&n.inputControllerWillAttachFiles(),null!=(p=this.responder)&&p.insertFiles(a),this.requestRender()})}))},e.prototype.handlerFor=function(s){return d=this,function(i){return i.defaultPrevented?void 0:d.handleInput(function(){return b(this.element)?void 0:(this.eventName=s,this.events[s].call(this,i))})};var d},e.prototype.handleInput=function(s){var d,i;try{return null!=(d=this.delegate)&&d.inputControllerWillHandleInput(),s.call(this)}finally{null!=(i=this.delegate)&&i.inputControllerDidHandleInput()}},e.prototype.createLinkHTML=function(s,d){var i;return(i=document.createElement("a")).href=s,i.textContent=null!=d?d:s,i.outerHTML},e}(v.BasicObject)}.call(this),function(){var E,b,y,l,o,e,s,d,i,c,a,n,u=function(r,h){function A(){this.constructor=r}for(var f in h)m.call(h,f)&&(r[f]=h[f]);return A.prototype=h.prototype,r.prototype=new A,r.__super__=h.prototype,r},m={}.hasOwnProperty,t=[].indexOf||function(r){for(var h=0,A=this.length;A>h;h++)if(h in this&&this[h]===r)return h;return-1};i=v.makeElement,c=v.objectsAreEqual,b=v.browser,s=v.keyEventIsKeyboardCommand,l=v.dataTransferIsWritable,y=v.dataTransferIsPlainText,d=v.config.keyNames,v.Level0InputController=function(r){function h(){h.__super__.constructor.apply(this,arguments),this.resetInputSummary()}var A;return u(h,r),A=0,h.prototype.setInputSummary=function(f){var g;for(g in null==f&&(f={}),this.inputSummary.eventName=this.eventName,f)this.inputSummary[g]=f[g];return this.inputSummary},h.prototype.resetInputSummary=function(){return this.inputSummary={}},h.prototype.reset=function(){return this.resetInputSummary(),v.selectionChangeObserver.reset()},h.prototype.elementDidMutate=function(f){var g;return this.isComposing()?null!=(g=this.delegate)&&"function"==typeof g.inputControllerDidAllowUnhandledInput?g.inputControllerDidAllowUnhandledInput():void 0:this.handleInput(function(){return this.mutationIsSignificant(f)&&(this.mutationIsExpected(f)?this.requestRender():this.requestReparse()),this.reset()})},h.prototype.mutationIsExpected=function(f){var g,w,k,O,j,R,T,C,x;return R=f.textAdded,T=f.textDeleted,!!this.inputSummary.preferDocument||(g=null!=R?R===this.inputSummary.textAdded:!this.inputSummary.textAdded,w=null!=T?this.inputSummary.didDelete:!this.inputSummary.didDelete,x="\n"===T&&!w,!!(((C=("\n"===R||" \n"===R)&&!g)&&!x||x&&!C)&&(O=this.getSelectedRange())&&(k=C?R.replace(/\n$/,"").length||-1:(null!=R?R.length:void 0)||1,null!=(j=this.responder)?j.positionIsBlockBreak(O[1]+k):void 0))||g&&w)},h.prototype.mutationIsSignificant=function(f){var g,w,k;return k=Object.keys(f).length>0,g=""===(null!=(w=this.compositionInput)?w.getEndData():void 0),k||!g},h.prototype.events={keydown:function(f){var g,w,k,O,j,L,R,T,C;if(this.isComposing()||this.resetInputSummary(),this.inputSummary.didInput=!0,O=d[f.keyCode]){for(w=this.keys,k=0,L=(T=["ctrl","alt","shift","meta"]).length;L>k;k++)f[(R=T[k])+"Key"]&&("ctrl"===R&&(R="control"),w=null!=w?w[R]:void 0);null!=(null!=w?w[O]:void 0)&&(this.setInputSummary({keyName:O}),v.selectionChangeObserver.reset(),w[O].call(this,f))}return s(f)&&(g=String.fromCharCode(f.keyCode).toLowerCase())&&((j=function(){var x,B,Z,ft;for(ft=[],x=0,B=(Z=["alt","shift"]).length;B>x;x++)f[(R=Z[x])+"Key"]&&ft.push(R);return ft}()).push(g),null!=(C=this.delegate)?C.inputControllerDidReceiveKeyboardCommand(j):void 0)?f.preventDefault():void 0},keypress:function(f){var g,w,k;if(null==this.inputSummary.eventName&&!f.metaKey&&(!f.ctrlKey||f.altKey))return(k=n(f))?(null!=(g=this.delegate)&&g.inputControllerWillPerformTyping(),null!=(w=this.responder)&&w.insertString(k),this.setInputSummary({textAdded:k,didDelete:this.selectionIsExpanded()})):void 0},textInput:function(f){var g,w,k,O;return g=f.data,(O=this.inputSummary.textAdded)&&O!==g&&O.toUpperCase()===g?(w=this.getSelectedRange(),this.setSelectedRange([w[0],w[1]+O.length]),null!=(k=this.responder)&&k.insertString(g),this.setInputSummary({textAdded:g}),this.setSelectedRange(w)):void 0},dragenter:function(f){return f.preventDefault()},dragstart:function(f){var g;return this.serializeSelectionToDataTransfer(f.dataTransfer),this.draggedRange=this.getSelectedRange(),null!=(g=this.delegate)&&"function"==typeof g.inputControllerDidStartDrag?g.inputControllerDidStartDrag():void 0},dragover:function(f){var g,w;return!this.draggedRange&&!this.canAcceptDataTransfer(f.dataTransfer)||(f.preventDefault(),c(g={x:f.clientX,y:f.clientY},this.draggingPoint))?void 0:(this.draggingPoint=g,null!=(w=this.delegate)&&"function"==typeof w.inputControllerDidReceiveDragOverPoint?w.inputControllerDidReceiveDragOverPoint(this.draggingPoint):void 0)},dragend:function(){var f;return null!=(f=this.delegate)&&"function"==typeof f.inputControllerDidCancelDrag&&f.inputControllerDidCancelDrag(),this.draggedRange=null,this.draggingPoint=null},drop:function(f){var g,w,k,j,L,R,T,C;return f.preventDefault(),k=null!=(j=f.dataTransfer)?j.files:void 0,null!=(L=this.responder)&&L.setLocationRangeFromPointRange({x:f.clientX,y:f.clientY}),(null!=k?k.length:void 0)?this.attachFiles(k):this.draggedRange?(null!=(R=this.delegate)&&R.inputControllerWillMoveText(),null!=(T=this.responder)&&T.moveTextFromRange(this.draggedRange),this.draggedRange=null,this.requestRender()):(w=f.dataTransfer.getData("application/x-trix-document"))&&(g=v.Document.fromJSONString(w),null!=(C=this.responder)&&C.insertDocument(g),this.requestRender()),this.draggedRange=null,this.draggingPoint=null},cut:function(f){var g,w;return(null!=(g=this.responder)?g.selectionIsExpanded():void 0)&&(this.serializeSelectionToDataTransfer(f.clipboardData)&&f.preventDefault(),null!=(w=this.delegate)&&w.inputControllerWillCutText(),this.deleteInDirection("backward"),f.defaultPrevented)?this.requestRender():void 0},copy:function(f){var g;return(null!=(g=this.responder)?g.selectionIsExpanded():void 0)&&this.serializeSelectionToDataTransfer(f.clipboardData)?f.preventDefault():void 0},paste:function(f){var g,w,k,O,j,L,R,T,C,x,B,Z,ft,At,Wt,Dt,Zt,fe,oe,pe,ue,P,q,Q;return g=null!=(T=f.clipboardData)?T:f.testClipboardData,R={clipboard:g},null==g||a(f)?void this.getPastedHTMLUsingHiddenElement((Q=this,function(tt){var ut,pt,xt;return R.type="text/html",R.html=tt,null!=(ut=Q.delegate)&&ut.inputControllerWillPaste(R),null!=(pt=Q.responder)&&pt.insertHTML(R.html),Q.requestRender(),null!=(xt=Q.delegate)?xt.inputControllerDidPaste(R):void 0})):((O=g.getData("URL"))?(R.type="text/html",q=(L=g.getData("public.url-name"))?v.squishBreakableWhitespace(L).trim():O,R.html=this.createLinkHTML(O,q),null!=(C=this.delegate)&&C.inputControllerWillPaste(R),this.setInputSummary({textAdded:q,didDelete:this.selectionIsExpanded()}),null!=(Wt=this.responder)&&Wt.insertHTML(R.html),this.requestRender(),null!=(Dt=this.delegate)&&Dt.inputControllerDidPaste(R)):y(g)?(R.type="text/plain",R.string=g.getData("text/plain"),null!=(Zt=this.delegate)&&Zt.inputControllerWillPaste(R),this.setInputSummary({textAdded:R.string,didDelete:this.selectionIsExpanded()}),null!=(fe=this.responder)&&fe.insertString(R.string),this.requestRender(),null!=(oe=this.delegate)&&oe.inputControllerDidPaste(R)):(j=g.getData("text/html"))?(R.type="text/html",R.html=j,null!=(pe=this.delegate)&&pe.inputControllerWillPaste(R),null!=(ue=this.responder)&&ue.insertHTML(R.html),this.requestRender(),null!=(P=this.delegate)&&P.inputControllerDidPaste(R)):t.call(g.types,"Files")>=0&&(k=null!=(x=g.items)&&null!=(B=x[0])&&"function"==typeof B.getAsFile?B.getAsFile():void 0)&&(!k.name&&(w=o(k))&&(k.name="pasted-file-"+ ++A+"."+w),R.type="File",R.file=k,null!=(Z=this.delegate)&&Z.inputControllerWillAttachFiles(),null!=(ft=this.responder)&&ft.insertFile(R.file),this.requestRender(),null!=(At=this.delegate)&&At.inputControllerDidPaste(R)),f.preventDefault())},compositionstart:function(f){return this.getCompositionInput().start(f.data)},compositionupdate:function(f){return this.getCompositionInput().update(f.data)},compositionend:function(f){return this.getCompositionInput().end(f.data)},beforeinput:function(){return this.inputSummary.didInput=!0},input:function(f){return this.inputSummary.didInput=!0,f.stopPropagation()}},h.prototype.keys={backspace:function(f){var g;return null!=(g=this.delegate)&&g.inputControllerWillPerformTyping(),this.deleteInDirection("backward",f)},delete:function(f){var g;return null!=(g=this.delegate)&&g.inputControllerWillPerformTyping(),this.deleteInDirection("forward",f)},return:function(){var f,g;return this.setInputSummary({preferDocument:!0}),null!=(f=this.delegate)&&f.inputControllerWillPerformTyping(),null!=(g=this.responder)?g.insertLineBreak():void 0},tab:function(f){var g,w;return(null!=(g=this.responder)?g.canIncreaseNestingLevel():void 0)?(null!=(w=this.responder)&&w.increaseNestingLevel(),this.requestRender(),f.preventDefault()):void 0},left:function(f){var g;return this.selectionIsInCursorTarget()?(f.preventDefault(),null!=(g=this.responder)?g.moveCursorInDirection("backward"):void 0):void 0},right:function(f){var g;return this.selectionIsInCursorTarget()?(f.preventDefault(),null!=(g=this.responder)?g.moveCursorInDirection("forward"):void 0):void 0},control:{d:function(f){var g;return null!=(g=this.delegate)&&g.inputControllerWillPerformTyping(),this.deleteInDirection("forward",f)},h:function(f){var g;return null!=(g=this.delegate)&&g.inputControllerWillPerformTyping(),this.deleteInDirection("backward",f)},o:function(f){var g,w;return f.preventDefault(),null!=(g=this.delegate)&&g.inputControllerWillPerformTyping(),null!=(w=this.responder)&&w.insertString("\n",{updatePosition:!1}),this.requestRender()}},shift:{return:function(f){var g,w;return null!=(g=this.delegate)&&g.inputControllerWillPerformTyping(),null!=(w=this.responder)&&w.insertString("\n"),this.requestRender(),f.preventDefault()},tab:function(f){var g,w;return(null!=(g=this.responder)?g.canDecreaseNestingLevel():void 0)?(null!=(w=this.responder)&&w.decreaseNestingLevel(),this.requestRender(),f.preventDefault()):void 0},left:function(f){return this.selectionIsInCursorTarget()?(f.preventDefault(),this.expandSelectionInDirection("backward")):void 0},right:function(f){return this.selectionIsInCursorTarget()?(f.preventDefault(),this.expandSelectionInDirection("forward")):void 0}},alt:{backspace:function(){var f;return this.setInputSummary({preferDocument:!1}),null!=(f=this.delegate)?f.inputControllerWillPerformTyping():void 0}},meta:{backspace:function(){var f;return this.setInputSummary({preferDocument:!1}),null!=(f=this.delegate)?f.inputControllerWillPerformTyping():void 0}}},h.prototype.getCompositionInput=function(){return this.isComposing()?this.compositionInput:this.compositionInput=new E(this)},h.prototype.isComposing=function(){return null!=this.compositionInput&&!this.compositionInput.isEnded()},h.prototype.deleteInDirection=function(f,g){var w;return!1!==(null!=(w=this.responder)?w.deleteInDirection(f):void 0)?this.setInputSummary({didDelete:!0}):g?(g.preventDefault(),this.requestRender()):void 0},h.prototype.serializeSelectionToDataTransfer=function(f){var g,w;if(l(f))return g=null!=(w=this.responder)?w.getSelectedDocument().toSerializableDocument():void 0,f.setData("application/x-trix-document",JSON.stringify(g)),f.setData("text/html",v.DocumentView.render(g).innerHTML),f.setData("text/plain",g.toString().replace(/\n$/,"")),!0},h.prototype.canAcceptDataTransfer=function(f){var g,w,k,O,L;for(L={},g=0,w=(O=null!=(k=null!=f?f.types:void 0)?k:[]).length;w>g;g++)L[O[g]]=!0;return L.Files||L["application/x-trix-document"]||L["text/html"]||L["text/plain"]},h.prototype.getPastedHTMLUsingHiddenElement=function(f){var g,w,k,O;return w=this.getSelectedRange(),k={position:"absolute",left:window.pageXOffset+"px",top:window.pageYOffset+"px",opacity:0},g=i({style:k,tagName:"div",editable:!0}),document.body.appendChild(g),g.focus(),requestAnimationFrame((O=this,function(){var j;return j=g.innerHTML,v.removeNode(g),O.setSelectedRange(w),f(j)}))},h.proxyMethod("responder?.getSelectedRange"),h.proxyMethod("responder?.setSelectedRange"),h.proxyMethod("responder?.expandSelectionInDirection"),h.proxyMethod("responder?.selectionIsInCursorTarget"),h.proxyMethod("responder?.selectionIsExpanded"),h}(v.InputController),o=function(r){var h,A;return null!=(h=r.type)&&null!=(A=h.match(/\/(\w+)$/))?A[1]:void 0},e=null!=("function"==typeof" ".codePointAt?" ".codePointAt(0):void 0),n=function(r){var h;return r.key&&e&&r.key.codePointAt(0)===r.keyCode?r.key:(null===r.which?h=r.keyCode:0!==r.which&&0!==r.charCode&&(h=r.charCode),null!=h&&"escape"!==d[h]?v.UTF16String.fromCodepoints([h]).toString():void 0)},a=function(r){var h,A,f,g,w,k,j,L,R;if(j=r.clipboardData){if(t.call(j.types,"text/html")>=0){for(f=0,k=(L=j.types).length;k>f;f++)if(h=/^CorePasteboardFlavorType/.test(R=L[f]),A=/^dyn\./.test(R)&&j.getData(R),h||A)return!0;return!1}return g=t.call(j.types,"com.apple.webarchive")>=0,w=t.call(j.types,"com.apple.flat-rtfd")>=0,g||w}},E=function(r){function h(A){var f;this.inputController=A,this.responder=(f=this.inputController).responder,this.delegate=f.delegate,this.inputSummary=f.inputSummary,this.data={}}return u(h,r),h.prototype.start=function(A){var f,g;return this.data.start=A,this.isSignificant()?("keypress"===this.inputSummary.eventName&&this.inputSummary.textAdded&&null!=(f=this.responder)&&f.deleteInDirection("left"),this.selectionIsExpanded()||(this.insertPlaceholder(),this.requestRender()),this.range=null!=(g=this.responder)?g.getSelectedRange():void 0):void 0},h.prototype.update=function(A){var f;return this.data.update=A,this.isSignificant()&&(f=this.selectPlaceholder())?(this.forgetPlaceholder(),this.range=f):void 0},h.prototype.end=function(A){var f,g,w,k;return this.data.end=A,this.isSignificant()?(this.forgetPlaceholder(),this.canApplyToDocument()?(this.setInputSummary({preferDocument:!0,didInput:!1}),null!=(f=this.delegate)&&f.inputControllerWillPerformTyping(),null!=(g=this.responder)&&g.setSelectedRange(this.range),null!=(w=this.responder)&&w.insertString(this.data.end),null!=(k=this.responder)?k.setSelectedRange(this.range[0]+this.data.end.length):void 0):null!=this.data.start||null!=this.data.update?(this.requestReparse(),this.inputController.reset()):void 0):this.inputController.reset()},h.prototype.getEndData=function(){return this.data.end},h.prototype.isEnded=function(){return null!=this.getEndData()},h.prototype.isSignificant=function(){return!b.composesExistingText||this.inputSummary.didInput},h.prototype.canApplyToDocument=function(){var A,f;return 0===(null!=(A=this.data.start)?A.length:void 0)&&(null!=(f=this.data.end)?f.length:void 0)>0&&null!=this.range},h.proxyMethod("inputController.setInputSummary"),h.proxyMethod("inputController.requestRender"),h.proxyMethod("inputController.requestReparse"),h.proxyMethod("responder?.selectionIsExpanded"),h.proxyMethod("responder?.insertPlaceholder"),h.proxyMethod("responder?.selectPlaceholder"),h.proxyMethod("responder?.forgetPlaceholder"),h}(v.BasicObject)}.call(this),function(){var E,b,y,l=function(d,i){return function(){return d.apply(i,arguments)}},e={}.hasOwnProperty,s=[].indexOf||function(d){for(var i=0,c=this.length;c>i;i++)if(i in this&&this[i]===d)return i;return-1};E=v.dataTransferIsPlainText,b=v.keyEventIsKeyboardCommand,y=v.objectsAreEqual,v.Level2InputController=function(d){function i(){return this.render=l(this.render,this),i.__super__.constructor.apply(this,arguments)}var c,a,n,p,u,m;return function(d,i){function c(){this.constructor=d}for(var a in i)e.call(i,a)&&(d[a]=i[a]);c.prototype=i.prototype,d.prototype=new c,d.__super__=i.prototype}(i,d),i.prototype.elementDidMutate=function(){var t;return this.scheduledRender?this.composing&&null!=(t=this.delegate)&&"function"==typeof t.inputControllerDidAllowUnhandledInput?t.inputControllerDidAllowUnhandledInput():void 0:this.reparse()},i.prototype.scheduleRender=function(){return null!=this.scheduledRender?this.scheduledRender:this.scheduledRender=requestAnimationFrame(this.render)},i.prototype.render=function(){var t;return cancelAnimationFrame(this.scheduledRender),this.scheduledRender=null,this.composing||null!=(t=this.delegate)&&t.render(),"function"==typeof this.afterRender&&this.afterRender(),this.afterRender=null},i.prototype.reparse=function(){var t;return null!=(t=this.delegate)?t.reparse():void 0},i.prototype.events={keydown:function(t){var r,h,A,f;if(b(t)){if(r=a(t),null!=(f=this.delegate)?f.inputControllerDidReceiveKeyboardCommand(r):void 0)return t.preventDefault()}else if(A=t.key,t.altKey&&(A+="+Alt"),t.shiftKey&&(A+="+Shift"),h=this.keys[A])return this.withEvent(t,h)},paste:function(t){var r,h,A,f,g,w,k,O,j;return n(t)?(t.preventDefault(),this.attachFiles(t.clipboardData.files)):p(t)?(t.preventDefault(),h={type:"text/plain",string:t.clipboardData.getData("text/plain")},null!=(A=this.delegate)&&A.inputControllerWillPaste(h),null!=(f=this.responder)&&f.insertString(h.string),this.render(),null!=(g=this.delegate)?g.inputControllerDidPaste(h):void 0):(r=null!=(w=t.clipboardData)?w.getData("URL"):void 0)?(t.preventDefault(),h={type:"text/html",html:this.createLinkHTML(r)},null!=(k=this.delegate)&&k.inputControllerWillPaste(h),null!=(O=this.responder)&&O.insertHTML(h.html),this.render(),null!=(j=this.delegate)?j.inputControllerDidPaste(h):void 0):void 0},beforeinput:function(t){var r;return(r=this.inputTypes[t.inputType])?(this.withEvent(t,r),this.scheduleRender()):void 0},input:function(){return v.selectionChangeObserver.reset()},dragstart:function(t){var r,h;return(null!=(r=this.responder)?r.selectionContainsAttachments():void 0)?(t.dataTransfer.setData("application/x-trix-dragging",!0),this.dragging={range:null!=(h=this.responder)?h.getSelectedRange():void 0,point:u(t)}):void 0},dragenter:function(t){return c(t)?t.preventDefault():void 0},dragover:function(t){var r,h;if(this.dragging){if(t.preventDefault(),r=u(t),!y(r,this.dragging.point))return this.dragging.point=r,null!=(h=this.responder)?h.setLocationRangeFromPointRange(r):void 0}else if(c(t))return t.preventDefault()},drop:function(t){var r,h,A,f;return this.dragging?(t.preventDefault(),null!=(h=this.delegate)&&h.inputControllerWillMoveText(),null!=(A=this.responder)&&A.moveTextFromRange(this.dragging.range),this.dragging=null,this.scheduleRender()):c(t)?(t.preventDefault(),r=u(t),null!=(f=this.responder)&&f.setLocationRangeFromPointRange(r),this.attachFiles(t.dataTransfer.files)):void 0},dragend:function(){var t;return this.dragging?(null!=(t=this.responder)&&t.setSelectedRange(this.dragging.range),this.dragging=null):void 0},compositionend:function(){return this.composing?(this.composing=!1,this.scheduleRender()):void 0}},i.prototype.keys={ArrowLeft:function(){var t,r;return(null!=(t=this.responder)?t.shouldManageMovingCursorInDirection("backward"):void 0)?(this.event.preventDefault(),null!=(r=this.responder)?r.moveCursorInDirection("backward"):void 0):void 0},ArrowRight:function(){var t,r;return(null!=(t=this.responder)?t.shouldManageMovingCursorInDirection("forward"):void 0)?(this.event.preventDefault(),null!=(r=this.responder)?r.moveCursorInDirection("forward"):void 0):void 0},Backspace:function(){var t,r,h;return(null!=(t=this.responder)?t.shouldManageDeletingInDirection("backward"):void 0)?(this.event.preventDefault(),null!=(r=this.delegate)&&r.inputControllerWillPerformTyping(),null!=(h=this.responder)&&h.deleteInDirection("backward"),this.render()):void 0},Tab:function(){var t,r;return(null!=(t=this.responder)?t.canIncreaseNestingLevel():void 0)?(this.event.preventDefault(),null!=(r=this.responder)&&r.increaseNestingLevel(),this.render()):void 0},"Tab+Shift":function(){var t,r;return(null!=(t=this.responder)?t.canDecreaseNestingLevel():void 0)?(this.event.preventDefault(),null!=(r=this.responder)&&r.decreaseNestingLevel(),this.render()):void 0}},i.prototype.inputTypes={deleteByComposition:function(){return this.deleteInDirection("backward",{recordUndoEntry:!1})},deleteByCut:function(){return this.deleteInDirection("backward")},deleteByDrag:function(){return this.event.preventDefault(),this.withTargetDOMRange(function(){var t;return this.deleteByDragRange=null!=(t=this.responder)?t.getSelectedRange():void 0})},deleteCompositionText:function(){return this.deleteInDirection("backward",{recordUndoEntry:!1})},deleteContent:function(){return this.deleteInDirection("backward")},deleteContentBackward:function(){return this.deleteInDirection("backward")},deleteContentForward:function(){return this.deleteInDirection("forward")},deleteEntireSoftLine:function(){return this.deleteInDirection("forward")},deleteHardLineBackward:function(){return this.deleteInDirection("backward")},deleteHardLineForward:function(){return this.deleteInDirection("forward")},deleteSoftLineBackward:function(){return this.deleteInDirection("backward")},deleteSoftLineForward:function(){return this.deleteInDirection("forward")},deleteWordBackward:function(){return this.deleteInDirection("backward")},deleteWordForward:function(){return this.deleteInDirection("forward")},formatBackColor:function(){return this.activateAttributeIfSupported("backgroundColor",this.event.data)},formatBold:function(){return this.toggleAttributeIfSupported("bold")},formatFontColor:function(){return this.activateAttributeIfSupported("color",this.event.data)},formatFontName:function(){return this.activateAttributeIfSupported("font",this.event.data)},formatIndent:function(){var t;return(null!=(t=this.responder)?t.canIncreaseNestingLevel():void 0)?this.withTargetDOMRange(function(){var r;return null!=(r=this.responder)?r.increaseNestingLevel():void 0}):void 0},formatItalic:function(){return this.toggleAttributeIfSupported("italic")},formatJustifyCenter:function(){return this.toggleAttributeIfSupported("justifyCenter")},formatJustifyFull:function(){return this.toggleAttributeIfSupported("justifyFull")},formatJustifyLeft:function(){return this.toggleAttributeIfSupported("justifyLeft")},formatJustifyRight:function(){return this.toggleAttributeIfSupported("justifyRight")},formatOutdent:function(){var t;return(null!=(t=this.responder)?t.canDecreaseNestingLevel():void 0)?this.withTargetDOMRange(function(){var r;return null!=(r=this.responder)?r.decreaseNestingLevel():void 0}):void 0},formatRemove:function(){return this.withTargetDOMRange(function(){var t,r,h,A;for(t in A=[],null!=(r=this.responder)?r.getCurrentAttributes():void 0)A.push(null!=(h=this.responder)?h.removeCurrentAttribute(t):void 0);return A})},formatSetBlockTextDirection:function(){return this.activateAttributeIfSupported("blockDir",this.event.data)},formatSetInlineTextDirection:function(){return this.activateAttributeIfSupported("textDir",this.event.data)},formatStrikeThrough:function(){return this.toggleAttributeIfSupported("strike")},formatSubscript:function(){return this.toggleAttributeIfSupported("sub")},formatSuperscript:function(){return this.toggleAttributeIfSupported("sup")},formatUnderline:function(){return this.toggleAttributeIfSupported("underline")},historyRedo:function(){var t;return null!=(t=this.delegate)?t.inputControllerWillPerformRedo():void 0},historyUndo:function(){var t;return null!=(t=this.delegate)?t.inputControllerWillPerformUndo():void 0},insertCompositionText:function(){return this.composing=!0,this.insertString(this.event.data)},insertFromComposition:function(){return this.composing=!1,this.insertString(this.event.data)},insertFromDrop:function(){var t,r;return(t=this.deleteByDragRange)?(this.deleteByDragRange=null,null!=(r=this.delegate)&&r.inputControllerWillMoveText(),this.withTargetDOMRange(function(){var h;return null!=(h=this.responder)?h.moveTextFromRange(t):void 0})):void 0},insertFromPaste:function(){var t,r,h,A,f,g,w,k,O,j,L,R;return f={dataTransfer:t=this.event.dataTransfer},(r=t.getData("URL"))?(this.event.preventDefault(),f.type="text/html",L=(A=t.getData("public.url-name"))?v.squishBreakableWhitespace(A).trim():r,f.html=this.createLinkHTML(r,L),null!=(g=this.delegate)&&g.inputControllerWillPaste(f),this.withTargetDOMRange(function(){var R;return null!=(R=this.responder)?R.insertHTML(f.html):void 0}),this.afterRender=(R=this,function(){var T;return null!=(T=R.delegate)?T.inputControllerDidPaste(f):void 0})):E(t)?(f.type="text/plain",f.string=t.getData("text/plain"),null!=(w=this.delegate)&&w.inputControllerWillPaste(f),this.withTargetDOMRange(function(){var R;return null!=(R=this.responder)?R.insertString(f.string):void 0}),this.afterRender=function(R){return function(){var T;return null!=(T=R.delegate)?T.inputControllerDidPaste(f):void 0}}(this)):(h=t.getData("text/html"))?(this.event.preventDefault(),f.type="text/html",f.html=h,null!=(k=this.delegate)&&k.inputControllerWillPaste(f),this.withTargetDOMRange(function(){var R;return null!=(R=this.responder)?R.insertHTML(f.html):void 0}),this.afterRender=function(R){return function(){var T;return null!=(T=R.delegate)?T.inputControllerDidPaste(f):void 0}}(this)):(null!=(O=t.files)?O.length:void 0)?(f.type="File",f.file=t.files[0],null!=(j=this.delegate)&&j.inputControllerWillPaste(f),this.withTargetDOMRange(function(){var R;return null!=(R=this.responder)?R.insertFile(f.file):void 0}),this.afterRender=function(R){return function(){var T;return null!=(T=R.delegate)?T.inputControllerDidPaste(f):void 0}}(this)):void 0},insertFromYank:function(){return this.insertString(this.event.data)},insertLineBreak:function(){return this.insertString("\n")},insertLink:function(){return this.activateAttributeIfSupported("href",this.event.data)},insertOrderedList:function(){return this.toggleAttributeIfSupported("number")},insertParagraph:function(){var t;return null!=(t=this.delegate)&&t.inputControllerWillPerformTyping(),this.withTargetDOMRange(function(){var r;return null!=(r=this.responder)?r.insertLineBreak():void 0})},insertReplacementText:function(){return this.insertString(this.event.dataTransfer.getData("text/plain"),{updatePosition:!1})},insertText:function(){var t,r;return this.insertString(null!=(t=this.event.data)?t:null!=(r=this.event.dataTransfer)?r.getData("text/plain"):void 0)},insertTranspose:function(){return this.insertString(this.event.data)},insertUnorderedList:function(){return this.toggleAttributeIfSupported("bullet")}},i.prototype.insertString=function(t,r){var h;return null==t&&(t=""),null!=(h=this.delegate)&&h.inputControllerWillPerformTyping(),this.withTargetDOMRange(function(){var A;return null!=(A=this.responder)?A.insertString(t,r):void 0})},i.prototype.toggleAttributeIfSupported=function(t){var r;return s.call(v.getAllAttributeNames(),t)>=0?(null!=(r=this.delegate)&&r.inputControllerWillPerformFormatting(t),this.withTargetDOMRange(function(){var h;return null!=(h=this.responder)?h.toggleCurrentAttribute(t):void 0})):void 0},i.prototype.activateAttributeIfSupported=function(t,r){var h;return s.call(v.getAllAttributeNames(),t)>=0?(null!=(h=this.delegate)&&h.inputControllerWillPerformFormatting(t),this.withTargetDOMRange(function(){var A;return null!=(A=this.responder)?A.setCurrentAttribute(t,r):void 0})):void 0},i.prototype.deleteInDirection=function(t,r){var h,A,g,w;return(null!=r?r:{recordUndoEntry:!0}).recordUndoEntry&&null!=(g=this.delegate)&&g.inputControllerWillPerformTyping(),w=this,A=function(){var k;return null!=(k=w.responder)?k.deleteInDirection(t):void 0},(h=this.getTargetDOMRange({minLength:2}))?this.withTargetDOMRange(h,A):A()},i.prototype.withTargetDOMRange=function(t,r){var h;return"function"==typeof t&&(r=t,t=this.getTargetDOMRange()),t?null!=(h=this.responder)?h.withTargetDOMRange(t,r.bind(this)):void 0:(v.selectionChangeObserver.reset(),r.call(this))},i.prototype.getTargetDOMRange=function(t){var r,h,A,f;return A=(null!=t?t:{minLength:0}).minLength,(f="function"==typeof(r=this.event).getTargetRanges?r.getTargetRanges():void 0)&&f.length&&(h=m(f[0]),0===A||h.toString().length>=A)?h:void 0},m=function(t){var r;return(r=document.createRange()).setStart(t.startContainer,t.startOffset),r.setEnd(t.endContainer,t.endOffset),r},i.prototype.withEvent=function(t,r){var h;this.event=t;try{h=r.call(this)}finally{this.event=null}return h},c=function(t){var r,h;return s.call(null!=(r=null!=(h=t.dataTransfer)?h.types:void 0)?r:[],"Files")>=0},n=function(t){var r;return(r=t.clipboardData)?s.call(r.types,"Files")>=0&&1===r.types.length&&r.files.length>=1:void 0},p=function(t){var r;return(r=t.clipboardData)?s.call(r.types,"text/plain")>=0&&1===r.types.length:void 0},a=function(t){var r;return r=[],t.altKey&&r.push("alt"),t.shiftKey&&r.push("shift"),r.push(t.key),r},u=function(t){return{x:t.clientX,y:t.clientY}},i}(v.InputController)}.call(this),function(){var E,b,y,l,o,e,s,d,i=function(n,p){return function(){return n.apply(p,arguments)}},a={}.hasOwnProperty;b=v.defer,y=v.handleEvent,e=v.makeElement,d=v.tagName,o=(s=v.config).lang,E=s.css,l=s.keyNames,v.AttachmentEditorController=function(n){function p(m,t,r,h){this.attachmentPiece=m,this.element=t,this.container=r,this.options=null!=h?h:{},this.didBlurCaption=i(this.didBlurCaption,this),this.didChangeCaption=i(this.didChangeCaption,this),this.didInputCaption=i(this.didInputCaption,this),this.didKeyDownCaption=i(this.didKeyDownCaption,this),this.didClickActionButton=i(this.didClickActionButton,this),this.didClickToolbar=i(this.didClickToolbar,this),this.attachment=this.attachmentPiece.attachment,"a"===d(this.element)&&(this.element=this.element.firstChild),this.install()}var u;return function(n,p){function u(){this.constructor=n}for(var m in p)a.call(p,m)&&(n[m]=p[m]);u.prototype=p.prototype,n.prototype=new u,n.__super__=p.prototype}(p,n),u=function(m){return function(){var t;return(t=m.apply(this,arguments)).do(),null==this.undos&&(this.undos=[]),this.undos.push(t.undo)}},p.prototype.install=function(){return this.makeElementMutable(),this.addToolbar(),this.attachment.isPreviewable()?this.installCaptionEditor():void 0},p.prototype.uninstall=function(){var m,t;for(this.savePendingCaption();t=this.undos.pop();)t();return null!=(m=this.delegate)?m.didUninstallAttachmentEditor(this):void 0},p.prototype.savePendingCaption=function(){var m,t,r;return null!=this.pendingCaption?(m=this.pendingCaption,this.pendingCaption=null,m?null!=(t=this.delegate)&&"function"==typeof t.attachmentEditorDidRequestUpdatingAttributesForAttachment?t.attachmentEditorDidRequestUpdatingAttributesForAttachment({caption:m},this.attachment):void 0:null!=(r=this.delegate)&&"function"==typeof r.attachmentEditorDidRequestRemovingAttributeForAttachment?r.attachmentEditorDidRequestRemovingAttributeForAttachment("caption",this.attachment):void 0):void 0},p.prototype.makeElementMutable=u(function(){return{do:(m=this,function(){return m.element.dataset.trixMutable=!0}),undo:function(m){return function(){return delete m.element.dataset.trixMutable}}(this)};var m}),p.prototype.addToolbar=u(function(){var m,t;return m=e({tagName:"div",className:E.attachmentToolbar,data:{trixMutable:!0},childNodes:e({tagName:"div",className:"trix-button-row",childNodes:e({tagName:"span",className:"trix-button-group trix-button-group--actions",childNodes:e({tagName:"button",className:"trix-button trix-button--remove",textContent:o.remove,attributes:{title:o.remove},data:{trixAction:"remove"}})})})}),this.attachment.isPreviewable()&&m.appendChild(e({tagName:"div",className:E.attachmentMetadataContainer,childNodes:e({tagName:"span",className:E.attachmentMetadata,childNodes:[e({tagName:"span",className:E.attachmentName,textContent:this.attachment.getFilename(),attributes:{title:this.attachment.getFilename()}}),e({tagName:"span",className:E.attachmentSize,textContent:this.attachment.getFormattedFilesize()})]})})),y("click",{onElement:m,withCallback:this.didClickToolbar}),y("click",{onElement:m,matchingSelector:"[data-trix-action]",withCallback:this.didClickActionButton}),{do:(t=this,function(){return t.element.appendChild(m)}),undo:function(){return v.removeNode(m)}}}),p.prototype.installCaptionEditor=u(function(){var m,t,r,h,A,f;return(h=e({tagName:"textarea",className:E.attachmentCaptionEditor,attributes:{placeholder:o.captionPlaceholder},data:{trixMutable:!0}})).value=this.attachmentPiece.getCaption(),(A=h.cloneNode()).classList.add("trix-autoresize-clone"),A.tabIndex=-1,m=function(){return A.value=h.value,h.style.height=A.scrollHeight+"px"},y("input",{onElement:h,withCallback:m}),y("input",{onElement:h,withCallback:this.didInputCaption}),y("keydown",{onElement:h,withCallback:this.didKeyDownCaption}),y("change",{onElement:h,withCallback:this.didChangeCaption}),y("blur",{onElement:h,withCallback:this.didBlurCaption}),r=this.element.querySelector("figcaption"),t=r.cloneNode(),{do:(f=this,function(){return r.style.display="none",t.appendChild(h),t.appendChild(A),t.classList.add(E.attachmentCaption+"--editing"),r.parentElement.insertBefore(t,r),m(),f.options.editCaption?b(function(){return h.focus()}):void 0}),undo:function(){return v.removeNode(t),r.style.display=null}}}),p.prototype.didClickToolbar=function(m){return m.preventDefault(),m.stopPropagation()},p.prototype.didClickActionButton=function(m){var r;if("remove"===m.target.getAttribute("data-trix-action"))return null!=(r=this.delegate)?r.attachmentEditorDidRequestRemovalOfAttachment(this.attachment):void 0},p.prototype.didKeyDownCaption=function(m){var t;return"return"===l[m.keyCode]?(m.preventDefault(),this.savePendingCaption(),null!=(t=this.delegate)&&"function"==typeof t.attachmentEditorDidRequestDeselectingAttachment?t.attachmentEditorDidRequestDeselectingAttachment(this.attachment):void 0):void 0},p.prototype.didInputCaption=function(m){return this.pendingCaption=m.target.value.replace(/\s/g," ").trim()},p.prototype.didChangeCaption=function(){return this.savePendingCaption()},p.prototype.didBlurCaption=function(){return this.savePendingCaption()},p}(v.BasicObject)}.call(this),function(){var E,b,y,o={}.hasOwnProperty;y=v.makeElement,E=v.config.css,v.AttachmentView=function(e){function s(){s.__super__.constructor.apply(this,arguments),this.attachment=this.object,this.attachment.uploadProgressDelegate=this,this.attachmentPiece=this.options.piece}var d;return function(e,s){function d(){this.constructor=e}for(var i in s)o.call(s,i)&&(e[i]=s[i]);d.prototype=s.prototype,e.prototype=new d,e.__super__=s.prototype}(s,e),s.attachmentSelector="[data-trix-attachment]",s.prototype.createContentNodes=function(){return[]},s.prototype.createNodes=function(){var i,c,a,n,p,m;if(i=n=y({tagName:"figure",className:this.getClassName(),data:this.getData(),editable:!1}),(c=this.getHref())&&(n=y({tagName:"a",editable:!1,attributes:{href:c,tabindex:-1}}),i.appendChild(n)),this.attachment.hasContent())n.innerHTML=this.attachment.getContent();else for(a=0,p=(m=this.createContentNodes()).length;p>a;a++)n.appendChild(m[a]);return n.appendChild(this.createCaptionElement()),this.attachment.isPending()&&(this.progressElement=y({tagName:"progress",attributes:{class:E.attachmentProgress,value:this.attachment.getUploadProgress(),max:100},data:{trixMutable:!0,trixStoreKey:["progressElement",this.attachment.id].join("/")}}),i.appendChild(this.progressElement)),[d("left"),i,d("right")]},s.prototype.createCaptionElement=function(){var i,c,a,n,p,u,m;return a=y({tagName:"figcaption",className:E.attachmentCaption}),(i=this.attachmentPiece.getCaption())?(a.classList.add(E.attachmentCaption+"--edited"),a.textContent=i):((c=this.getCaptionConfig()).name&&(n=this.attachment.getFilename()),c.size&&(u=this.attachment.getFormattedFilesize()),n&&(p=y({tagName:"span",className:E.attachmentName,textContent:n}),a.appendChild(p)),u&&(n&&a.appendChild(document.createTextNode(" ")),m=y({tagName:"span",className:E.attachmentSize,textContent:u}),a.appendChild(m))),a},s.prototype.getClassName=function(){var i,c;return c=[E.attachment,E.attachment+"--"+this.attachment.getType()],(i=this.attachment.getExtension())&&c.push(E.attachment+"--"+i),c.join(" ")},s.prototype.getData=function(){var i,c;return c={trixAttachment:JSON.stringify(this.attachment),trixContentType:this.attachment.getContentType(),trixId:this.attachment.id},(i=this.attachmentPiece.attributes).isEmpty()||(c.trixAttributes=JSON.stringify(i)),this.attachment.isPending()&&(c.trixSerialize=!1),c},s.prototype.getHref=function(){return b(this.attachment.getContent(),"a")?void 0:this.attachment.getHref()},s.prototype.getCaptionConfig=function(){var i,c,a;return a=this.attachment.getType(),i=v.copyObject(null!=(c=v.config.attachments[a])?c.caption:void 0),"file"===a&&(i.name=!0),i},s.prototype.findProgressElement=function(){var i;return null!=(i=this.findElement())?i.querySelector("progress"):void 0},d=function(i){return y({tagName:"span",textContent:v.ZERO_WIDTH_SPACE,data:{trixCursorTarget:i,trixSerialize:!1}})},s.prototype.attachmentDidChangeUploadProgress=function(){var i,c;return c=this.attachment.getUploadProgress(),null!=(i=this.findProgressElement())?i.value=c:void 0},s}(v.ObjectView),b=function(e,s){var d;return(d=y("div")).innerHTML=null!=e?e:"",d.querySelector(s)}}.call(this),function(){var E,y={}.hasOwnProperty;E=v.makeElement,v.PreviewableAttachmentView=function(l){function o(){o.__super__.constructor.apply(this,arguments),this.attachment.previewDelegate=this}return function(l,o){function e(){this.constructor=l}for(var s in o)y.call(o,s)&&(l[s]=o[s]);e.prototype=o.prototype,l.prototype=new e,l.__super__=o.prototype}(o,l),o.prototype.createContentNodes=function(){return this.image=E({tagName:"img",attributes:{src:""},data:{trixMutable:!0}}),this.refresh(this.image),[this.image]},o.prototype.createCaptionElement=function(){var e;return(e=o.__super__.createCaptionElement.apply(this,arguments)).textContent||e.setAttribute("data-trix-placeholder",v.config.lang.captionPlaceholder),e},o.prototype.refresh=function(e){var s;return null==e&&(e=null!=(s=this.findElement())?s.querySelector("img"):void 0),e?this.updateAttributesForImage(e):void 0},o.prototype.updateAttributesForImage=function(e){var s,d,i,c,a,n;return a=this.attachment.getURL(),d=this.attachment.getPreviewURL(),e.src=d||a,d===a?e.removeAttribute("data-trix-serialized-attributes"):(i=JSON.stringify({src:a}),e.setAttribute("data-trix-serialized-attributes",i)),n=this.attachment.getWidth(),s=this.attachment.getHeight(),null!=n&&(e.width=n),null!=s&&(e.height=s),c=["imageElement",this.attachment.id,e.src,e.width,e.height].join("/"),e.dataset.trixStoreKey=c},o.prototype.attachmentDidChangeAttributes=function(){return this.refresh(this.image),this.refresh()},o}(v.AttachmentView)}.call(this),function(){var E,b,y,o={}.hasOwnProperty;y=v.makeElement,E=v.findInnerElement,b=v.getTextConfig,v.PieceView=function(e){function s(){var i;s.__super__.constructor.apply(this,arguments),this.piece=this.object,this.attributes=this.piece.getAttributes(),this.textConfig=(i=this.options).textConfig,this.context=i.context,this.piece.attachment?this.attachment=this.piece.attachment:this.string=this.piece.toString()}var d;return function(e,s){function d(){this.constructor=e}for(var i in s)o.call(s,i)&&(e[i]=s[i]);d.prototype=s.prototype,e.prototype=new d,e.__super__=s.prototype}(s,e),s.prototype.createNodes=function(){var i,c,a,n,u;if(u=this.attachment?this.createAttachmentNodes():this.createStringNodes(),i=this.createElement()){for(a=E(i),c=0,n=u.length;n>c;c++)a.appendChild(u[c]);u=[i]}return u},s.prototype.createAttachmentNodes=function(){var i;return i=this.attachment.isPreviewable()?v.PreviewableAttachmentView:v.AttachmentView,this.createChildView(i,this.piece.attachment,{piece:this.piece}).getNodes()},s.prototype.createStringNodes=function(){var i,c,a,n,u,m,t,r,h;if(null!=(t=this.textConfig)?t.plaintext:void 0)return[document.createTextNode(this.string)];for(m=[],a=c=0,n=(r=this.string.split("\n")).length;n>c;a=++c)h=r[a],a>0&&(i=y("br"),m.push(i)),h.length&&(u=document.createTextNode(this.preserveSpaces(h)),m.push(u));return m},s.prototype.createElement=function(){var i,c,a,n,p,u,m,t,r;for(n in t={},u=this.attributes)if(r=u[n],(i=b(n))&&(i.tagName&&(p=y(i.tagName),a?(a.appendChild(p),a=p):c=a=p),i.styleProperty&&(t[i.styleProperty]=r),i.style))for(n in m=i.style)t[n]=r=m[n];if(Object.keys(t).length)for(n in null==c&&(c=y("span")),t)c.style[n]=r=t[n];return c},s.prototype.createContainerElement=function(){var i,c,a,n,p;for(a in n=this.attributes)if(p=n[a],(c=b(a))&&c.groupTagName)return(i={})[a]=p,y(c.groupTagName,i)},d=v.NON_BREAKING_SPACE,s.prototype.preserveSpaces=function(i){return this.context.isLast&&(i=i.replace(/\ $/,d)),i=i.replace(/(\S)\ {3}(\S)/g,"$1 "+d+" $2").replace(/\ {2}/g,d+" ").replace(/\ {2}/g," "+d),(this.context.isFirst||this.context.followsWhitespace)&&(i=i.replace(/^\ /,d)),i},s}(v.ObjectView)}.call(this),function(){var b={}.hasOwnProperty;v.TextView=function(y){function l(){l.__super__.constructor.apply(this,arguments),this.text=this.object,this.textConfig=this.options.textConfig}var o;return function(y,l){function o(){this.constructor=y}for(var e in l)b.call(l,e)&&(y[e]=l[e]);o.prototype=l.prototype,y.prototype=new o,y.__super__=l.prototype}(l,y),l.prototype.createNodes=function(){var e,s,d,i,c,a,n,p,u,m;for(a=[],i=(p=v.ObjectGroup.groupObjects(this.getPieces())).length-1,d=s=0,c=p.length;c>s;d=++s)n=p[d],e={},0===d&&(e.isFirst=!0),d===i&&(e.isLast=!0),o(u)&&(e.followsWhitespace=!0),m=this.findOrCreateCachedChildView(v.PieceView,n,{textConfig:this.textConfig,context:e}),a.push.apply(a,m.getNodes()),u=n;return a},l.prototype.getPieces=function(){var e,s,d,i,c;for(c=[],e=0,s=(i=this.text.getPieces()).length;s>e;e++)(d=i[e]).hasAttribute("blockBreak")||c.push(d);return c},o=function(e){return/\s$/.test(null!=e?e.toString():void 0)},l}(v.ObjectView)}.call(this),function(){var E,b,y,o={}.hasOwnProperty;y=v.makeElement,b=v.getBlockConfig,E=v.config.css,v.BlockView=function(e){function s(){s.__super__.constructor.apply(this,arguments),this.block=this.object,this.attributes=this.block.getAttributes()}return function(e,s){function d(){this.constructor=e}for(var i in s)o.call(s,i)&&(e[i]=s[i]);d.prototype=s.prototype,e.prototype=new d,e.__super__=s.prototype}(s,e),s.prototype.createNodes=function(){var d,c,a,n,u,m,t,r,h;if(u=[document.createComment("block")],this.block.isEmpty()?u.push(y("br")):(r=null!=(m=b(this.block.getLastAttribute()))?m.text:void 0,h=this.findOrCreateCachedChildView(v.TextView,this.block.text,{textConfig:r}),u.push.apply(u,h.getNodes()),this.shouldAddExtraNewlineElement()&&u.push(y("br"))),this.attributes.length)return u;for(t=v.config.blockAttributes.default.tagName,this.block.isRTL()&&(d={dir:"rtl"}),c=y({tagName:t,attributes:d}),a=0,n=u.length;n>a;a++)c.appendChild(u[a]);return[c]},s.prototype.createContainerElement=function(d){var i,c,a,n,p;return p=b(i=this.attributes[d]).tagName,0===d&&this.block.isRTL()&&(c={dir:"rtl"}),"attachmentGallery"===i&&(n=this.block.getBlockBreakPosition(),a=E.attachmentGallery+" "+E.attachmentGallery+"--"+n),y({tagName:p,className:a,attributes:c})},s.prototype.shouldAddExtraNewlineElement=function(){return/\n\n$/.test(this.block.toString())},s}(v.ObjectView)}.call(this),function(){var E,b,l={}.hasOwnProperty;E=v.defer,b=v.makeElement,v.DocumentView=function(o){function e(){e.__super__.constructor.apply(this,arguments),this.element=this.options.element,this.elementStore=new v.ElementStore,this.setDocument(this.object)}var s,d,i;return function(o,e){function s(){this.constructor=o}for(var d in e)l.call(e,d)&&(o[d]=e[d]);s.prototype=e.prototype,o.prototype=new s,o.__super__=e.prototype}(e,o),e.render=function(c){var a,n;return(n=new this(c,{element:a=b("div")})).render(),n.sync(),a},e.prototype.setDocument=function(c){return c.isEqualTo(this.document)?void 0:this.document=this.object=c},e.prototype.render=function(){var c,a,u,m,t;if(this.childViews=[],this.shadowElement=b("div"),!this.document.isEmpty()){for(m=[],c=0,a=(u=v.ObjectGroup.groupObjects(this.document.getBlocks(),{asTree:!0})).length;a>c;c++)t=this.findOrCreateCachedChildView(v.BlockView,u[c]),m.push(function(){var r,h,A,f;for(f=[],r=0,h=(A=t.getNodes()).length;h>r;r++)f.push(this.shadowElement.appendChild(A[r]));return f}.call(this));return m}},e.prototype.isSynced=function(){return s(this.shadowElement,this.element)},e.prototype.sync=function(){var c;for(c=this.createDocumentFragmentForSync();this.element.lastChild;)this.element.removeChild(this.element.lastChild);return this.element.appendChild(c),this.didSync()},e.prototype.didSync=function(){return this.elementStore.reset(d(this.element)),E((c=this,function(){return c.garbageCollectCachedViews()}));var c},e.prototype.createDocumentFragmentForSync=function(){var c,a,n,p,u,m,r,h,A;for(a=document.createDocumentFragment(),n=0,u=(r=this.shadowElement.childNodes).length;u>n;n++)a.appendChild(r[n].cloneNode(!0));for(p=0,m=(h=d(a)).length;m>p;p++)(A=this.elementStore.remove(c=h[p]))&&c.parentNode.replaceChild(A,c);return a},d=function(c){return c.querySelectorAll("[data-trix-store-key]")},s=function(c,a){return i(c.innerHTML)===i(a.innerHTML)},i=function(c){return c.replace(/&nbsp;/g," ")},e}(v.ObjectView)}.call(this),function(){var E,b,y,l,o,e=function(i,c){return function(){return i.apply(c,arguments)}},d={}.hasOwnProperty;y=v.findClosestElementFromNode,l=v.handleEvent,o=v.innerElementIsActive,b=v.defer,E=v.AttachmentView.attachmentSelector,v.CompositionController=function(i){function c(a,n){this.element=a,this.composition=n,this.didClickAttachment=e(this.didClickAttachment,this),this.didBlur=e(this.didBlur,this),this.didFocus=e(this.didFocus,this),this.documentView=new v.DocumentView(this.composition.document,{element:this.element}),l("focus",{onElement:this.element,withCallback:this.didFocus}),l("blur",{onElement:this.element,withCallback:this.didBlur}),l("click",{onElement:this.element,matchingSelector:"a[contenteditable=false]",preventDefault:!0}),l("mousedown",{onElement:this.element,matchingSelector:E,withCallback:this.didClickAttachment}),l("click",{onElement:this.element,matchingSelector:"a"+E,preventDefault:!0})}return function(i,c){function a(){this.constructor=i}for(var n in c)d.call(c,n)&&(i[n]=c[n]);a.prototype=c.prototype,i.prototype=new a,i.__super__=c.prototype}(c,i),c.prototype.didFocus=function(){var a,n,p,u;return u=this,a=function(){var m;return u.focused?void 0:(u.focused=!0,null!=(m=u.delegate)&&"function"==typeof m.compositionControllerDidFocus?m.compositionControllerDidFocus():void 0)},null!=(n=null!=(p=this.blurPromise)?p.then(a):void 0)?n:a()},c.prototype.didBlur=function(){return this.blurPromise=new Promise((a=this,function(n){return b(function(){var p;return o(a.element)||(a.focused=null,null!=(p=a.delegate)&&"function"==typeof p.compositionControllerDidBlur&&p.compositionControllerDidBlur()),a.blurPromise=null,n()})}));var a},c.prototype.didClickAttachment=function(a,n){var p,u,m;return p=this.findAttachmentForElement(n),u=null!=y(a.target,{matchingSelector:"figcaption"}),null!=(m=this.delegate)&&"function"==typeof m.compositionControllerDidSelectAttachment?m.compositionControllerDidSelectAttachment(p,{editCaption:u}):void 0},c.prototype.getSerializableElement=function(){return this.isEditingAttachment()?this.documentView.shadowElement:this.element},c.prototype.render=function(){var a,n,p;return this.revision!==this.composition.revision&&(this.documentView.setDocument(this.composition.document),this.documentView.render(),this.revision=this.composition.revision),this.canSyncDocumentView()&&!this.documentView.isSynced()&&(null!=(a=this.delegate)&&"function"==typeof a.compositionControllerWillSyncDocumentView&&a.compositionControllerWillSyncDocumentView(),this.documentView.sync(),null!=(n=this.delegate)&&"function"==typeof n.compositionControllerDidSyncDocumentView&&n.compositionControllerDidSyncDocumentView()),null!=(p=this.delegate)&&"function"==typeof p.compositionControllerDidRender?p.compositionControllerDidRender():void 0},c.prototype.rerenderViewForObject=function(a){return this.invalidateViewForObject(a),this.render()},c.prototype.invalidateViewForObject=function(a){return this.documentView.invalidateViewForObject(a)},c.prototype.isViewCachingEnabled=function(){return this.documentView.isViewCachingEnabled()},c.prototype.enableViewCaching=function(){return this.documentView.enableViewCaching()},c.prototype.disableViewCaching=function(){return this.documentView.disableViewCaching()},c.prototype.refreshViewCache=function(){return this.documentView.garbageCollectCachedViews()},c.prototype.isEditingAttachment=function(){return null!=this.attachmentEditor},c.prototype.installAttachmentEditorForAttachment=function(a,n){var p,u,m;if((null!=(m=this.attachmentEditor)?m.attachment:void 0)!==a&&(u=this.documentView.findElementForObject(a)))return this.uninstallAttachmentEditor(),p=this.composition.document.getAttachmentPieceForAttachment(a),this.attachmentEditor=new v.AttachmentEditorController(p,u,this.element,n),this.attachmentEditor.delegate=this},c.prototype.uninstallAttachmentEditor=function(){var a;return null!=(a=this.attachmentEditor)?a.uninstall():void 0},c.prototype.didUninstallAttachmentEditor=function(){return this.attachmentEditor=null,this.render()},c.prototype.attachmentEditorDidRequestUpdatingAttributesForAttachment=function(a,n){var p;return null!=(p=this.delegate)&&"function"==typeof p.compositionControllerWillUpdateAttachment&&p.compositionControllerWillUpdateAttachment(n),this.composition.updateAttributesForAttachment(a,n)},c.prototype.attachmentEditorDidRequestRemovingAttributeForAttachment=function(a,n){var p;return null!=(p=this.delegate)&&"function"==typeof p.compositionControllerWillUpdateAttachment&&p.compositionControllerWillUpdateAttachment(n),this.composition.removeAttributeForAttachment(a,n)},c.prototype.attachmentEditorDidRequestRemovalOfAttachment=function(a){var n;return null!=(n=this.delegate)&&"function"==typeof n.compositionControllerDidRequestRemovalOfAttachment?n.compositionControllerDidRequestRemovalOfAttachment(a):void 0},c.prototype.attachmentEditorDidRequestDeselectingAttachment=function(a){var n;return null!=(n=this.delegate)&&"function"==typeof n.compositionControllerDidRequestDeselectingAttachment?n.compositionControllerDidRequestDeselectingAttachment(a):void 0},c.prototype.canSyncDocumentView=function(){return!this.isEditingAttachment()},c.prototype.findAttachmentForElement=function(a){return this.composition.document.getAttachmentById(parseInt(a.dataset.trixId,10))},c}(v.BasicObject)}.call(this),function(){var E,b,y,l=function(s,d){return function(){return s.apply(d,arguments)}},e={}.hasOwnProperty;b=v.handleEvent,y=v.triggerEvent,E=v.findClosestElementFromNode,v.ToolbarController=function(s){function d(f){this.element=f,this.didKeyDownDialogInput=l(this.didKeyDownDialogInput,this),this.didClickDialogButton=l(this.didClickDialogButton,this),this.didClickAttributeButton=l(this.didClickAttributeButton,this),this.didClickActionButton=l(this.didClickActionButton,this),this.attributes={},this.actions={},this.resetDialogInputs(),b("mousedown",{onElement:this.element,matchingSelector:i,withCallback:this.didClickActionButton}),b("mousedown",{onElement:this.element,matchingSelector:a,withCallback:this.didClickAttributeButton}),b("click",{onElement:this.element,matchingSelector:A,preventDefault:!0}),b("click",{onElement:this.element,matchingSelector:n,withCallback:this.didClickDialogButton}),b("keydown",{onElement:this.element,matchingSelector:p,withCallback:this.didKeyDownDialogInput})}var i,a,n,p,u,m,t,r,h,A;return function(s,d){function i(){this.constructor=s}for(var c in d)e.call(d,c)&&(s[c]=d[c]);i.prototype=d.prototype,s.prototype=new i,s.__super__=d.prototype}(d,s),A=(a="[data-trix-attribute]")+", "+(i="[data-trix-action]"),n=(u="[data-trix-dialog]")+" [data-trix-method]",p=u+" [data-trix-input]",d.prototype.didClickActionButton=function(f,g){var w,k,O;return null!=(k=this.delegate)&&k.toolbarDidClickButton(),f.preventDefault(),w=m(g),this.getDialog(w)?this.toggleDialog(w):null!=(O=this.delegate)?O.toolbarDidInvokeAction(w):void 0},d.prototype.didClickAttributeButton=function(f,g){var w,k,O;return null!=(k=this.delegate)&&k.toolbarDidClickButton(),f.preventDefault(),w=t(g),this.getDialog(w)?this.toggleDialog(w):null!=(O=this.delegate)&&O.toolbarDidToggleAttribute(w),this.refreshAttributeButtons()},d.prototype.didClickDialogButton=function(f,g){var w;return w=E(g,{matchingSelector:u}),this[g.getAttribute("data-trix-method")].call(this,w)},d.prototype.didKeyDownDialogInput=function(f,g){var w,k;return 13===f.keyCode&&(f.preventDefault(),w=g.getAttribute("name"),k=this.getDialog(w),this.setAttribute(k)),27===f.keyCode?(f.preventDefault(),this.hideDialog()):void 0},d.prototype.updateActions=function(f){return this.actions=f,this.refreshActionButtons()},d.prototype.refreshActionButtons=function(){return this.eachActionButton((f=this,function(g,w){return g.disabled=!1===f.actions[w]}));var f},d.prototype.eachActionButton=function(f){var g,w,k,O,j;for(j=[],w=0,k=(O=this.element.querySelectorAll(i)).length;k>w;w++)j.push(f(g=O[w],m(g)));return j},d.prototype.updateAttributes=function(f){return this.attributes=f,this.refreshAttributeButtons()},d.prototype.refreshAttributeButtons=function(){return this.eachAttributeButton((f=this,function(g,w){return g.disabled=!1===f.attributes[w],f.attributes[w]||f.dialogIsVisible(w)?(g.setAttribute("data-trix-active",""),g.classList.add("trix-active")):(g.removeAttribute("data-trix-active"),g.classList.remove("trix-active"))}));var f},d.prototype.eachAttributeButton=function(f){var g,w,k,O,j;for(j=[],w=0,k=(O=this.element.querySelectorAll(a)).length;k>w;w++)j.push(f(g=O[w],t(g)));return j},d.prototype.applyKeyboardCommand=function(f){var g,k,O,j,L,R;for(j=JSON.stringify(f.sort()),O=0,L=(R=this.element.querySelectorAll("[data-trix-key]")).length;L>O;O++)if(k=(g=R[O]).getAttribute("data-trix-key").split("+"),JSON.stringify(k.sort())===j)return y("mousedown",{onElement:g}),!0;return!1},d.prototype.dialogIsVisible=function(f){var g;return(g=this.getDialog(f))?g.hasAttribute("data-trix-active"):void 0},d.prototype.toggleDialog=function(f){return this.dialogIsVisible(f)?this.hideDialog():this.showDialog(f)},d.prototype.showDialog=function(f){var g,k,O,j,L,R,T,C,x;for(this.hideDialog(),null!=(R=this.delegate)&&R.toolbarWillShowDialog(),(k=this.getDialog(f)).setAttribute("data-trix-active",""),k.classList.add("trix-active"),O=0,L=(T=k.querySelectorAll("input[disabled]")).length;L>O;O++)T[O].removeAttribute("disabled");return(g=t(k))&&(j=h(k,f))&&(j.value=null!=(C=this.attributes[g])?C:"",j.select()),null!=(x=this.delegate)?x.toolbarDidShowDialog(f):void 0},d.prototype.setAttribute=function(f){var g,w,k;return g=t(f),(w=h(f,g)).willValidate&&!w.checkValidity()?(w.setAttribute("data-trix-validate",""),w.classList.add("trix-validate"),w.focus()):(null!=(k=this.delegate)&&k.toolbarDidUpdateAttribute(g,w.value),this.hideDialog())},d.prototype.removeAttribute=function(f){var g,w;return g=t(f),null!=(w=this.delegate)&&w.toolbarDidRemoveAttribute(g),this.hideDialog()},d.prototype.hideDialog=function(){var f,g;return(f=this.element.querySelector("[data-trix-dialog][data-trix-active]"))?(f.removeAttribute("data-trix-active"),f.classList.remove("trix-active"),this.resetDialogInputs(),null!=(g=this.delegate)?g.toolbarDidHideDialog(r(f)):void 0):void 0},d.prototype.resetDialogInputs=function(){var f,g,w,k,O;for(O=[],f=0,w=(k=this.element.querySelectorAll(p)).length;w>f;f++)(g=k[f]).setAttribute("disabled","disabled"),g.removeAttribute("data-trix-validate"),O.push(g.classList.remove("trix-validate"));return O},d.prototype.getDialog=function(f){return this.element.querySelector("[data-trix-dialog="+f+"]")},h=function(f,g){return null==g&&(g=t(f)),f.querySelector("[data-trix-input][name='"+g+"']")},m=function(f){return f.getAttribute("data-trix-action")},t=function(f){var g;return null!=(g=f.getAttribute("data-trix-attribute"))?g:f.getAttribute("data-trix-dialog-attribute")},r=function(f){return f.getAttribute("data-trix-dialog")},d}(v.BasicObject)}.call(this),function(){var b={}.hasOwnProperty;v.ImagePreloadOperation=function(y){function l(o){this.url=o}return function(y,l){function o(){this.constructor=y}for(var e in l)b.call(l,e)&&(y[e]=l[e]);o.prototype=l.prototype,y.prototype=new o,y.__super__=l.prototype}(l,y),l.prototype.perform=function(o){var e,s;return(e=new Image).onload=(s=this,function(){return e.width=s.width=e.naturalWidth,e.height=s.height=e.naturalHeight,o(!0,e)}),e.onerror=function(){return o(!1)},e.src=this.url},l}(v.Operation)}.call(this),function(){var E=function(l,o){return function(){return l.apply(o,arguments)}},y={}.hasOwnProperty;v.Attachment=function(l){function o(e){null==e&&(e={}),this.releaseFile=E(this.releaseFile,this),o.__super__.constructor.apply(this,arguments),this.attributes=v.Hash.box(e),this.didChangeAttributes()}return function(l,o){function e(){this.constructor=l}for(var s in o)y.call(o,s)&&(l[s]=o[s]);e.prototype=o.prototype,l.prototype=new e,l.__super__=o.prototype}(o,l),o.previewablePattern=/^image(\/(gif|png|jpe?g)|$)/,o.attachmentForFile=function(e){var s;return(s=new this(this.attributesForFile(e))).setFile(e),s},o.attributesForFile=function(e){return new v.Hash({filename:e.name,filesize:e.size,contentType:e.type})},o.fromJSON=function(e){return new this(e)},o.prototype.getAttribute=function(e){return this.attributes.get(e)},o.prototype.hasAttribute=function(e){return this.attributes.has(e)},o.prototype.getAttributes=function(){return this.attributes.toObject()},o.prototype.setAttributes=function(e){var s,d,i;return null==e&&(e={}),s=this.attributes.merge(e),this.attributes.isEqualTo(s)?void 0:(this.attributes=s,this.didChangeAttributes(),null!=(d=this.previewDelegate)&&"function"==typeof d.attachmentDidChangeAttributes&&d.attachmentDidChangeAttributes(this),null!=(i=this.delegate)&&"function"==typeof i.attachmentDidChangeAttributes?i.attachmentDidChangeAttributes(this):void 0)},o.prototype.didChangeAttributes=function(){return this.isPreviewable()?this.preloadURL():void 0},o.prototype.isPending=function(){return null!=this.file&&!(this.getURL()||this.getHref())},o.prototype.isPreviewable=function(){return this.attributes.has("previewable")?this.attributes.get("previewable"):this.constructor.previewablePattern.test(this.getContentType())},o.prototype.getType=function(){return this.hasContent()?"content":this.isPreviewable()?"preview":"file"},o.prototype.getURL=function(){return this.attributes.get("url")},o.prototype.getHref=function(){return this.attributes.get("href")},o.prototype.getFilename=function(){var e;return null!=(e=this.attributes.get("filename"))?e:""},o.prototype.getFilesize=function(){return this.attributes.get("filesize")},o.prototype.getFormattedFilesize=function(){var e;return"number"==typeof(e=this.attributes.get("filesize"))?v.config.fileSize.formatter(e):""},o.prototype.getExtension=function(){var e;return null!=(e=this.getFilename().match(/\.(\w+)$/))?e[1].toLowerCase():void 0},o.prototype.getContentType=function(){return this.attributes.get("contentType")},o.prototype.hasContent=function(){return this.attributes.has("content")},o.prototype.getContent=function(){return this.attributes.get("content")},o.prototype.getWidth=function(){return this.attributes.get("width")},o.prototype.getHeight=function(){return this.attributes.get("height")},o.prototype.getFile=function(){return this.file},o.prototype.setFile=function(e){return this.file=e,this.isPreviewable()?this.preloadFile():void 0},o.prototype.releaseFile=function(){return this.releasePreloadedFile(),this.file=null},o.prototype.getUploadProgress=function(){var e;return null!=(e=this.uploadProgress)?e:0},o.prototype.setUploadProgress=function(e){var s;return this.uploadProgress!==e?(this.uploadProgress=e,null!=(s=this.uploadProgressDelegate)&&"function"==typeof s.attachmentDidChangeUploadProgress?s.attachmentDidChangeUploadProgress(this):void 0):void 0},o.prototype.toJSON=function(){return this.getAttributes()},o.prototype.getCacheKey=function(){return[o.__super__.getCacheKey.apply(this,arguments),this.attributes.getCacheKey(),this.getPreviewURL()].join("/")},o.prototype.getPreviewURL=function(){return this.previewURL||this.preloadingURL},o.prototype.setPreviewURL=function(e){var s,d;return e!==this.getPreviewURL()?(this.previewURL=e,null!=(s=this.previewDelegate)&&"function"==typeof s.attachmentDidChangeAttributes&&s.attachmentDidChangeAttributes(this),null!=(d=this.delegate)&&"function"==typeof d.attachmentDidChangePreviewURL?d.attachmentDidChangePreviewURL(this):void 0):void 0},o.prototype.preloadURL=function(){return this.preload(this.getURL(),this.releaseFile)},o.prototype.preloadFile=function(){return this.file?(this.fileObjectURL=URL.createObjectURL(this.file),this.preload(this.fileObjectURL)):void 0},o.prototype.releasePreloadedFile=function(){return this.fileObjectURL?(URL.revokeObjectURL(this.fileObjectURL),this.fileObjectURL=null):void 0},o.prototype.preload=function(e,s){var i;return e&&e!==this.getPreviewURL()?(this.preloadingURL=e,new v.ImagePreloadOperation(e).then((i=this,function(c){var a,n;return n=c.width,a=c.height,i.getWidth()&&i.getHeight()||i.setAttributes({width:n,height:a}),i.preloadingURL=null,i.setPreviewURL(e),"function"==typeof s?s():void 0})).catch(function(i){return function(){return i.preloadingURL=null,"function"==typeof s?s():void 0}}(this))):void 0},o}(v.Object)}.call(this),function(){var b={}.hasOwnProperty;v.Piece=function(y){function l(o,e){null==e&&(e={}),l.__super__.constructor.apply(this,arguments),this.attributes=v.Hash.box(e)}return function(y,l){function o(){this.constructor=y}for(var e in l)b.call(l,e)&&(y[e]=l[e]);o.prototype=l.prototype,y.prototype=new o,y.__super__=l.prototype}(l,y),l.types={},l.registerType=function(o,e){return e.type=o,this.types[o]=e},l.fromJSON=function(o){var e;return(e=this.types[o.type])?e.fromJSON(o):void 0},l.prototype.copyWithAttributes=function(o){return new this.constructor(this.getValue(),o)},l.prototype.copyWithAdditionalAttributes=function(o){return this.copyWithAttributes(this.attributes.merge(o))},l.prototype.copyWithoutAttribute=function(o){return this.copyWithAttributes(this.attributes.remove(o))},l.prototype.copy=function(){return this.copyWithAttributes(this.attributes)},l.prototype.getAttribute=function(o){return this.attributes.get(o)},l.prototype.getAttributesHash=function(){return this.attributes},l.prototype.getAttributes=function(){return this.attributes.toObject()},l.prototype.getCommonAttributes=function(){var o,e,s;return(s=pieceList.getPieceAtIndex(0))?(e=(o=s.attributes).getKeys(),pieceList.eachPiece(function(d){return e=o.getKeysCommonToHash(d.attributes),o=o.slice(e)}),o.toObject()):{}},l.prototype.hasAttribute=function(o){return this.attributes.has(o)},l.prototype.hasSameStringValueAsPiece=function(o){return null!=o&&this.toString()===o.toString()},l.prototype.hasSameAttributesAsPiece=function(o){return null!=o&&(this.attributes===o.attributes||this.attributes.isEqualTo(o.attributes))},l.prototype.isBlockBreak=function(){return!1},l.prototype.isEqualTo=function(o){return l.__super__.isEqualTo.apply(this,arguments)||this.hasSameConstructorAs(o)&&this.hasSameStringValueAsPiece(o)&&this.hasSameAttributesAsPiece(o)},l.prototype.isEmpty=function(){return 0===this.length},l.prototype.isSerializable=function(){return!0},l.prototype.toJSON=function(){return{type:this.constructor.type,attributes:this.getAttributes()}},l.prototype.contentsForInspection=function(){return{type:this.constructor.type,attributes:this.attributes.inspect()}},l.prototype.canBeGrouped=function(){return this.hasAttribute("href")},l.prototype.canBeGroupedWith=function(o){return this.getAttribute("href")===o.getAttribute("href")},l.prototype.getLength=function(){return this.length},l.prototype.canBeConsolidatedWith=function(){return!1},l}(v.Object)}.call(this),function(){var b={}.hasOwnProperty;v.Piece.registerType("attachment",v.AttachmentPiece=function(y){function l(o){this.attachment=o,l.__super__.constructor.apply(this,arguments),this.length=1,this.ensureAttachmentExclusivelyHasAttribute("href"),this.attachment.hasContent()||this.removeProhibitedAttributes()}return function(y,l){function o(){this.constructor=y}for(var e in l)b.call(l,e)&&(y[e]=l[e]);o.prototype=l.prototype,y.prototype=new o,y.__super__=l.prototype}(l,y),l.fromJSON=function(o){return new this(v.Attachment.fromJSON(o.attachment),o.attributes)},l.permittedAttributes=["caption","presentation"],l.prototype.ensureAttachmentExclusivelyHasAttribute=function(o){return this.hasAttribute(o)?(this.attachment.hasAttribute(o)||this.attachment.setAttributes(this.attributes.slice(o)),this.attributes=this.attributes.remove(o)):void 0},l.prototype.removeProhibitedAttributes=function(){var o;return(o=this.attributes.slice(this.constructor.permittedAttributes)).isEqualTo(this.attributes)?void 0:this.attributes=o},l.prototype.getValue=function(){return this.attachment},l.prototype.isSerializable=function(){return!this.attachment.isPending()},l.prototype.getCaption=function(){var o;return null!=(o=this.attributes.get("caption"))?o:""},l.prototype.isEqualTo=function(o){var e;return l.__super__.isEqualTo.apply(this,arguments)&&this.attachment.id===(null!=o&&null!=(e=o.attachment)?e.id:void 0)},l.prototype.toString=function(){return v.OBJECT_REPLACEMENT_CHARACTER},l.prototype.toJSON=function(){var o;return(o=l.__super__.toJSON.apply(this,arguments)).attachment=this.attachment,o},l.prototype.getCacheKey=function(){return[l.__super__.getCacheKey.apply(this,arguments),this.attachment.getCacheKey()].join("/")},l.prototype.toConsole=function(){return JSON.stringify(this.toString())},l}(v.Piece))}.call(this),function(){var E,y={}.hasOwnProperty;E=v.normalizeNewlines,v.Piece.registerType("string",v.StringPiece=function(l){function o(e){o.__super__.constructor.apply(this,arguments),this.string=E(e),this.length=this.string.length}return function(l,o){function e(){this.constructor=l}for(var s in o)y.call(o,s)&&(l[s]=o[s]);e.prototype=o.prototype,l.prototype=new e,l.__super__=o.prototype}(o,l),o.fromJSON=function(e){return new this(e.string,e.attributes)},o.prototype.getValue=function(){return this.string},o.prototype.toString=function(){return this.string.toString()},o.prototype.isBlockBreak=function(){return"\n"===this.toString()&&!0===this.getAttribute("blockBreak")},o.prototype.toJSON=function(){var e;return(e=o.__super__.toJSON.apply(this,arguments)).string=this.string,e},o.prototype.canBeConsolidatedWith=function(e){return null!=e&&this.hasSameConstructorAs(e)&&this.hasSameAttributesAsPiece(e)},o.prototype.consolidateWith=function(e){return new this.constructor(this.toString()+e.toString(),this.attributes)},o.prototype.splitAtOffset=function(e){var s,d;return 0===e?(s=null,d=this):e===this.length?(s=this,d=null):(s=new this.constructor(this.string.slice(0,e),this.attributes),d=new this.constructor(this.string.slice(e),this.attributes)),[s,d]},o.prototype.toConsole=function(){var e;return(e=this.string).length>15&&(e=e.slice(0,14)+"\u2026"),JSON.stringify(e.toString())},o}(v.Piece))}.call(this),function(){var E,y={}.hasOwnProperty,l=[].slice;E=v.spliceArray,v.SplittableList=function(o){function e(c){null==c&&(c=[]),e.__super__.constructor.apply(this,arguments),this.objects=c.slice(0),this.length=this.objects.length}var s,d,i;return function(o,e){function s(){this.constructor=o}for(var d in e)y.call(e,d)&&(o[d]=e[d]);s.prototype=e.prototype,o.prototype=new s,o.__super__=e.prototype}(e,o),e.box=function(c){return c instanceof this?c:new this(c)},e.prototype.indexOf=function(c){return this.objects.indexOf(c)},e.prototype.splice=function(){var c;return c=1<=arguments.length?l.call(arguments,0):[],new this.constructor(E.apply(null,[this.objects].concat(l.call(c))))},e.prototype.eachObject=function(c){var a,n,p,m,t;for(t=[],n=a=0,p=(m=this.objects).length;p>a;n=++a)t.push(c(m[n],n));return t},e.prototype.insertObjectAtIndex=function(c,a){return this.splice(a,0,c)},e.prototype.insertSplittableListAtIndex=function(c,a){return this.splice.apply(this,[a,0].concat(l.call(c.objects)))},e.prototype.insertSplittableListAtPosition=function(c,a){var n,u;return n=(u=this.splitObjectAtPosition(a))[1],new this.constructor(u[0]).insertSplittableListAtIndex(c,n)},e.prototype.editObjectAtIndex=function(c,a){return this.replaceObjectAtIndex(a(this.objects[c]),c)},e.prototype.replaceObjectAtIndex=function(c,a){return this.splice(a,1,c)},e.prototype.removeObjectAtIndex=function(c){return this.splice(c,1)},e.prototype.getObjectAtIndex=function(c){return this.objects[c]},e.prototype.getSplittableListInRange=function(c){var p;return p=this.splitObjectsAtRange(c),new this.constructor(p[0].slice(p[1],p[2]+1))},e.prototype.selectSplittableList=function(c){var a,n;return n=function(){var p,u,m,t;for(t=[],p=0,u=(m=this.objects).length;u>p;p++)c(a=m[p])&&t.push(a);return t}.call(this),new this.constructor(n)},e.prototype.removeObjectsInRange=function(c){var a,p,u;return a=(p=this.splitObjectsAtRange(c))[1],u=p[2],new this.constructor(p[0]).splice(a,u-a+1)},e.prototype.transformObjectsInRange=function(c,a){var n,p,u,m,t,r,h;return t=this.splitObjectsAtRange(c),m=t[0],p=t[1],r=t[2],h=function(){var A,f,g;for(g=[],n=A=0,f=m.length;f>A;n=++A)u=m[n],g.push(n>=p&&r>=n?a(u):u);return g}(),new this.constructor(h)},e.prototype.splitObjectsAtRange=function(c){var a,p,u,m;return a=(u=this.splitObjectAtPosition(i(c)))[1],p=u[2],[(m=new this.constructor(u[0]).splitObjectAtPosition(s(c)+p))[0],a,m[1]-1]},e.prototype.getObjectAtPosition=function(c){var p;return p=this.findIndexAndOffsetAtPosition(c),this.objects[p.index]},e.prototype.splitObjectAtPosition=function(c){var a,n,u,m,t,r,A,f;return a=(t=this.findIndexAndOffsetAtPosition(c)).index,m=t.offset,u=this.objects.slice(0),null!=a?0===m?(A=a,f=0):(r=this.getObjectAtIndex(a).splitAtOffset(m),u.splice(a,1,n=r[0],r[1]),A=a+1,f=n.getLength()-m):(A=u.length,f=0),[u,A,f]},e.prototype.consolidate=function(){var c,a,n,p,u,m;for(p=[],u=this.objects[0],c=0,a=(m=this.objects.slice(1)).length;a>c;c++)n=m[c],("function"==typeof u.canBeConsolidatedWith?u.canBeConsolidatedWith(n):void 0)?u=u.consolidateWith(n):(p.push(u),u=n);return null!=u&&p.push(u),new this.constructor(p)},e.prototype.consolidateFromIndexToIndex=function(c,a){var n,u;return u=this.objects.slice(0).slice(c,a+1),n=new this.constructor(u).consolidate().toArray(),this.splice.apply(this,[c,u.length].concat(l.call(n)))},e.prototype.findIndexAndOffsetAtPosition=function(c){var a,n,p,u,m,r;for(a=0,p=n=0,u=(r=this.objects).length;u>n;p=++n){if(m=a+r[p].getLength(),c>=a&&m>c)return{index:p,offset:c-a};a=m}return{index:null,offset:null}},e.prototype.findPositionAtIndexAndOffset=function(c,a){var n,p,u,t,r;for(t=0,n=p=0,u=(r=this.objects).length;u>p;n=++p)if(c>n)t+=r[n].getLength();else if(n===c){t+=a;break}return t},e.prototype.getEndPosition=function(){var a;return null!=this.endPosition?this.endPosition:this.endPosition=function(){var n,p,u;for(a=0,n=0,p=(u=this.objects).length;p>n;n++)a+=u[n].getLength();return a}.call(this)},e.prototype.toString=function(){return this.objects.join("")},e.prototype.toArray=function(){return this.objects.slice(0)},e.prototype.toJSON=function(){return this.toArray()},e.prototype.isEqualTo=function(c){return e.__super__.isEqualTo.apply(this,arguments)||d(this.objects,null!=c?c.objects:void 0)},d=function(c,a){var n,p,u,t;if(null==a&&(a=[]),c.length!==a.length)return!1;for(t=!0,p=n=0,u=c.length;u>n;p=++n)t&&!c[p].isEqualTo(a[p])&&(t=!1);return t},e.prototype.contentsForInspection=function(){return{objects:"["+function(){var a,n,p,u;for(u=[],a=0,n=(p=this.objects).length;n>a;a++)u.push(p[a].inspect());return u}.call(this).join(", ")+"]"}},i=function(c){return c[0]},s=function(c){return c[1]},e}(v.Object)}.call(this),function(){var b={}.hasOwnProperty;v.Text=function(y){function l(o){var e;null==o&&(o=[]),l.__super__.constructor.apply(this,arguments),this.pieceList=new v.SplittableList(function(){var s,d,i;for(i=[],s=0,d=o.length;d>s;s++)(e=o[s]).isEmpty()||i.push(e);return i}())}return function(y,l){function o(){this.constructor=y}for(var e in l)b.call(l,e)&&(y[e]=l[e]);o.prototype=l.prototype,y.prototype=new o,y.__super__=l.prototype}(l,y),l.textForAttachmentWithAttributes=function(o,e){return new this([new v.AttachmentPiece(o,e)])},l.textForStringWithAttributes=function(o,e){return new this([new v.StringPiece(o,e)])},l.fromJSON=function(o){return new this(function(){var d,i,c;for(c=[],d=0,i=o.length;i>d;d++)c.push(v.Piece.fromJSON(o[d]));return c}())},l.prototype.copy=function(){return this.copyWithPieceList(this.pieceList)},l.prototype.copyWithPieceList=function(o){return new this.constructor(o.consolidate().toArray())},l.prototype.copyUsingObjectMap=function(o){var e,s;return s=function(){var d,i,c,a,n;for(n=[],d=0,i=(c=this.getPieces()).length;i>d;d++)n.push(null!=(a=o.find(e=c[d]))?a:e);return n}.call(this),new this.constructor(s)},l.prototype.appendText=function(o){return this.insertTextAtPosition(o,this.getLength())},l.prototype.insertTextAtPosition=function(o,e){return this.copyWithPieceList(this.pieceList.insertSplittableListAtPosition(o.pieceList,e))},l.prototype.removeTextAtRange=function(o){return this.copyWithPieceList(this.pieceList.removeObjectsInRange(o))},l.prototype.replaceTextAtRange=function(o,e){return this.removeTextAtRange(e).insertTextAtPosition(o,e[0])},l.prototype.moveTextFromRangeToPosition=function(o,e){var s,d;if(!(o[0]<=e&&e<=o[1]))return s=(d=this.getTextAtRange(o)).getLength(),o[0]<e&&(e-=s),this.removeTextAtRange(o).insertTextAtPosition(d,e)},l.prototype.addAttributeAtRange=function(o,e,s){var d;return(d={})[o]=e,this.addAttributesAtRange(d,s)},l.prototype.addAttributesAtRange=function(o,e){return this.copyWithPieceList(this.pieceList.transformObjectsInRange(e,function(s){return s.copyWithAdditionalAttributes(o)}))},l.prototype.removeAttributeAtRange=function(o,e){return this.copyWithPieceList(this.pieceList.transformObjectsInRange(e,function(s){return s.copyWithoutAttribute(o)}))},l.prototype.setAttributesAtRange=function(o,e){return this.copyWithPieceList(this.pieceList.transformObjectsInRange(e,function(s){return s.copyWithAttributes(o)}))},l.prototype.getAttributesAtPosition=function(o){var e,s;return null!=(e=null!=(s=this.pieceList.getObjectAtPosition(o))?s.getAttributes():void 0)?e:{}},l.prototype.getCommonAttributes=function(){var o;return o=function(){var s,d,i,c;for(c=[],s=0,d=(i=this.pieceList.toArray()).length;d>s;s++)c.push(i[s].getAttributes());return c}.call(this),v.Hash.fromCommonAttributesOfObjects(o).toObject()},l.prototype.getCommonAttributesAtRange=function(o){var e;return null!=(e=this.getTextAtRange(o).getCommonAttributes())?e:{}},l.prototype.getExpandedRangeForAttributeAtOffset=function(o,e){var s,d,i;for(s=i=e,d=this.getLength();s>0&&this.getCommonAttributesAtRange([s-1,i])[o];)s--;for(;d>i&&this.getCommonAttributesAtRange([e,i+1])[o];)i++;return[s,i]},l.prototype.getTextAtRange=function(o){return this.copyWithPieceList(this.pieceList.getSplittableListInRange(o))},l.prototype.getStringAtRange=function(o){return this.pieceList.getSplittableListInRange(o).toString()},l.prototype.getStringAtPosition=function(o){return this.getStringAtRange([o,o+1])},l.prototype.startsWithString=function(o){return this.getStringAtRange([0,o.length])===o},l.prototype.endsWithString=function(o){var e;return e=this.getLength(),this.getStringAtRange([e-o.length,e])===o},l.prototype.getAttachmentPieces=function(){var o,e,s,d,i;for(i=[],o=0,e=(d=this.pieceList.toArray()).length;e>o;o++)null!=(s=d[o]).attachment&&i.push(s);return i},l.prototype.getAttachments=function(){var o,e,d,i;for(i=[],o=0,e=(d=this.getAttachmentPieces()).length;e>o;o++)i.push(d[o].attachment);return i},l.prototype.getAttachmentAndPositionById=function(o){var e,s,d,i,c,a;for(i=0,e=0,s=(c=this.pieceList.toArray()).length;s>e;e++){if((null!=(a=(d=c[e]).attachment)?a.id:void 0)===o)return{attachment:d.attachment,position:i};i+=d.length}return{attachment:null,position:null}},l.prototype.getAttachmentById=function(o){return this.getAttachmentAndPositionById(o).attachment},l.prototype.getRangeOfAttachment=function(o){var e,s;return e=(s=this.getAttachmentAndPositionById(o.id)).position,null!=(o=s.attachment)?[e,e+1]:void 0},l.prototype.updateAttributesForAttachment=function(o,e){var s;return(s=this.getRangeOfAttachment(e))?this.addAttributesAtRange(o,s):this},l.prototype.getLength=function(){return this.pieceList.getEndPosition()},l.prototype.isEmpty=function(){return 0===this.getLength()},l.prototype.isEqualTo=function(o){var e;return l.__super__.isEqualTo.apply(this,arguments)||(null!=o&&null!=(e=o.pieceList)?e.isEqualTo(this.pieceList):void 0)},l.prototype.isBlockBreak=function(){return 1===this.getLength()&&this.pieceList.getObjectAtIndex(0).isBlockBreak()},l.prototype.eachPiece=function(o){return this.pieceList.eachObject(o)},l.prototype.getPieces=function(){return this.pieceList.toArray()},l.prototype.getPieceAtPosition=function(o){return this.pieceList.getObjectAtPosition(o)},l.prototype.contentsForInspection=function(){return{pieceList:this.pieceList.inspect()}},l.prototype.toSerializableText=function(){var o;return o=this.pieceList.selectSplittableList(function(e){return e.isSerializable()}),this.copyWithPieceList(o)},l.prototype.toString=function(){return this.pieceList.toString()},l.prototype.toJSON=function(){return this.pieceList.toJSON()},l.prototype.toConsole=function(){return JSON.stringify(function(){var e,s,d,i;for(i=[],e=0,s=(d=this.pieceList.toArray()).length;s>e;e++)i.push(JSON.parse(d[e].toConsole()));return i}.call(this))},l.prototype.getDirection=function(){return v.getDirection(this.toString())},l.prototype.isRTL=function(){return"rtl"===this.getDirection()},l}(v.Object)}.call(this),function(){var E,y,l,o,s={}.hasOwnProperty,d=[].indexOf||function(c){for(var a=0,n=this.length;n>a;a++)if(a in this&&this[a]===c)return a;return-1},i=[].slice;E=v.arraysAreEqual,o=v.spliceArray,y=v.getBlockConfig,l=v.getListAttributeNames,v.Block=function(c){function a(g,w){null==g&&(g=new v.Text),null==w&&(w=[]),a.__super__.constructor.apply(this,arguments),this.text=p(g),this.attributes=w}var n,p,u,m,t,r,h,A,f;return function(c,a){function n(){this.constructor=c}for(var p in a)s.call(a,p)&&(c[p]=a[p]);n.prototype=a.prototype,c.prototype=new n,c.__super__=a.prototype}(a,c),a.fromJSON=function(g){return new this(v.Text.fromJSON(g.text),g.attributes)},a.prototype.isEmpty=function(){return this.text.isBlockBreak()},a.prototype.isEqualTo=function(g){return a.__super__.isEqualTo.apply(this,arguments)||this.text.isEqualTo(null!=g?g.text:void 0)&&E(this.attributes,null!=g?g.attributes:void 0)},a.prototype.copyWithText=function(g){return new this.constructor(g,this.attributes)},a.prototype.copyWithoutText=function(){return this.copyWithText(null)},a.prototype.copyWithAttributes=function(g){return new this.constructor(this.text,g)},a.prototype.copyWithoutAttributes=function(){return this.copyWithAttributes(null)},a.prototype.copyUsingObjectMap=function(g){var w;return this.copyWithText((w=g.find(this.text))?w:this.text.copyUsingObjectMap(g))},a.prototype.addAttribute=function(g){var w;return w=this.attributes.concat(m(g)),this.copyWithAttributes(w)},a.prototype.removeAttribute=function(g){var w,k;return k=y(g).listAttribute,w=r(r(this.attributes,g),k),this.copyWithAttributes(w)},a.prototype.removeLastAttribute=function(){return this.removeAttribute(this.getLastAttribute())},a.prototype.getLastAttribute=function(){return t(this.attributes)},a.prototype.getAttributes=function(){return this.attributes.slice(0)},a.prototype.getAttributeLevel=function(){return this.attributes.length},a.prototype.getAttributeAtLevel=function(g){return this.attributes[g-1]},a.prototype.hasAttribute=function(g){return d.call(this.attributes,g)>=0},a.prototype.hasAttributes=function(){return this.getAttributeLevel()>0},a.prototype.getLastNestableAttribute=function(){return t(this.getNestableAttributes())},a.prototype.getNestableAttributes=function(){var g,w,k,O,j;for(j=[],w=0,k=(O=this.attributes).length;k>w;w++)y(g=O[w]).nestable&&j.push(g);return j},a.prototype.getNestingLevel=function(){return this.getNestableAttributes().length},a.prototype.decreaseNestingLevel=function(){var g;return(g=this.getLastNestableAttribute())?this.removeAttribute(g):this},a.prototype.increaseNestingLevel=function(){var g,w,k;return(g=this.getLastNestableAttribute())?(k=this.attributes.lastIndexOf(g),w=o.apply(null,[this.attributes,k+1,0].concat(i.call(m(g)))),this.copyWithAttributes(w)):this},a.prototype.getListItemAttributes=function(){var g,w,k,O,j;for(j=[],w=0,k=(O=this.attributes).length;k>w;w++)y(g=O[w]).listAttribute&&j.push(g);return j},a.prototype.isListItem=function(){var g;return null!=(g=y(this.getLastAttribute()))?g.listAttribute:void 0},a.prototype.isTerminalBlock=function(){var g;return null!=(g=y(this.getLastAttribute()))?g.terminal:void 0},a.prototype.breaksOnReturn=function(){var g;return null!=(g=y(this.getLastAttribute()))?g.breakOnReturn:void 0},a.prototype.findLineBreakInDirectionFromPosition=function(g,w){var k,O;return O=this.toString(),-1!==(k=function(){switch(g){case"forward":return O.indexOf("\n",w);case"backward":return O.slice(0,w).lastIndexOf("\n")}}())?k:void 0},a.prototype.contentsForInspection=function(){return{text:this.text.inspect(),attributes:this.attributes}},a.prototype.toString=function(){return this.text.toString()},a.prototype.toJSON=function(){return{text:this.text,attributes:this.attributes}},a.prototype.getDirection=function(){return this.text.getDirection()},a.prototype.isRTL=function(){return this.text.isRTL()},a.prototype.getLength=function(){return this.text.getLength()},a.prototype.canBeConsolidatedWith=function(g){return!this.hasAttributes()&&!g.hasAttributes()&&this.getDirection()===g.getDirection()},a.prototype.consolidateWith=function(g){var w,k;return w=v.Text.textForStringWithAttributes("\n"),k=this.getTextWithoutBlockBreak().appendText(w),this.copyWithText(k.appendText(g.text))},a.prototype.splitAtOffset=function(g){var w,k;return 0===g?(w=null,k=this):g===this.getLength()?(w=this,k=null):(w=this.copyWithText(this.text.getTextAtRange([0,g])),k=this.copyWithText(this.text.getTextAtRange([g,this.getLength()]))),[w,k]},a.prototype.getBlockBreakPosition=function(){return this.text.getLength()-1},a.prototype.getTextWithoutBlockBreak=function(){return h(this.text)?this.text.getTextAtRange([0,this.getBlockBreakPosition()]):this.text.copy()},a.prototype.canBeGrouped=function(g){return this.attributes[g]},a.prototype.canBeGroupedWith=function(g,w){var k,j,L;return j=g.getAttributes(),!((k=this.attributes[w])!==j[w]||!1===y(k).group&&(L=j[w+1],d.call(l(),L)<0)||this.getDirection()!==g.getDirection()&&!g.isEmpty())},p=function(g){return g=f(g),n(g)},f=function(g){var w,k,O,j,L,R;return j=!1,R=g.getPieces(),k=2<=R.length?i.call(R,0,w=R.length-1):(w=0,[]),null==(O=R[w++])?g:(k=function(){var T,C,x;for(x=[],T=0,C=k.length;C>T;T++)(L=k[T]).isBlockBreak()?(j=!0,x.push(A(L))):x.push(L);return x}(),j?new v.Text(i.call(k).concat([O])):g)},u=v.Text.textForStringWithAttributes("\n",{blockBreak:!0}),n=function(g){return h(g)?g:g.appendText(u)},h=function(g){var k;return 0!==(k=g.getLength())&&g.getTextAtRange([k-1,k]).isBlockBreak()},A=function(g){return g.copyWithoutAttribute("blockBreak")},m=function(g){var w;return null!=(w=y(g).listAttribute)?[w,g]:[g]},t=function(g){return g.slice(-1)[0]},r=function(g,w){var k;return-1===(k=g.lastIndexOf(w))?g:o(g,k,1)},a}(v.Object)}.call(this),function(){var E,b,y,o={}.hasOwnProperty,e=[].indexOf||function(d){for(var i=0,c=this.length;c>i;i++)if(i in this&&this[i]===d)return i;return-1},s=[].slice;b=v.tagName,y=v.walkTree,E=v.nodeIsAttachmentElement,v.HTMLSanitizer=function(d){function i(u,m){var t;this.allowedAttributes=(t=null!=m?m:{}).allowedAttributes,this.forbiddenProtocols=t.forbiddenProtocols,this.forbiddenElements=t.forbiddenElements,null==this.allowedAttributes&&(this.allowedAttributes=c),null==this.forbiddenProtocols&&(this.forbiddenProtocols=n),null==this.forbiddenElements&&(this.forbiddenElements=a),this.body=p(u)}var c,a,n,p;return function(d,i){function c(){this.constructor=d}for(var a in i)o.call(i,a)&&(d[a]=i[a]);c.prototype=i.prototype,d.prototype=new c,d.__super__=i.prototype}(i,d),c="style href src width height class".split(" "),n="javascript:".split(" "),a="script iframe".split(" "),i.sanitize=function(u,m){var t;return(t=new this(u,m)).sanitize(),t},i.prototype.sanitize=function(){return this.sanitizeElements(),this.normalizeListElementNesting()},i.prototype.getHTML=function(){return this.body.innerHTML},i.prototype.getBody=function(){return this.body},i.prototype.sanitizeElements=function(){var u,m,t,r,h;for(h=y(this.body),r=[];h.nextNode();)switch(t=h.currentNode,t.nodeType){case Node.ELEMENT_NODE:this.elementIsRemovable(t)?r.push(t):this.sanitizeElement(t);break;case Node.COMMENT_NODE:r.push(t)}for(u=0,m=r.length;m>u;u++)v.removeNode(t=r[u]);return this.body},i.prototype.sanitizeElement=function(u){var m,t,r,A;for(u.hasAttribute("href")&&e.call(this.forbiddenProtocols,u.protocol)>=0&&u.removeAttribute("href"),m=0,t=(A=s.call(u.attributes)).length;t>m;m++)e.call(this.allowedAttributes,r=A[m].name)>=0||0===r.indexOf("data-trix")||u.removeAttribute(r);return u},i.prototype.normalizeListElementNesting=function(){var u,m,t,r,h;for(u=0,m=(h=s.call(this.body.querySelectorAll("ul,ol"))).length;m>u;u++)(r=(t=h[u]).previousElementSibling)&&"li"===b(r)&&r.appendChild(t);return this.body},i.prototype.elementIsRemovable=function(u){return(null!=u?u.nodeType:void 0)===Node.ELEMENT_NODE?this.elementIsForbidden(u)||this.elementIsntSerializable(u):void 0},i.prototype.elementIsForbidden=function(u){var m;return m=b(u),e.call(this.forbiddenElements,m)>=0},i.prototype.elementIsntSerializable=function(u){return"false"===u.getAttribute("data-trix-serialize")&&!E(u)},p=function(u){var m,r,h,A;for(null==u&&(u=""),u=u.replace(/<\/html[^>]*>[^]*$/i,"</html>"),(m=document.implementation.createHTMLDocument("")).documentElement.innerHTML=u,r=0,h=(A=m.head.querySelectorAll("style")).length;h>r;r++)m.body.appendChild(A[r]);return m.body},i}(v.BasicObject)}.call(this),function(){var E,b,y,l,o,e,s,d,i,c,a,p={}.hasOwnProperty,u=[].indexOf||function(m){for(var t=0,r=this.length;r>t;t++)if(t in this&&this[t]===m)return t;return-1};E=v.arraysAreEqual,e=v.makeElement,c=v.tagName,o=v.getBlockTagNames,a=v.walkTree,l=v.findClosestElementFromNode,y=v.elementContainsNode,s=v.nodeIsAttachmentElement,d=v.normalizeSpaces,b=v.breakableWhitespacePattern,i=v.squishBreakableWhitespace,v.HTMLParser=function(m){function t(C,x){this.html=C,this.referenceElement=(null!=x?x:{}).referenceElement,this.blocks=[],this.blockElements=[],this.processedElements=[]}var r,h,A,f,g,w,k,O,j,L,R,T;return function(m,t){function r(){this.constructor=m}for(var h in t)p.call(t,h)&&(m[h]=t[h]);r.prototype=t.prototype,m.prototype=new r,m.__super__=t.prototype}(t,m),t.parse=function(C,x){var B;return(B=new this(C,x)).parse(),B},t.prototype.getDocument=function(){return v.Document.fromJSON(this.blocks)},t.prototype.parse=function(){var C,x;try{for(this.createHiddenContainer(),C=v.HTMLSanitizer.sanitize(this.html).getHTML(),this.containerElement.innerHTML=C,x=a(this.containerElement,{usingFilter:k});x.nextNode();)this.processNode(x.currentNode);return this.translateBlockElementMarginsToNewlines()}finally{this.removeHiddenContainer()}},t.prototype.createHiddenContainer=function(){return this.referenceElement?(this.containerElement=this.referenceElement.cloneNode(!1),this.containerElement.removeAttribute("id"),this.containerElement.setAttribute("data-trix-internal",""),this.containerElement.style.display="none",this.referenceElement.parentNode.insertBefore(this.containerElement,this.referenceElement.nextSibling)):(this.containerElement=e({tagName:"div",style:{display:"none"}}),document.body.appendChild(this.containerElement))},t.prototype.removeHiddenContainer=function(){return v.removeNode(this.containerElement)},k=function(C){return"style"===c(C)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},t.prototype.processNode=function(C){switch(C.nodeType){case Node.TEXT_NODE:if(!this.isInsignificantTextNode(C))return this.appendBlockForTextNode(C),this.processTextNode(C);break;case Node.ELEMENT_NODE:return this.appendBlockForElement(C),this.processElement(C)}},t.prototype.appendBlockForTextNode=function(C){var x,B,Z;return(B=C.parentNode)===this.currentBlockElement&&this.isBlockElement(C.previousSibling)?this.appendStringWithAttributes("\n"):B!==this.containerElement&&!this.isBlockElement(B)||(x=this.getBlockAttributes(B),E(x,null!=(Z=this.currentBlock)?Z.attributes:void 0))?void 0:(this.currentBlock=this.appendBlockForAttributesWithElement(x,B),this.currentBlockElement=B)},t.prototype.appendBlockForElement=function(C){var x,B,Z,ft;if(Z=this.isBlockElement(C),B=y(this.currentBlockElement,C),Z&&!this.isBlockElement(C.firstChild)){if((!this.isInsignificantTextNode(C.firstChild)||!this.isBlockElement(C.firstElementChild))&&(x=this.getBlockAttributes(C),C.firstChild))return B&&E(x,this.currentBlock.attributes)?this.appendStringWithAttributes("\n"):(this.currentBlock=this.appendBlockForAttributesWithElement(x,C),this.currentBlockElement=C)}else if(this.currentBlockElement&&!B&&!Z)return(ft=this.findParentBlockElement(C))?this.appendBlockForElement(ft):(this.currentBlock=this.appendEmptyBlock(),this.currentBlockElement=null)},t.prototype.findParentBlockElement=function(C){var x;for(x=C.parentElement;x&&x!==this.containerElement;){if(this.isBlockElement(x)&&u.call(this.blockElements,x)>=0)return x;x=x.parentElement}return null},t.prototype.processTextNode=function(C){var x,B;return B=C.data,h(C.parentNode)||(B=i(B),R(null!=(x=C.previousSibling)?x.textContent:void 0)&&(B=g(B))),this.appendStringWithAttributes(B,this.getTextAttributes(C.parentNode))},t.prototype.processElement=function(C){var x,B,Z,ft;if(s(C))return x=O(C,"attachment"),Object.keys(x).length&&(ft=this.getTextAttributes(C),this.appendAttachmentWithAttributes(x,ft),C.innerHTML=""),this.processedElements.push(C);switch(c(C)){case"br":return this.isExtraBR(C)||this.isBlockElement(C.nextSibling)||this.appendStringWithAttributes("\n",this.getTextAttributes(C)),this.processedElements.push(C);case"img":for(B in x={url:C.getAttribute("src"),contentType:"image"},Z=f(C))x[B]=Z[B];return this.appendAttachmentWithAttributes(x,this.getTextAttributes(C)),this.processedElements.push(C);case"tr":if(C.parentNode.firstChild!==C)return this.appendStringWithAttributes("\n");break;case"td":if(C.parentNode.firstChild!==C)return this.appendStringWithAttributes(" | ")}},t.prototype.appendBlockForAttributesWithElement=function(C,x){var B;return this.blockElements.push(x),B=r(C),this.blocks.push(B),B},t.prototype.appendEmptyBlock=function(){return this.appendBlockForAttributesWithElement([],null)},t.prototype.appendStringWithAttributes=function(C,x){return this.appendPiece(L(C,x))},t.prototype.appendAttachmentWithAttributes=function(C,x){return this.appendPiece(j(C,x))},t.prototype.appendPiece=function(C){return 0===this.blocks.length&&this.appendEmptyBlock(),this.blocks[this.blocks.length-1].text.push(C)},t.prototype.appendStringToTextAtIndex=function(C,x){var B,Z;return"string"===(null!=(B=(Z=this.blocks[x].text)[Z.length-1])?B.type:void 0)?B.string+=C:Z.push(L(C))},t.prototype.prependStringToTextAtIndex=function(C,x){var B,Z;return"string"===(null!=(B=(Z=this.blocks[x].text)[0])?B.type:void 0)?B.string=C+B.string:Z.unshift(L(C))},L=function(C,x){return null==x&&(x={}),{string:C=d(C),attributes:x,type:"string"}},j=function(C,x){return null==x&&(x={}),{attachment:C,attributes:x,type:"attachment"}},r=function(C){return null==C&&(C={}),{text:[],attributes:C}},t.prototype.getTextAttributes=function(C){var x,B,Z,At,Wt,Dt,Zt,fe,oe,pe,ue;for(x in Z={},fe=v.config.textAttributes)if((At=fe[x]).tagName&&l(C,{matchingSelector:At.tagName,untilNode:this.containerElement}))Z[x]=!0;else if(At.parser){if(ue=At.parser(C)){for(B=!1,Wt=0,Zt=(oe=this.findBlockElementAncestors(C)).length;Zt>Wt;Wt++)if(At.parser(oe[Wt])===ue){B=!0;break}B||(Z[x]=ue)}}else At.styleProperty&&(ue=C.style[At.styleProperty])&&(Z[x]=ue);if(s(C))for(Dt in pe=O(C,"attributes"))Z[Dt]=ue=pe[Dt];return Z},t.prototype.getBlockAttributes=function(C){var x,B,Z,ft;for(B=[];C&&C!==this.containerElement;){for(x in ft=v.config.blockAttributes)!1!==(Z=ft[x]).parse&&c(C)===Z.tagName&&(("function"==typeof Z.test?Z.test(C):void 0)||!Z.test)&&(B.push(x),Z.listAttribute&&B.push(Z.listAttribute));C=C.parentNode}return B.reverse()},t.prototype.findBlockElementAncestors=function(C){var x,B;for(x=[];C&&C!==this.containerElement;)B=c(C),u.call(o(),B)>=0&&x.push(C),C=C.parentNode;return x},O=function(C,x){try{return JSON.parse(C.getAttribute("data-trix-"+x))}catch(B){return{}}},f=function(C){var x,B,Z;return Z=C.getAttribute("width"),B=C.getAttribute("height"),x={},Z&&(x.width=parseInt(Z,10)),B&&(x.height=parseInt(B,10)),x},t.prototype.isBlockElement=function(C){var x;if((null!=C?C.nodeType:void 0)===Node.ELEMENT_NODE&&!s(C)&&!l(C,{matchingSelector:"td",untilNode:this.containerElement}))return x=c(C),u.call(o(),x)>=0||"block"===window.getComputedStyle(C).display},t.prototype.isInsignificantTextNode=function(C){var x,B,Z;if((null!=C?C.nodeType:void 0)===Node.TEXT_NODE&&T(C.data)&&(Z=C.previousSibling,x=C.nextSibling,(!w((B=C.parentNode).previousSibling)||this.isBlockElement(B.previousSibling))&&!h(B)))return!Z||this.isBlockElement(Z)||!x||this.isBlockElement(x)},t.prototype.isExtraBR=function(C){return"br"===c(C)&&this.isBlockElement(C.parentNode)&&C.parentNode.lastChild===C},h=function(C){var x;return"pre"===(x=window.getComputedStyle(C).whiteSpace)||"pre-wrap"===x||"pre-line"===x},w=function(C){return C&&!R(C.textContent)},t.prototype.translateBlockElementMarginsToNewlines=function(){var x,B,Z,ft,At,Dt;for(x=this.getMarginOfDefaultBlockElement(),Dt=[],Z=B=0,ft=this.blocks.length;ft>B;Z=++B)(At=this.getMarginOfBlockElementAtIndex(Z))&&(At.top>2*x.top&&this.prependStringToTextAtIndex("\n",Z),Dt.push(At.bottom>2*x.bottom?this.appendStringToTextAtIndex("\n",Z):void 0));return Dt},t.prototype.getMarginOfBlockElementAtIndex=function(C){var x,B;return!(x=this.blockElements[C])||!x.textContent||(B=c(x),u.call(o(),B)>=0||u.call(this.processedElements,x)>=0)?void 0:A(x)},t.prototype.getMarginOfDefaultBlockElement=function(){var C;return C=e(v.config.blockAttributes.default.tagName),this.containerElement.appendChild(C),A(C)},A=function(C){var x;return"block"===(x=window.getComputedStyle(C)).display?{top:parseInt(x.marginTop),bottom:parseInt(x.marginBottom)}:void 0},g=function(C){return C.replace(RegExp("^"+b.source+"+"),"")},T=function(C){return RegExp("^"+b.source+"*$").test(C)},R=function(C){return/\s$/.test(C)},t}(v.BasicObject)}.call(this),function(){var E,b,y,l,e={}.hasOwnProperty,s=[].slice,d=[].indexOf||function(i){for(var c=0,a=this.length;a>c;c++)if(c in this&&this[c]===i)return c;return-1};E=v.arraysAreEqual,y=v.normalizeRange,l=v.rangeIsCollapsed,b=v.getBlockConfig,v.Document=function(i){function c(n){null==n&&(n=[]),c.__super__.constructor.apply(this,arguments),0===n.length&&(n=[new v.Block]),this.blockList=v.SplittableList.box(n)}var a;return function(i,c){function a(){this.constructor=i}for(var n in c)e.call(c,n)&&(i[n]=c[n]);a.prototype=c.prototype,i.prototype=new a,i.__super__=c.prototype}(c,i),c.fromJSON=function(n){return new this(function(){var m,t,r;for(r=[],m=0,t=n.length;t>m;m++)r.push(v.Block.fromJSON(n[m]));return r}())},c.fromHTML=function(n,p){return v.HTMLParser.parse(n,p).getDocument()},c.fromString=function(n,p){var u;return u=v.Text.textForStringWithAttributes(n,p),new this([new v.Block(u)])},c.prototype.isEmpty=function(){var n;return 1===this.blockList.length&&(n=this.getBlockAtIndex(0)).isEmpty()&&!n.hasAttributes()},c.prototype.copy=function(n){var p;return null==n&&(n={}),p=n.consolidateBlocks?this.blockList.consolidate().toArray():this.blockList.toArray(),new this.constructor(p)},c.prototype.copyUsingObjectsFromDocument=function(n){var p;return p=new v.ObjectMap(n.getObjects()),this.copyUsingObjectMap(p)},c.prototype.copyUsingObjectMap=function(n){var p,u,m;return u=function(){var t,r,h,A;for(A=[],t=0,r=(h=this.getBlocks()).length;r>t;t++)A.push((m=n.find(p=h[t]))?m:p.copyUsingObjectMap(n));return A}.call(this),new this.constructor(u)},c.prototype.copyWithBaseBlockAttributes=function(n){var p,u,m;return null==n&&(n=[]),m=function(){var t,r,h,A;for(A=[],t=0,r=(h=this.getBlocks()).length;r>t;t++)p=n.concat((u=h[t]).getAttributes()),A.push(u.copyWithAttributes(p));return A}.call(this),new this.constructor(m)},c.prototype.replaceBlock=function(n,p){var u;return-1===(u=this.blockList.indexOf(n))?this:new this.constructor(this.blockList.replaceObjectAtIndex(p,u))},c.prototype.insertDocumentAtRange=function(n,p){var u,m,t,r,h,A,f;return m=n.blockList,h=(p=y(p))[0],t=(A=this.locationFromPosition(h)).index,r=A.offset,f=this,u=this.getBlockAtPosition(h),l(p)&&u.isEmpty()&&!u.hasAttributes()?f=new this.constructor(f.blockList.removeObjectAtIndex(t)):u.getBlockBreakPosition()===r&&h++,f=f.removeTextAtRange(p),new this.constructor(f.blockList.insertSplittableListAtPosition(m,h))},c.prototype.mergeDocumentAtRange=function(n,p){var u,m,t,r,h,A,f,g,w,k,O,j;return O=(p=y(p))[0],k=this.locationFromPosition(O),m=this.getBlockAtIndex(k.index).getAttributes(),u=n.getBaseBlockAttributes(),j=m.slice(-u.length),E(u,j)?(f=m.slice(0,-u.length),A=n.copyWithBaseBlockAttributes(f)):A=n.copy({consolidateBlocks:!0}).copyWithBaseBlockAttributes(m),t=A.getBlockCount(),r=A.getBlockAtIndex(0),E(m,r.getAttributes())?(h=r.getTextWithoutBlockBreak(),w=this.insertTextAtRange(h,p),t>1&&(A=new this.constructor(A.getBlocks().slice(1)),g=O+h.getLength(),w=w.insertDocumentAtRange(A,g))):w=this.insertDocumentAtRange(A,p),w},c.prototype.insertTextAtRange=function(n,p){var u,m,t,r,h;return h=(p=y(p))[0],m=(r=this.locationFromPosition(h)).index,t=r.offset,u=this.removeTextAtRange(p),new this.constructor(u.blockList.editObjectAtIndex(m,function(A){return A.copyWithText(A.text.insertTextAtPosition(n,t))}))},c.prototype.removeTextAtRange=function(n){var u,m,t,r,h,A,f,g,w,k,L,R,T,C,x,B,Z;return f=(w=n=y(n))[0],x=w[1],l(n)?this:(T=(k=this.locationRangeFromRange(n))[1],A=(h=k[0]).offset,t=this.getBlockAtIndex(r=h.index),C=T.offset,L=this.getBlockAtIndex(R=T.index),x-f==1&&t.getBlockBreakPosition()===A&&L.getBlockBreakPosition()!==C&&"\n"===L.text.getStringAtPosition(C)?m=this.blockList.editObjectAtIndex(R,function(At){return At.copyWithText(At.text.removeTextAtRange([C,C+1]))}):(g=t.text.getTextAtRange([0,A]),B=L.text.getTextAtRange([C,L.getLength()]),Z=g.appendText(B),u=r!==R&&0===A&&t.getAttributeLevel()>=L.getAttributeLevel()?L.copyWithText(Z):t.copyWithText(Z),m=this.blockList.splice(r,R+1-r,u)),new this.constructor(m))},c.prototype.moveTextFromRangeToPosition=function(n,p){var u,m,r,h,A,f,g,w,k;return p>=(w=(A=n=y(n))[0])&&A[1]>=p?this:(m=this.getDocumentAtRange(n),g=this.removeTextAtRange(n),(h=p>w)&&(p-=m.getLength()),r=(f=m.getBlocks())[0],0===(u=2<=f.length?s.call(f,1):[]).length?(k=r.getTextWithoutBlockBreak(),h&&(p+=1)):k=r.text,g=g.insertTextAtRange(k,p),0===u.length?g:(m=new this.constructor(u),p+=k.getLength(),g.insertDocumentAtRange(m,p)))},c.prototype.addAttributeAtRange=function(n,p,u){var m;return m=this.blockList,this.eachBlockAtRange(u,function(t,r,h){return m=m.editObjectAtIndex(h,function(){return b(n)?t.addAttribute(n,p):r[0]===r[1]?t:t.copyWithText(t.text.addAttributeAtRange(n,p,r))})}),new this.constructor(m)},c.prototype.addAttribute=function(n,p){var u;return u=this.blockList,this.eachBlock(function(m,t){return u=u.editObjectAtIndex(t,function(){return m.addAttribute(n,p)})}),new this.constructor(u)},c.prototype.removeAttributeAtRange=function(n,p){var u;return u=this.blockList,this.eachBlockAtRange(p,function(m,t,r){return b(n)?u=u.editObjectAtIndex(r,function(){return m.removeAttribute(n)}):t[0]!==t[1]?u=u.editObjectAtIndex(r,function(){return m.copyWithText(m.text.removeAttributeAtRange(n,t))}):void 0}),new this.constructor(u)},c.prototype.updateAttributesForAttachment=function(n,p){var u,t,r;return t=this.getRangeOfAttachment(p)[0],u=this.locationFromPosition(t).index,r=this.getTextAtIndex(u),new this.constructor(this.blockList.editObjectAtIndex(u,function(h){return h.copyWithText(r.updateAttributesForAttachment(n,p))}))},c.prototype.removeAttributeForAttachment=function(n,p){var u;return u=this.getRangeOfAttachment(p),this.removeAttributeAtRange(n,u)},c.prototype.insertBlockBreakAtRange=function(n){var p,u,m,t;return t=(n=y(n))[0],m=this.locationFromPosition(t).offset,u=this.removeTextAtRange(n),0===m&&(p=[new v.Block]),new this.constructor(u.blockList.insertSplittableListAtPosition(new v.SplittableList(p),t))},c.prototype.applyBlockAttributeAtRange=function(n,p,u){var m,t,r,h;return t=(r=this.expandRangeToLineBreaksAndSplitBlocks(u)).document,u=r.range,(m=b(n)).listAttribute?(h=(t=t.removeLastListAttributeAtRange(u,{exceptAttributeName:n})).convertLineBreaksToBlockBreaksInRange(u),t=h.document,u=h.range):t=m.exclusive?t.removeBlockAttributesAtRange(u):m.terminal?t.removeLastTerminalAttributeAtRange(u):t.consolidateBlocksAtRange(u),t.addAttributeAtRange(n,p,u)},c.prototype.removeLastListAttributeAtRange=function(n,p){var u;return null==p&&(p={}),u=this.blockList,this.eachBlockAtRange(n,function(m,t,r){var h;if((h=m.getLastAttribute())&&b(h).listAttribute&&h!==p.exceptAttributeName)return u=u.editObjectAtIndex(r,function(){return m.removeAttribute(h)})}),new this.constructor(u)},c.prototype.removeLastTerminalAttributeAtRange=function(n){var p;return p=this.blockList,this.eachBlockAtRange(n,function(u,m,t){var r;if((r=u.getLastAttribute())&&b(r).terminal)return p=p.editObjectAtIndex(t,function(){return u.removeAttribute(r)})}),new this.constructor(p)},c.prototype.removeBlockAttributesAtRange=function(n){var p;return p=this.blockList,this.eachBlockAtRange(n,function(u,m,t){return u.hasAttributes()?p=p.editObjectAtIndex(t,function(){return u.copyWithoutAttributes()}):void 0}),new this.constructor(p)},c.prototype.expandRangeToLineBreaksAndSplitBlocks=function(n){var p,u,m,t,r,h,A,f,g;return t=(h=n=y(n))[1],f=this.locationFromPosition(h[0]),m=this.locationFromPosition(t),A=(p=this).getBlockAtIndex(f.index),null!=(f.offset=A.findLineBreakInDirectionFromPosition("backward",f.offset))&&(r=p.positionFromLocation(f),p=p.insertBlockBreakAtRange([r,r+1]),m.index+=1,m.offset-=p.getBlockAtIndex(f.index).getLength(),f.index+=1),f.offset=0,0===m.offset&&m.index>f.index?(m.index-=1,m.offset=p.getBlockAtIndex(m.index).getBlockBreakPosition()):("\n"===(u=p.getBlockAtIndex(m.index)).text.getStringAtRange([m.offset-1,m.offset])?m.offset-=1:m.offset=u.findLineBreakInDirectionFromPosition("forward",m.offset),m.offset!==u.getBlockBreakPosition()&&(r=p.positionFromLocation(m),p=p.insertBlockBreakAtRange([r,r+1]))),g=p.positionFromLocation(f),t=p.positionFromLocation(m),{document:p,range:n=y([g,t])}},c.prototype.convertLineBreaksToBlockBreaksInRange=function(n){var p,u,m;return u=(n=y(n))[0],m=this.getStringAtRange(n).slice(0,-1),p=this,m.replace(/.*?\n/g,function(t){return p=p.insertBlockBreakAtRange([(u+=t.length)-1,u])}),{document:p,range:n}},c.prototype.consolidateBlocksAtRange=function(n){var p,u,m,t;return u=(m=n=y(n))[1],t=this.locationFromPosition(m[0]).index,p=this.locationFromPosition(u).index,new this.constructor(this.blockList.consolidateFromIndexToIndex(t,p))},c.prototype.getDocumentAtRange=function(n){var p;return n=y(n),p=this.blockList.getSplittableListInRange(n).toArray(),new this.constructor(p)},c.prototype.getStringAtRange=function(n){var p,m;return(m=n=y(n))[m.length-1]!==this.getLength()&&(p=-1),this.getDocumentAtRange(n).toString().slice(0,p)},c.prototype.getBlockAtIndex=function(n){return this.blockList.getObjectAtIndex(n)},c.prototype.getBlockAtPosition=function(n){var p;return p=this.locationFromPosition(n).index,this.getBlockAtIndex(p)},c.prototype.getTextAtIndex=function(n){var p;return null!=(p=this.getBlockAtIndex(n))?p.text:void 0},c.prototype.getTextAtPosition=function(n){var p;return p=this.locationFromPosition(n).index,this.getTextAtIndex(p)},c.prototype.getPieceAtPosition=function(n){var u,m;return u=(m=this.locationFromPosition(n)).offset,this.getTextAtIndex(m.index).getPieceAtPosition(u)},c.prototype.getCharacterAtPosition=function(n){var u,m;return u=(m=this.locationFromPosition(n)).offset,this.getTextAtIndex(m.index).getStringAtRange([u,u+1])},c.prototype.getLength=function(){return this.blockList.getEndPosition()},c.prototype.getBlocks=function(){return this.blockList.toArray()},c.prototype.getBlockCount=function(){return this.blockList.length},c.prototype.getEditCount=function(){return this.editCount},c.prototype.eachBlock=function(n){return this.blockList.eachObject(n)},c.prototype.eachBlockAtRange=function(n,p){var u,m,t,r,h,A,f,g,w,k,j;if(t=(A=n=y(n))[1],k=this.locationFromPosition(A[0]),m=this.locationFromPosition(t),k.index===m.index)return p(u=this.getBlockAtIndex(k.index),j=[k.offset,m.offset],k.index);for(w=[],h=r=f=k.index,g=m.index;g>=f?g>=r:r>=g;h=g>=f?++r:--r)(u=this.getBlockAtIndex(h))?(j=function(){switch(h){case k.index:return[k.offset,u.text.getLength()];case m.index:return[0,m.offset];default:return[0,u.text.getLength()]}}(),w.push(p(u,j,h))):w.push(void 0);return w},c.prototype.getCommonAttributesAtRange=function(n){var p,u,m;return u=(n=y(n))[0],l(n)?this.getCommonAttributesAtPosition(u):(m=[],p=[],this.eachBlockAtRange(n,function(t,r){return r[0]!==r[1]?(m.push(t.text.getCommonAttributesAtRange(r)),p.push(a(t))):void 0}),v.Hash.fromCommonAttributesOfObjects(m).merge(v.Hash.fromCommonAttributesOfObjects(p)).toObject())},c.prototype.getCommonAttributesAtPosition=function(n){var p,u,m,t,h,A,f,g,w;if(f=(g=this.locationFromPosition(n)).offset,!(m=this.getBlockAtIndex(g.index)))return{};for(A in t=a(m),p=m.text.getAttributesAtPosition(f),u=m.text.getAttributesAtPosition(f-1),h=function(){var k,O;for(A in O=[],k=v.config.textAttributes)(w=k[A]).inheritable&&O.push(A);return O}(),u)((w=u[A])===p[A]||d.call(h,A)>=0)&&(t[A]=w);return t},c.prototype.getRangeOfCommonAttributeAtPosition=function(n,p){var u,m,t,r,h,A,f;return r=(h=this.locationFromPosition(p)).offset,m=(A=this.getTextAtIndex(t=h.index).getExpandedRangeForAttributeAtOffset(n,r))[1],f=this.positionFromLocation({index:t,offset:A[0]}),u=this.positionFromLocation({index:t,offset:m}),y([f,u])},c.prototype.getBaseBlockAttributes=function(){var n,p,u,m,t,r,h;for(n=this.getBlockAtIndex(0).getAttributes(),u=m=1,h=this.getBlockCount();h>=1?h>m:m>h;u=h>=1?++m:--m)p=this.getBlockAtIndex(u).getAttributes(),r=Math.min(n.length,p.length),n=function(){var A,f,g;for(g=[],t=A=0,f=r;(f>=0?f>A:A>f)&&p[t]===n[t];t=f>=0?++A:--A)g.push(p[t]);return g}();return n},a=function(n){var p,u;return u={},(p=n.getLastAttribute())&&(u[p]=!0),u},c.prototype.getAttachmentById=function(n){var p,u,m,t;for(u=0,m=(t=this.getAttachments()).length;m>u;u++)if((p=t[u]).id===n)return p},c.prototype.getAttachmentPieces=function(){var n;return n=[],this.blockList.eachObject(function(p){return n=n.concat(p.text.getAttachmentPieces())}),n},c.prototype.getAttachments=function(){var n,p,m,t;for(t=[],n=0,p=(m=this.getAttachmentPieces()).length;p>n;n++)t.push(m[n].attachment);return t},c.prototype.getRangeOfAttachment=function(n){var p,u,m,t,r,h,A;for(t=0,u=p=0,m=(r=this.blockList.toArray()).length;m>p;u=++p){if(A=(h=r[u].text).getRangeOfAttachment(n))return y([t+A[0],t+A[1]]);t+=h.getLength()}},c.prototype.getLocationRangeOfAttachment=function(n){var p;return p=this.getRangeOfAttachment(n),this.locationRangeFromRange(p)},c.prototype.getAttachmentPieceForAttachment=function(n){var p,u,m,t;for(p=0,u=(t=this.getAttachmentPieces()).length;u>p;p++)if((m=t[p]).attachment===n)return m},c.prototype.findRangesForBlockAttribute=function(n){var p,u,m,t,r,h,A;for(r=0,h=[],u=0,m=(A=this.getBlocks()).length;m>u;u++)t=(p=A[u]).getLength(),p.hasAttribute(n)&&h.push([r,r+t]),r+=t;return h},c.prototype.findRangesForTextAttribute=function(n,p){var u,m,t,r,h,A,f,g,w,k;for(k=(null!=p?p:{}).withValue,A=0,f=[],g=[],r=function(O){return null!=k?O.getAttribute(n)===k:O.hasAttribute(n)},u=0,m=(w=this.getPieces()).length;m>u;u++)t=(h=w[u]).getLength(),r(h)&&(f[1]===A?f[1]=A+t:g.push(f=[A,A+t])),A+=t;return g},c.prototype.locationFromPosition=function(n){var p,u;return null!=(u=this.blockList.findIndexAndOffsetAtPosition(Math.max(0,n))).index?u:{index:(p=this.getBlocks()).length-1,offset:p[p.length-1].getLength()}},c.prototype.positionFromLocation=function(n){return this.blockList.findPositionAtIndexAndOffset(n.index,n.offset)},c.prototype.locationRangeFromPosition=function(n){return y(this.locationFromPosition(n))},c.prototype.locationRangeFromRange=function(n){var p,u,m;if(n=y(n))return u=n[1],m=this.locationFromPosition(n[0]),p=this.locationFromPosition(u),y([m,p])},c.prototype.rangeFromLocationRange=function(n){var p,u;return n=y(n),p=this.positionFromLocation(n[0]),l(n)||(u=this.positionFromLocation(n[1])),y([p,u])},c.prototype.isEqualTo=function(n){return this.blockList.isEqualTo(null!=n?n.blockList:void 0)},c.prototype.getTexts=function(){var p,u,m,t;for(t=[],p=0,u=(m=this.getBlocks()).length;u>p;p++)t.push(m[p].text);return t},c.prototype.getPieces=function(){var n,p,u,m;for(u=[],n=0,p=(m=this.getTexts()).length;p>n;n++)u.push.apply(u,m[n].getPieces());return u},c.prototype.getObjects=function(){return this.getBlocks().concat(this.getTexts()).concat(this.getPieces())},c.prototype.toSerializableDocument=function(){var n;return n=[],this.blockList.eachObject(function(p){return n.push(p.copyWithText(p.text.toSerializableText()))}),new this.constructor(n)},c.prototype.toString=function(){return this.blockList.toString()},c.prototype.toJSON=function(){return this.blockList.toJSON()},c.prototype.toConsole=function(){return JSON.stringify(function(){var p,u,m,t;for(t=[],p=0,u=(m=this.blockList.toArray()).length;u>p;p++)t.push(JSON.parse(m[p].text.toConsole()));return t}.call(this))},c}(v.Object)}.call(this),function(){v.LineBreakInsertion=function(){function E(b){var y;this.composition=b,this.document=this.composition.document,y=this.composition.getSelectedRange(),this.startPosition=y[0],this.endPosition=y[1],this.startLocation=this.document.locationFromPosition(this.startPosition),this.endLocation=this.document.locationFromPosition(this.endPosition),this.block=this.document.getBlockAtIndex(this.endLocation.index),this.breaksOnReturn=this.block.breaksOnReturn(),this.previousCharacter=this.block.text.getStringAtPosition(this.endLocation.offset-1),this.nextCharacter=this.block.text.getStringAtPosition(this.endLocation.offset)}return E.prototype.shouldInsertBlockBreak=function(){return this.block.hasAttributes()&&this.block.isListItem()&&!this.block.isEmpty()?0!==this.startLocation.offset:this.breaksOnReturn&&"\n"!==this.nextCharacter},E.prototype.shouldBreakFormattedBlock=function(){return this.block.hasAttributes()&&!this.block.isListItem()&&(this.breaksOnReturn&&"\n"===this.nextCharacter||"\n"===this.previousCharacter)},E.prototype.shouldDecreaseListLevel=function(){return this.block.hasAttributes()&&this.block.isListItem()&&this.block.isEmpty()},E.prototype.shouldPrependListItem=function(){return this.block.isListItem()&&0===this.startLocation.offset&&!this.block.isEmpty()},E.prototype.shouldRemoveLastBlockAttribute=function(){return this.block.hasAttributes()&&!this.block.isListItem()&&this.block.isEmpty()},E}()}.call(this),function(){var E,b,y,l,o,e,s,d,i,c,n={}.hasOwnProperty;e=v.normalizeRange,i=v.rangesAreEqual,d=v.rangeIsCollapsed,s=v.objectsAreEqual,E=v.arrayStartsWith,c=v.summarizeArrayChange,y=v.getAllAttributeNames,l=v.getBlockConfig,o=v.getTextConfig,b=v.extend,v.Composition=function(p){function u(){this.document=new v.Document,this.attachments=[],this.currentAttributes={},this.revision=0}return function(p,u){function m(){this.constructor=p}for(var t in u)n.call(u,t)&&(p[t]=u[t]);m.prototype=u.prototype,p.prototype=new m,p.__super__=u.prototype}(u,p),u.prototype.setDocument=function(t){var r;return t.isEqualTo(this.document)?void 0:(this.document=t,this.refreshAttachments(),this.revision++,null!=(r=this.delegate)&&"function"==typeof r.compositionDidChangeDocument?r.compositionDidChangeDocument(t):void 0)},u.prototype.getSnapshot=function(){return{document:this.document,selectedRange:this.getSelectedRange()}},u.prototype.loadSnapshot=function(t){var r,h,A,f;return r=t.document,f=t.selectedRange,null!=(h=this.delegate)&&"function"==typeof h.compositionWillLoadSnapshot&&h.compositionWillLoadSnapshot(),this.setDocument(null!=r?r:new v.Document),this.setSelection(null!=f?f:[0,0]),null!=(A=this.delegate)&&"function"==typeof A.compositionDidLoadSnapshot?A.compositionDidLoadSnapshot():void 0},u.prototype.insertText=function(t,r){var h,A,f,g;return g=(null!=r?r:{updatePosition:!0}).updatePosition,A=this.getSelectedRange(),this.setDocument(this.document.insertTextAtRange(t,A)),h=(f=A[0])+t.getLength(),g&&this.setSelection(h),this.notifyDelegateOfInsertionAtRange([f,h])},u.prototype.insertBlock=function(t){var r;return null==t&&(t=new v.Block),r=new v.Document([t]),this.insertDocument(r)},u.prototype.insertDocument=function(t){var r,h,A;return null==t&&(t=new v.Document),h=this.getSelectedRange(),this.setDocument(this.document.insertDocumentAtRange(t,h)),r=(A=h[0])+t.getLength(),this.setSelection(r),this.notifyDelegateOfInsertionAtRange([A,r])},u.prototype.insertString=function(t,r){var h,A;return h=this.getCurrentTextAttributes(),A=v.Text.textForStringWithAttributes(t,h),this.insertText(A,r)},u.prototype.insertBlockBreak=function(){var t,r,h;return r=this.getSelectedRange(),this.setDocument(this.document.insertBlockBreakAtRange(r)),this.setSelection(t=(h=r[0])+1),this.notifyDelegateOfInsertionAtRange([h,t])},u.prototype.insertLineBreak=function(){var t,r;return(r=new v.LineBreakInsertion(this)).shouldDecreaseListLevel()?(this.decreaseListLevel(),this.setSelection(r.startPosition)):r.shouldPrependListItem()?(t=new v.Document([r.block.copyWithoutText()]),this.insertDocument(t)):r.shouldInsertBlockBreak()?this.insertBlockBreak():r.shouldRemoveLastBlockAttribute()?this.removeLastBlockAttribute():r.shouldBreakFormattedBlock()?this.breakFormattedBlock(r):this.insertString("\n")},u.prototype.insertHTML=function(t){var r,h,A,f;return r=v.Document.fromHTML(t),A=this.getSelectedRange(),this.setDocument(this.document.mergeDocumentAtRange(r,A)),h=(f=A[0])+r.getLength()-1,this.setSelection(h),this.notifyDelegateOfInsertionAtRange([f,h])},u.prototype.replaceHTML=function(t){var r,h,A;return r=v.Document.fromHTML(t).copyUsingObjectsFromDocument(this.document),h=this.getLocationRange({strict:!1}),A=this.document.rangeFromLocationRange(h),this.setDocument(r),this.setSelection(A)},u.prototype.insertFile=function(t){return this.insertFiles([t])},u.prototype.insertFiles=function(t){var r,h,A,f,g,w;for(h=[],f=0,g=t.length;g>f;f++)A=t[f],(null!=(w=this.delegate)?w.compositionShouldAcceptFile(A):void 0)&&(r=v.Attachment.attachmentForFile(A),h.push(r));return this.insertAttachments(h)},u.prototype.insertAttachment=function(t){return this.insertAttachments([t])},u.prototype.insertAttachments=function(t){var r,h,A,f,g,w,k,O,j;for(O=new v.Text,f=0,g=t.length;g>f;f++)j=(r=t[f]).getType(),w=null!=(k=v.config.attachments[j])?k.presentation:void 0,A=this.getCurrentTextAttributes(),w&&(A.presentation=w),h=v.Text.textForAttachmentWithAttributes(r,A),O=O.appendText(h);return this.insertText(O)},u.prototype.shouldManageDeletingInDirection=function(t){var r;if(r=this.getLocationRange(),d(r)){if("backward"===t&&0===r[0].offset||this.shouldManageMovingCursorInDirection(t))return!0}else if(r[0].index!==r[1].index)return!0;return!1},u.prototype.deleteInDirection=function(t,r){var h,A,f,g,w,k,O,j;return g=(null!=r?r:{}).length,w=this.getLocationRange(),k=this.getSelectedRange(),(O=d(k))?f="backward"===t&&0===w[0].offset:j=w[0].index!==w[1].index,!(f&&this.canDecreaseBlockAttributeLevel()&&(A=this.getBlock(),A.isListItem()?this.decreaseListLevel():this.decreaseBlockAttributeLevel(),this.setSelection(k[0]),A.isEmpty()))&&(O&&(k=this.getExpandedRangeInDirection(t,{length:g}),"backward"===t&&(h=this.getAttachmentAtRange(k))),h?(this.editAttachment(h),!1):(this.setDocument(this.document.removeTextAtRange(k)),this.setSelection(k[0]),!f&&!j&&void 0))},u.prototype.moveTextFromRange=function(t){var r;return r=this.getSelectedRange()[0],this.setDocument(this.document.moveTextFromRangeToPosition(t,r)),this.setSelection(r)},u.prototype.removeAttachment=function(t){var r;return(r=this.document.getRangeOfAttachment(t))?(this.stopEditingAttachment(),this.setDocument(this.document.removeTextAtRange(r)),this.setSelection(r[0])):void 0},u.prototype.removeLastBlockAttribute=function(){var t,h,A;return A=(h=this.getSelectedRange())[0],t=this.document.getBlockAtPosition(h[1]),this.removeCurrentAttribute(t.getLastAttribute()),this.setSelection(A)},u.prototype.insertPlaceholder=function(){return this.placeholderPosition=this.getPosition(),this.insertString(" ")},u.prototype.selectPlaceholder=function(){return null!=this.placeholderPosition?(this.setSelectedRange([this.placeholderPosition,this.placeholderPosition+" ".length]),this.getSelectedRange()):void 0},u.prototype.forgetPlaceholder=function(){return this.placeholderPosition=null},u.prototype.hasCurrentAttribute=function(t){var r;return null!=(r=this.currentAttributes[t])&&!1!==r},u.prototype.toggleCurrentAttribute=function(t){var r;return(r=!this.currentAttributes[t])?this.setCurrentAttribute(t,r):this.removeCurrentAttribute(t)},u.prototype.canSetCurrentAttribute=function(t){return l(t)?this.canSetCurrentBlockAttribute(t):this.canSetCurrentTextAttribute(t)},u.prototype.canSetCurrentTextAttribute=function(){var r,h,A,f;if(r=this.getSelectedDocument()){for(h=0,A=(f=r.getAttachments()).length;A>h;h++)if(!f[h].hasContent())return!1;return!0}},u.prototype.canSetCurrentBlockAttribute=function(){var t;if(t=this.getBlock())return!t.isTerminalBlock()},u.prototype.setCurrentAttribute=function(t,r){return l(t)?this.setBlockAttribute(t,r):(this.setTextAttribute(t,r),this.currentAttributes[t]=r,this.notifyDelegateOfCurrentAttributesChange())},u.prototype.setTextAttribute=function(t,r){var A,g;if(A=this.getSelectedRange())return A[0]!==A[1]?this.setDocument(this.document.addAttributeAtRange(t,r,A)):"href"===t?(g=v.Text.textForStringWithAttributes(r,{href:r}),this.insertText(g)):void 0},u.prototype.setBlockAttribute=function(t,r){var A;if(A=this.getSelectedRange())return this.canSetCurrentAttribute(t)?(this.getBlock(),this.setDocument(this.document.applyBlockAttributeAtRange(t,r,A)),this.setSelection(A)):void 0},u.prototype.removeCurrentAttribute=function(t){return l(t)?(this.removeBlockAttribute(t),this.updateCurrentAttributes()):(this.removeTextAttribute(t),delete this.currentAttributes[t],this.notifyDelegateOfCurrentAttributesChange())},u.prototype.removeTextAttribute=function(t){var r;if(r=this.getSelectedRange())return this.setDocument(this.document.removeAttributeAtRange(t,r))},u.prototype.removeBlockAttribute=function(t){var r;if(r=this.getSelectedRange())return this.setDocument(this.document.removeAttributeAtRange(t,r))},u.prototype.canDecreaseNestingLevel=function(){var t;return(null!=(t=this.getBlock())?t.getNestingLevel():void 0)>0},u.prototype.canIncreaseNestingLevel=function(){var t,r,h;if(t=this.getBlock())return null!=(h=l(t.getLastNestableAttribute()))&&h.listAttribute?(r=this.getPreviousBlock())?E(r.getListItemAttributes(),t.getListItemAttributes()):void 0:t.getNestingLevel()>0},u.prototype.decreaseNestingLevel=function(){var t;if(t=this.getBlock())return this.setDocument(this.document.replaceBlock(t,t.decreaseNestingLevel()))},u.prototype.increaseNestingLevel=function(){var t;if(t=this.getBlock())return this.setDocument(this.document.replaceBlock(t,t.increaseNestingLevel()))},u.prototype.canDecreaseBlockAttributeLevel=function(){var t;return(null!=(t=this.getBlock())?t.getAttributeLevel():void 0)>0},u.prototype.decreaseBlockAttributeLevel=function(){var t,r;return(t=null!=(r=this.getBlock())?r.getLastAttribute():void 0)?this.removeCurrentAttribute(t):void 0},u.prototype.decreaseListLevel=function(){var t,r,h,A,f,g;for(g=this.getSelectedRange()[0],h=f=this.document.locationFromPosition(g).index,t=this.getBlock().getAttributeLevel();(r=this.document.getBlockAtIndex(h+1))&&r.isListItem()&&r.getAttributeLevel()>t;)h++;return g=this.document.positionFromLocation({index:f,offset:0}),A=this.document.positionFromLocation({index:h,offset:0}),this.setDocument(this.document.removeLastListAttributeAtRange([g,A]))},u.prototype.updateCurrentAttributes=function(){var t,r,h,A,f,g;if(g=this.getSelectedRange({ignoreLock:!0})){for(r=this.document.getCommonAttributesAtRange(g),h=0,A=(f=y()).length;A>h;h++)r[t=f[h]]||this.canSetCurrentAttribute(t)||(r[t]=!1);if(!s(r,this.currentAttributes))return this.currentAttributes=r,this.notifyDelegateOfCurrentAttributesChange()}},u.prototype.getCurrentAttributes=function(){return b.call({},this.currentAttributes)},u.prototype.getCurrentTextAttributes=function(){var t,r,h,A;for(r in t={},h=this.currentAttributes)!1!==(A=h[r])&&o(r)&&(t[r]=A);return t},u.prototype.freezeSelection=function(){return this.setCurrentAttribute("frozen",!0)},u.prototype.thawSelection=function(){return this.removeCurrentAttribute("frozen")},u.prototype.hasFrozenSelection=function(){return this.hasCurrentAttribute("frozen")},u.proxyMethod("getSelectionManager().getPointRange"),u.proxyMethod("getSelectionManager().setLocationRangeFromPointRange"),u.proxyMethod("getSelectionManager().createLocationRangeFromDOMRange"),u.proxyMethod("getSelectionManager().locationIsCursorTarget"),u.proxyMethod("getSelectionManager().selectionIsExpanded"),u.proxyMethod("delegate?.getSelectionManager"),u.prototype.setSelection=function(t){var r,h;return r=this.document.locationRangeFromRange(t),null!=(h=this.delegate)?h.compositionDidRequestChangingSelectionToLocationRange(r):void 0},u.prototype.getSelectedRange=function(){var t;return(t=this.getLocationRange())?this.document.rangeFromLocationRange(t):void 0},u.prototype.setSelectedRange=function(t){var r;return r=this.document.locationRangeFromRange(t),this.getSelectionManager().setLocationRange(r)},u.prototype.getPosition=function(){var t;return(t=this.getLocationRange())?this.document.positionFromLocation(t[0]):void 0},u.prototype.getLocationRange=function(t){var r,h;return null!=(r=null!=(h=this.targetLocationRange)?h:this.getSelectionManager().getLocationRange(t))?r:e({index:0,offset:0})},u.prototype.withTargetLocationRange=function(t,r){var h;this.targetLocationRange=t;try{h=r()}finally{this.targetLocationRange=null}return h},u.prototype.withTargetRange=function(t,r){var h;return h=this.document.locationRangeFromRange(t),this.withTargetLocationRange(h,r)},u.prototype.withTargetDOMRange=function(t,r){var h;return h=this.createLocationRangeFromDOMRange(t,{strict:!1}),this.withTargetLocationRange(h,r)},u.prototype.getExpandedRangeInDirection=function(t,r){var h,A,f,g;return A=(null!=r?r:{}).length,g=(f=this.getSelectedRange())[0],h=f[1],"backward"===t?A?g-=A:g=this.translateUTF16PositionFromOffset(g,-1):A?h+=A:h=this.translateUTF16PositionFromOffset(h,1),e([g,h])},u.prototype.shouldManageMovingCursorInDirection=function(t){var r;return!!this.editingAttachment||(r=this.getExpandedRangeInDirection(t),null!=this.getAttachmentAtRange(r))},u.prototype.moveCursorInDirection=function(t){var r,h,A,f;return this.editingAttachment?A=this.document.getRangeOfAttachment(this.editingAttachment):(f=this.getSelectedRange(),A=this.getExpandedRangeInDirection(t),h=!i(f,A)),this.setSelectedRange("backward"===t?A[0]:A[1]),h&&(r=this.getAttachmentAtRange(A))?this.editAttachment(r):void 0},u.prototype.expandSelectionInDirection=function(t,r){var A;return A=this.getExpandedRangeInDirection(t,{length:(null!=r?r:{}).length}),this.setSelectedRange(A)},u.prototype.expandSelectionForEditing=function(){return this.hasCurrentAttribute("href")?this.expandSelectionAroundCommonAttribute("href"):void 0},u.prototype.expandSelectionAroundCommonAttribute=function(t){var r,h;return r=this.getPosition(),h=this.document.getRangeOfCommonAttributeAtPosition(t,r),this.setSelectedRange(h)},u.prototype.selectionContainsAttachments=function(){var t;return(null!=(t=this.getSelectedAttachments())?t.length:void 0)>0},u.prototype.selectionIsInCursorTarget=function(){return this.editingAttachment||this.positionIsCursorTarget(this.getPosition())},u.prototype.positionIsCursorTarget=function(t){var r;return(r=this.document.locationFromPosition(t))?this.locationIsCursorTarget(r):void 0},u.prototype.positionIsBlockBreak=function(t){var r;return null!=(r=this.document.getPieceAtPosition(t))?r.isBlockBreak():void 0},u.prototype.getSelectedDocument=function(){var t;return(t=this.getSelectedRange())?this.document.getDocumentAtRange(t):void 0},u.prototype.getSelectedAttachments=function(){var t;return null!=(t=this.getSelectedDocument())?t.getAttachments():void 0},u.prototype.getAttachments=function(){return this.attachments.slice(0)},u.prototype.refreshAttachments=function(){var t,r,h,A,f,g,w,k,O,j,L,R;for(h=this.document.getAttachments(),t=(k=c(this.attachments,h)).added,L=k.removed,this.attachments=h,A=0,g=L.length;g>A;A++)(r=L[A]).delegate=null,null!=(O=this.delegate)&&"function"==typeof O.compositionDidRemoveAttachment&&O.compositionDidRemoveAttachment(r);for(R=[],f=0,w=t.length;w>f;f++)(r=t[f]).delegate=this,R.push(null!=(j=this.delegate)&&"function"==typeof j.compositionDidAddAttachment?j.compositionDidAddAttachment(r):void 0);return R},u.prototype.attachmentDidChangeAttributes=function(t){var r;return this.revision++,null!=(r=this.delegate)&&"function"==typeof r.compositionDidEditAttachment?r.compositionDidEditAttachment(t):void 0},u.prototype.attachmentDidChangePreviewURL=function(t){var r;return this.revision++,null!=(r=this.delegate)&&"function"==typeof r.compositionDidChangeAttachmentPreviewURL?r.compositionDidChangeAttachmentPreviewURL(t):void 0},u.prototype.editAttachment=function(t,r){var h;if(t!==this.editingAttachment)return this.stopEditingAttachment(),this.editingAttachment=t,null!=(h=this.delegate)&&"function"==typeof h.compositionDidStartEditingAttachment?h.compositionDidStartEditingAttachment(this.editingAttachment,r):void 0},u.prototype.stopEditingAttachment=function(){var t;if(this.editingAttachment)return null!=(t=this.delegate)&&"function"==typeof t.compositionDidStopEditingAttachment&&t.compositionDidStopEditingAttachment(this.editingAttachment),this.editingAttachment=null},u.prototype.updateAttributesForAttachment=function(t,r){return this.setDocument(this.document.updateAttributesForAttachment(t,r))},u.prototype.removeAttributeForAttachment=function(t,r){return this.setDocument(this.document.removeAttributeForAttachment(t,r))},u.prototype.breakFormattedBlock=function(t){var r,h,A,f,g;return h=t.document,g=[(f=t.startPosition)-1,f],(r=t.block).getBlockBreakPosition()===t.startLocation.offset?(r.breaksOnReturn()&&"\n"===t.nextCharacter?f+=1:h=h.removeTextAtRange(g),g=[f,f]):"\n"===t.nextCharacter?"\n"===t.previousCharacter?g=[f-1,f+1]:(g=[f,f+1],f+=1):t.startLocation.offset-1!=0&&(f+=1),A=new v.Document([r.removeLastAttribute().copyWithoutText()]),this.setDocument(h.insertDocumentAtRange(A,g)),this.setSelection(f)},u.prototype.getPreviousBlock=function(){var t,r;return(r=this.getLocationRange())&&(t=r[0].index)>0?this.document.getBlockAtIndex(t-1):void 0},u.prototype.getBlock=function(){var t;return(t=this.getLocationRange())?this.document.getBlockAtIndex(t[0].index):void 0},u.prototype.getAttachmentAtRange=function(t){var r;return(r=this.document.getDocumentAtRange(t)).toString()===v.OBJECT_REPLACEMENT_CHARACTER+"\n"?r.getAttachments()[0]:void 0},u.prototype.notifyDelegateOfCurrentAttributesChange=function(){var t;return null!=(t=this.delegate)&&"function"==typeof t.compositionDidChangeCurrentAttributes?t.compositionDidChangeCurrentAttributes(this.currentAttributes):void 0},u.prototype.notifyDelegateOfInsertionAtRange=function(t){var r;return null!=(r=this.delegate)&&"function"==typeof r.compositionDidPerformInsertionAtRange?r.compositionDidPerformInsertionAtRange(t):void 0},u.prototype.translateUTF16PositionFromOffset=function(t,r){var h,A;return h=(A=this.document.toUTF16String()).offsetFromUCS2Offset(t),A.offsetToUCS2Offset(h+r)},u}(v.BasicObject)}.call(this),function(){var b={}.hasOwnProperty;v.UndoManager=function(y){function l(e){this.composition=e,this.undoEntries=[],this.redoEntries=[]}var o;return function(y,l){function o(){this.constructor=y}for(var e in l)b.call(l,e)&&(y[e]=l[e]);o.prototype=l.prototype,y.prototype=new o,y.__super__=l.prototype}(l,y),l.prototype.recordUndoEntry=function(e,s){var d,i,c,a,n;return i=(a=null!=s?s:{}).context,d=a.consolidatable,c=this.undoEntries.slice(-1)[0],d&&o(c,e,i)?void 0:(n=this.createEntry({description:e,context:i}),this.undoEntries.push(n),this.redoEntries=[])},l.prototype.undo=function(){var e,s;return(s=this.undoEntries.pop())?(e=this.createEntry(s),this.redoEntries.push(e),this.composition.loadSnapshot(s.snapshot)):void 0},l.prototype.redo=function(){var e,s;return(e=this.redoEntries.pop())?(s=this.createEntry(e),this.undoEntries.push(s),this.composition.loadSnapshot(e.snapshot)):void 0},l.prototype.canUndo=function(){return this.undoEntries.length>0},l.prototype.canRedo=function(){return this.redoEntries.length>0},l.prototype.createEntry=function(e){var s,d,i;return s=(i=null!=e?e:{}).context,{description:null!=(d=i.description)?d.toString():void 0,context:JSON.stringify(s),snapshot:this.composition.getSnapshot()}},o=function(e,s,d){return(null!=e?e.description:void 0)===(null!=s?s.toString():void 0)&&(null!=e?e.context:void 0)===JSON.stringify(d)},l}(v.BasicObject)}.call(this),function(){var E;v.attachmentGalleryFilter=function(b){var y;return(y=new E(b)).perform(),y.getSnapshot()},E=function(){function b(e){this.document=e.document,this.selectedRange=e.selectedRange}var y;return y="attachmentGallery",b.prototype.perform=function(){return this.removeBlockAttribute(),this.applyBlockAttribute()},b.prototype.getSnapshot=function(){return{document:this.document,selectedRange:this.selectedRange}},b.prototype.removeBlockAttribute=function(){var e,s,i,c;for(c=[],e=0,s=(i=this.findRangesOfBlocks()).length;s>e;e++)c.push(this.document=this.document.removeAttributeAtRange(y,i[e]));return c},b.prototype.applyBlockAttribute=function(){var e,s,d,i,c,a;for(d=0,a=[],e=0,s=(c=this.findRangesOfPieces()).length;s>e;e++)(i=c[e])[1]-i[0]>1&&(i[0]+=d,i[1]+=d,"\n"!==this.document.getCharacterAtPosition(i[1])&&(this.document=this.document.insertBlockBreakAtRange(i[1]),i[1]<this.selectedRange[1]&&this.moveSelectedRangeForward(),i[1]++,d++),0!==i[0]&&"\n"!==this.document.getCharacterAtPosition(i[0]-1)&&(this.document=this.document.insertBlockBreakAtRange(i[0]),i[0]<this.selectedRange[0]&&this.moveSelectedRangeForward(),i[0]++,d++),a.push(this.document=this.document.applyBlockAttributeAtRange(y,!0,i)));return a},b.prototype.findRangesOfBlocks=function(){return this.document.findRangesForBlockAttribute(y)},b.prototype.findRangesOfPieces=function(){return this.document.findRangesForTextAttribute("presentation",{withValue:"gallery"})},b.prototype.moveSelectedRangeForward=function(){return this.selectedRange[0]+=1,this.selectedRange[1]+=1},b}()}.call(this),function(){v.Editor=function(){function b(l,o,e){this.composition=l,this.selectionManager=o,this.element=e,this.insertFiles=function(b,y){return function(){return b.apply(y,arguments)}}(this.insertFiles,this),this.undoManager=new v.UndoManager(this.composition),this.filters=y.slice(0)}var y;return y=[v.attachmentGalleryFilter],b.prototype.loadDocument=function(l){return this.loadSnapshot({document:l,selectedRange:[0,0]})},b.prototype.loadHTML=function(l){return null==l&&(l=""),this.loadDocument(v.Document.fromHTML(l,{referenceElement:this.element}))},b.prototype.loadJSON=function(l){var o,e;return e=l.selectedRange,o=v.Document.fromJSON(o=l.document),this.loadSnapshot({document:o,selectedRange:e})},b.prototype.loadSnapshot=function(l){return this.undoManager=new v.UndoManager(this.composition),this.composition.loadSnapshot(l)},b.prototype.getDocument=function(){return this.composition.document},b.prototype.getSelectedDocument=function(){return this.composition.getSelectedDocument()},b.prototype.getSnapshot=function(){return this.composition.getSnapshot()},b.prototype.toJSON=function(){return this.getSnapshot()},b.prototype.deleteInDirection=function(l){return this.composition.deleteInDirection(l)},b.prototype.insertAttachment=function(l){return this.composition.insertAttachment(l)},b.prototype.insertAttachments=function(l){return this.composition.insertAttachments(l)},b.prototype.insertDocument=function(l){return this.composition.insertDocument(l)},b.prototype.insertFile=function(l){return this.composition.insertFile(l)},b.prototype.insertFiles=function(l){return this.composition.insertFiles(l)},b.prototype.insertHTML=function(l){return this.composition.insertHTML(l)},b.prototype.insertString=function(l){return this.composition.insertString(l)},b.prototype.insertText=function(l){return this.composition.insertText(l)},b.prototype.insertLineBreak=function(){return this.composition.insertLineBreak()},b.prototype.getSelectedRange=function(){return this.composition.getSelectedRange()},b.prototype.getPosition=function(){return this.composition.getPosition()},b.prototype.getClientRectAtPosition=function(l){var o;return o=this.getDocument().locationRangeFromRange([l,l+1]),this.selectionManager.getClientRectAtLocationRange(o)},b.prototype.expandSelectionInDirection=function(l){return this.composition.expandSelectionInDirection(l)},b.prototype.moveCursorInDirection=function(l){return this.composition.moveCursorInDirection(l)},b.prototype.setSelectedRange=function(l){return this.composition.setSelectedRange(l)},b.prototype.activateAttribute=function(l,o){return null==o&&(o=!0),this.composition.setCurrentAttribute(l,o)},b.prototype.attributeIsActive=function(l){return this.composition.hasCurrentAttribute(l)},b.prototype.canActivateAttribute=function(l){return this.composition.canSetCurrentAttribute(l)},b.prototype.deactivateAttribute=function(l){return this.composition.removeCurrentAttribute(l)},b.prototype.canDecreaseNestingLevel=function(){return this.composition.canDecreaseNestingLevel()},b.prototype.canIncreaseNestingLevel=function(){return this.composition.canIncreaseNestingLevel()},b.prototype.decreaseNestingLevel=function(){return this.canDecreaseNestingLevel()?this.composition.decreaseNestingLevel():void 0},b.prototype.increaseNestingLevel=function(){return this.canIncreaseNestingLevel()?this.composition.increaseNestingLevel():void 0},b.prototype.canRedo=function(){return this.undoManager.canRedo()},b.prototype.canUndo=function(){return this.undoManager.canUndo()},b.prototype.recordUndoEntry=function(l,o){var d;return this.undoManager.recordUndoEntry(l,{context:(d=null!=o?o:{}).context,consolidatable:d.consolidatable})},b.prototype.redo=function(){return this.canRedo()?this.undoManager.redo():void 0},b.prototype.undo=function(){return this.canUndo()?this.undoManager.undo():void 0},b}()}.call(this),function(){var b={}.hasOwnProperty;v.ManagedAttachment=function(y){function l(o,e){var s;this.attachmentManager=o,this.attachment=e,this.id=(s=this.attachment).id,this.file=s.file}return function(y,l){function o(){this.constructor=y}for(var e in l)b.call(l,e)&&(y[e]=l[e]);o.prototype=l.prototype,y.prototype=new o,y.__super__=l.prototype}(l,y),l.prototype.remove=function(){return this.attachmentManager.requestRemovalOfAttachment(this.attachment)},l.proxyMethod("attachment.getAttribute"),l.proxyMethod("attachment.hasAttribute"),l.proxyMethod("attachment.setAttribute"),l.proxyMethod("attachment.getAttributes"),l.proxyMethod("attachment.setAttributes"),l.proxyMethod("attachment.isPending"),l.proxyMethod("attachment.isPreviewable"),l.proxyMethod("attachment.getURL"),l.proxyMethod("attachment.getHref"),l.proxyMethod("attachment.getFilename"),l.proxyMethod("attachment.getFilesize"),l.proxyMethod("attachment.getFormattedFilesize"),l.proxyMethod("attachment.getExtension"),l.proxyMethod("attachment.getContentType"),l.proxyMethod("attachment.getFile"),l.proxyMethod("attachment.setFile"),l.proxyMethod("attachment.releaseFile"),l.proxyMethod("attachment.getUploadProgress"),l.proxyMethod("attachment.setUploadProgress"),l}(v.BasicObject)}.call(this),function(){var b={}.hasOwnProperty;v.AttachmentManager=function(y){function l(o){var s,d;for(null==o&&(o=[]),this.managedAttachments={},s=0,d=o.length;d>s;s++)this.manageAttachment(o[s])}return function(y,l){function o(){this.constructor=y}for(var e in l)b.call(l,e)&&(y[e]=l[e]);o.prototype=l.prototype,y.prototype=new o,y.__super__=l.prototype}(l,y),l.prototype.getAttachments=function(){var e,s,d;for(e in d=[],s=this.managedAttachments)d.push(s[e]);return d},l.prototype.manageAttachment=function(o){var e,s;return null!=(e=this.managedAttachments)[s=o.id]?e[s]:e[s]=new v.ManagedAttachment(this,o)},l.prototype.attachmentIsManaged=function(o){return o.id in this.managedAttachments},l.prototype.requestRemovalOfAttachment=function(o){var e;return this.attachmentIsManaged(o)&&null!=(e=this.delegate)&&"function"==typeof e.attachmentManagerDidRequestRemovalOfAttachment?e.attachmentManagerDidRequestRemovalOfAttachment(o):void 0},l.prototype.unmanageAttachment=function(o){var e;return e=this.managedAttachments[o.id],delete this.managedAttachments[o.id],e},l}(v.BasicObject)}.call(this),function(){var E,b,y,l,o,e,s,d,i,c,a;E=v.elementContainsNode,b=v.findChildIndexOfNode,o=v.nodeIsBlockStart,e=v.nodeIsBlockStartComment,l=v.nodeIsBlockContainer,s=v.nodeIsCursorTarget,d=v.nodeIsEmptyTextNode,i=v.nodeIsTextNode,y=v.nodeIsAttachmentElement,c=v.tagName,a=v.walkTree,v.LocationMapper=function(){function n(r){this.element=r}var p,u,m,t;return n.prototype.findLocationFromContainerAndOffset=function(r,h,A){var f,g,w,k,O,j,L;for(j=(null!=A?A:{strict:!0}).strict,g=0,w=!1,k={index:0,offset:0},(f=this.findAttachmentElementParentForNode(r))&&(r=f.parentNode,h=b(f)),L=a(this.element,{usingFilter:m});L.nextNode();){if((O=L.currentNode)===r&&i(r)){s(O)||(k.offset+=h);break}if(O.parentNode===r){if(g++===h)break}else if(!E(r,O)&&g>0)break;o(O,{strict:j})?(w&&k.index++,k.offset=0,w=!0):k.offset+=u(O)}return k},n.prototype.findContainerAndOffsetFromLocation=function(r){var h,A,f,g,w;if(0===r.index&&0===r.offset){for(h=this.element,g=0;h.firstChild;)if(l(h=h.firstChild)){g=1;break}return[h,g]}if(f=(w=this.findNodeAndOffsetFromLocation(r))[1],A=w[0]){if(i(A))0===u(A)?(h=A.parentNode.parentNode,g=b(A.parentNode),s(A,{name:"right"})&&g++):(h=A,g=r.offset-f);else{if(h=A.parentNode,!o(A.previousSibling)&&!l(h))for(;A===h.lastChild&&(A=h,!l(h=h.parentNode)););g=b(A),0!==r.offset&&g++}return[h,g]}},n.prototype.findNodeAndOffsetFromLocation=function(r){var h,A,f,g,w,k,O,j;for(O=0,A=0,f=(j=this.getSignificantNodesForIndex(r.index)).length;f>A;A++){if(g=u(h=j[A]),r.offset<=O+g)if(i(h)){if(w=h,r.offset===(k=O)&&s(w))break}else w||(w=h,k=O);if((O+=g)>r.offset)break}return[w,k]},n.prototype.findAttachmentElementParentForNode=function(r){for(;r&&r!==this.element;){if(y(r))return r;r=r.parentNode}},n.prototype.getSignificantNodesForIndex=function(r){var h,A,f,g,w;for(f=[],w=a(this.element,{usingFilter:p}),g=!1;w.nextNode();)if(e(A=w.currentNode)){if(null!=h?h++:h=0,h===r)g=!0;else if(g)break}else g&&f.push(A);return f},u=function(r){return r.nodeType===Node.TEXT_NODE?s(r)?0:r.textContent.length:"br"===c(r)||y(r)?1:0},p=function(r){return t(r)===NodeFilter.FILTER_ACCEPT?m(r):NodeFilter.FILTER_REJECT},t=function(r){return d(r)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},m=function(r){return y(r.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT},n}()}.call(this),function(){var E,b,y=[].slice;E=v.getDOMRange,b=v.setDOMRange,v.PointMapper=function(){function l(){}return l.prototype.createDOMRangeFromPoint=function(o){var e,s,d,i,c,a,n,p;if(n=o.x,p=o.y,document.caretPositionFromPoint)return d=(c=document.caretPositionFromPoint(n,p)).offsetNode,s=c.offset,(e=document.createRange()).setStart(d,s),e;if(document.caretRangeFromPoint)return document.caretRangeFromPoint(n,p);if(document.body.createTextRange){i=E();try{(a=document.body.createTextRange()).moveToPoint(n,p),a.select()}catch(u){}return e=E(),b(i),e}},l.prototype.getClientRectsForDOMRange=function(o){var s;return[(s=y.call(o.getClientRects()))[0],s[s.length-1]]},l}()}.call(this),function(){var E,b=function(e,s){return function(){return e.apply(s,arguments)}},l={}.hasOwnProperty,o=[].indexOf||function(e){for(var s=0,d=this.length;d>s;s++)if(s in this&&this[s]===e)return s;return-1};E=v.getDOMRange,v.SelectionChangeObserver=function(e){function s(){this.run=b(this.run,this),this.update=b(this.update,this),this.selectionManagers=[]}var d;return function(e,s){function d(){this.constructor=e}for(var i in s)l.call(s,i)&&(e[i]=s[i]);d.prototype=s.prototype,e.prototype=new d,e.__super__=s.prototype}(s,e),s.prototype.start=function(){return this.started?void 0:(this.started=!0,"onselectionchange"in document?document.addEventListener("selectionchange",this.update,!0):this.run())},s.prototype.stop=function(){return this.started?(this.started=!1,document.removeEventListener("selectionchange",this.update,!0)):void 0},s.prototype.registerSelectionManager=function(i){return o.call(this.selectionManagers,i)<0?(this.selectionManagers.push(i),this.start()):void 0},s.prototype.unregisterSelectionManager=function(i){var c;return this.selectionManagers=function(){var a,n,p,u;for(u=[],a=0,n=(p=this.selectionManagers).length;n>a;a++)(c=p[a])!==i&&u.push(c);return u}.call(this),0===this.selectionManagers.length?this.stop():void 0},s.prototype.notifySelectionManagersOfSelectionChange=function(){var i,c,a,n;for(n=[],i=0,c=(a=this.selectionManagers).length;c>i;i++)n.push(a[i].selectionDidChange());return n},s.prototype.update=function(){var i;return i=E(),d(i,this.domRange)?void 0:(this.domRange=i,this.notifySelectionManagersOfSelectionChange())},s.prototype.reset=function(){return this.domRange=null,this.update()},s.prototype.run=function(){return this.started?(this.update(),requestAnimationFrame(this.run)):void 0},d=function(i,c){return(null!=i?i.startContainer:void 0)===(null!=c?c.startContainer:void 0)&&(null!=i?i.startOffset:void 0)===(null!=c?c.startOffset:void 0)&&(null!=i?i.endContainer:void 0)===(null!=c?c.endContainer:void 0)&&(null!=i?i.endOffset:void 0)===(null!=c?c.endOffset:void 0)},s}(v.BasicObject),null==v.selectionChangeObserver&&(v.selectionChangeObserver=new v.SelectionChangeObserver)}.call(this),function(){var E,b,y,l,o,e,s,d,i,c,a=function(u,m){return function(){return u.apply(m,arguments)}},p={}.hasOwnProperty;y=v.getDOMSelection,b=v.getDOMRange,c=v.setDOMRange,E=v.elementContainsNode,e=v.nodeIsCursorTarget,o=v.innerElementIsActive,l=v.handleEvent,s=v.normalizeRange,d=v.rangeIsCollapsed,i=v.rangesAreEqual,v.SelectionManager=function(u){function m(t){this.element=t,this.selectionDidChange=a(this.selectionDidChange,this),this.didMouseDown=a(this.didMouseDown,this),this.locationMapper=new v.LocationMapper(this.element),this.pointMapper=new v.PointMapper,this.lockCount=0,l("mousedown",{onElement:this.element,withCallback:this.didMouseDown})}return function(u,m){function t(){this.constructor=u}for(var r in m)p.call(m,r)&&(u[r]=m[r]);t.prototype=m.prototype,u.prototype=new t,u.__super__=m.prototype}(m,u),m.prototype.getLocationRange=function(t){var h;return null==t&&(t={}),!1===t.strict?this.createLocationRangeFromDOMRange(b(),{strict:!1}):t.ignoreLock?this.currentLocationRange:null!=(h=this.lockedLocationRange)?h:this.currentLocationRange},m.prototype.setLocationRange=function(t){var r;if(!this.lockedLocationRange)return t=s(t),(r=this.createDOMRangeFromLocationRange(t))?(c(r),this.updateCurrentLocationRange(t)):void 0},m.prototype.setLocationRangeFromPointRange=function(t){var r,h;return t=s(t),h=this.getLocationAtPoint(t[0]),r=this.getLocationAtPoint(t[1]),this.setLocationRange([h,r])},m.prototype.getClientRectAtLocationRange=function(t){var r;return(r=this.createDOMRangeFromLocationRange(t))?this.getClientRectsForDOMRange(r)[1]:void 0},m.prototype.locationIsCursorTarget=function(t){var A;return A=this.findNodeAndOffsetFromLocation(t),e(A[0])},m.prototype.lock=function(){return 0==this.lockCount++?(this.updateCurrentLocationRange(),this.lockedLocationRange=this.getLocationRange()):void 0},m.prototype.unlock=function(){var t;return 0==--this.lockCount&&(t=this.lockedLocationRange,this.lockedLocationRange=null,null!=t)?this.setLocationRange(t):void 0},m.prototype.clearSelection=function(){var t;return null!=(t=y())?t.removeAllRanges():void 0},m.prototype.selectionIsCollapsed=function(){var t;return!0===(null!=(t=b())?t.collapsed:void 0)},m.prototype.selectionIsExpanded=function(){return!this.selectionIsCollapsed()},m.prototype.createLocationRangeFromDOMRange=function(t,r){var h,A;if(null!=t&&this.domRangeWithinElement(t)&&(A=this.findLocationFromContainerAndOffset(t.startContainer,t.startOffset,r)))return t.collapsed||(h=this.findLocationFromContainerAndOffset(t.endContainer,t.endOffset,r)),s([A,h])},m.proxyMethod("locationMapper.findLocationFromContainerAndOffset"),m.proxyMethod("locationMapper.findContainerAndOffsetFromLocation"),m.proxyMethod("locationMapper.findNodeAndOffsetFromLocation"),m.proxyMethod("pointMapper.createDOMRangeFromPoint"),m.proxyMethod("pointMapper.getClientRectsForDOMRange"),m.prototype.didMouseDown=function(){return this.pauseTemporarily()},m.prototype.pauseTemporarily=function(){var r,h,A,f;return this.paused=!0,f=this,r=function(){var w,k;for(f.paused=!1,clearTimeout(A),w=0,k=h.length;k>w;w++)h[w].destroy();return E(document,f.element)?f.selectionDidChange():void 0},A=setTimeout(r,200),h=function(){var f,g,w,k;for(k=[],f=0,g=(w=["mousemove","keydown"]).length;g>f;f++)k.push(l(w[f],{onElement:document,withCallback:r}));return k}()},m.prototype.selectionDidChange=function(){return this.paused||o(this.element)?void 0:this.updateCurrentLocationRange()},m.prototype.updateCurrentLocationRange=function(t){var r;return(null!=t?t:t=this.createLocationRangeFromDOMRange(b()))&&!i(t,this.currentLocationRange)?(this.currentLocationRange=t,null!=(r=this.delegate)&&"function"==typeof r.locationRangeDidChange?r.locationRangeDidChange(this.currentLocationRange.slice(0)):void 0):void 0},m.prototype.createDOMRangeFromLocationRange=function(t){var r,h,A,f;return A=this.findContainerAndOffsetFromLocation(t[0]),h=d(t)?A:null!=(f=this.findContainerAndOffsetFromLocation(t[1]))?f:A,null!=A&&null!=h?((r=document.createRange()).setStart.apply(r,A),r.setEnd.apply(r,h),r):void 0},m.prototype.getLocationAtPoint=function(t){var r,h;return(r=this.createDOMRangeFromPoint(t))&&null!=(h=this.createLocationRangeFromDOMRange(r))?h[0]:void 0},m.prototype.domRangeWithinElement=function(t){return t.collapsed?E(this.element,t.startContainer):E(this.element,t.startContainer)&&E(this.element,t.endContainer)},m}(v.BasicObject)}.call(this),function(){var E,b,y,l,e={}.hasOwnProperty,s=[].slice;y=v.rangeIsCollapsed,l=v.rangesAreEqual,b=v.objectsAreEqual,E=v.getBlockConfig,v.EditorController=function(d){function i(a){var n,p;this.editorElement=a.editorElement,n=a.document,p=a.html,this.selectionManager=new v.SelectionManager(this.editorElement),this.selectionManager.delegate=this,this.composition=new v.Composition,this.composition.delegate=this,this.attachmentManager=new v.AttachmentManager(this.composition.getAttachments()),this.attachmentManager.delegate=this,this.inputController=new(v["Level"+v.config.input.getLevel()+"InputController"])(this.editorElement),this.inputController.delegate=this,this.inputController.responder=this.composition,this.compositionController=new v.CompositionController(this.editorElement,this.composition),this.compositionController.delegate=this,this.toolbarController=new v.ToolbarController(this.editorElement.toolbarElement),this.toolbarController.delegate=this,this.editor=new v.Editor(this.composition,this.selectionManager,this.editorElement),null!=n?this.editor.loadDocument(n):this.editor.loadHTML(p)}var c;return function(d,i){function c(){this.constructor=d}for(var a in i)e.call(i,a)&&(d[a]=i[a]);c.prototype=i.prototype,d.prototype=new c,d.__super__=i.prototype}(i,d),i.prototype.registerSelectionManager=function(){return v.selectionChangeObserver.registerSelectionManager(this.selectionManager)},i.prototype.unregisterSelectionManager=function(){return v.selectionChangeObserver.unregisterSelectionManager(this.selectionManager)},i.prototype.render=function(){return this.compositionController.render()},i.prototype.reparse=function(){return this.composition.replaceHTML(this.editorElement.innerHTML)},i.prototype.compositionDidChangeDocument=function(){return this.notifyEditorElement("document-change"),this.handlingInput?void 0:this.render()},i.prototype.compositionDidChangeCurrentAttributes=function(a){return this.currentAttributes=a,this.toolbarController.updateAttributes(this.currentAttributes),this.updateCurrentActions(),this.notifyEditorElement("attributes-change",{attributes:this.currentAttributes})},i.prototype.compositionDidPerformInsertionAtRange=function(a){return this.pasting?this.pastedRange=a:void 0},i.prototype.compositionShouldAcceptFile=function(a){return this.notifyEditorElement("file-accept",{file:a})},i.prototype.compositionDidAddAttachment=function(a){var n;return n=this.attachmentManager.manageAttachment(a),this.notifyEditorElement("attachment-add",{attachment:n})},i.prototype.compositionDidEditAttachment=function(a){var n;return this.compositionController.rerenderViewForObject(a),n=this.attachmentManager.manageAttachment(a),this.notifyEditorElement("attachment-edit",{attachment:n}),this.notifyEditorElement("change")},i.prototype.compositionDidChangeAttachmentPreviewURL=function(a){return this.compositionController.invalidateViewForObject(a),this.notifyEditorElement("change")},i.prototype.compositionDidRemoveAttachment=function(a){var n;return n=this.attachmentManager.unmanageAttachment(a),this.notifyEditorElement("attachment-remove",{attachment:n})},i.prototype.compositionDidStartEditingAttachment=function(a,n){return this.attachmentLocationRange=this.composition.document.getLocationRangeOfAttachment(a),this.compositionController.installAttachmentEditorForAttachment(a,n),this.selectionManager.setLocationRange(this.attachmentLocationRange)},i.prototype.compositionDidStopEditingAttachment=function(){return this.compositionController.uninstallAttachmentEditor(),this.attachmentLocationRange=null},i.prototype.compositionDidRequestChangingSelectionToLocationRange=function(a){return!this.loadingSnapshot||this.isFocused()?(this.requestedLocationRange=a,this.compositionRevisionWhenLocationRangeRequested=this.composition.revision,this.handlingInput?void 0:this.render()):void 0},i.prototype.compositionWillLoadSnapshot=function(){return this.loadingSnapshot=!0},i.prototype.compositionDidLoadSnapshot=function(){return this.compositionController.refreshViewCache(),this.render(),this.loadingSnapshot=!1},i.prototype.getSelectionManager=function(){return this.selectionManager},i.proxyMethod("getSelectionManager().setLocationRange"),i.proxyMethod("getSelectionManager().getLocationRange"),i.prototype.attachmentManagerDidRequestRemovalOfAttachment=function(a){return this.removeAttachment(a)},i.prototype.compositionControllerWillSyncDocumentView=function(){return this.inputController.editorWillSyncDocumentView(),this.selectionManager.lock(),this.selectionManager.clearSelection()},i.prototype.compositionControllerDidSyncDocumentView=function(){return this.inputController.editorDidSyncDocumentView(),this.selectionManager.unlock(),this.updateCurrentActions(),this.notifyEditorElement("sync")},i.prototype.compositionControllerDidRender=function(){return null!=this.requestedLocationRange&&(this.compositionRevisionWhenLocationRangeRequested===this.composition.revision&&this.selectionManager.setLocationRange(this.requestedLocationRange),this.requestedLocationRange=null,this.compositionRevisionWhenLocationRangeRequested=null),this.renderedCompositionRevision!==this.composition.revision&&(this.runEditorFilters(),this.composition.updateCurrentAttributes(),this.notifyEditorElement("render")),this.renderedCompositionRevision=this.composition.revision},i.prototype.compositionControllerDidFocus=function(){return this.isFocusedInvisibly()&&this.setLocationRange({index:0,offset:0}),this.toolbarController.hideDialog(),this.notifyEditorElement("focus")},i.prototype.compositionControllerDidBlur=function(){return this.notifyEditorElement("blur")},i.prototype.compositionControllerDidSelectAttachment=function(a,n){return this.toolbarController.hideDialog(),this.composition.editAttachment(a,n)},i.prototype.compositionControllerDidRequestDeselectingAttachment=function(a){var n,p;return n=null!=(p=this.attachmentLocationRange)?p:this.composition.document.getLocationRangeOfAttachment(a),this.selectionManager.setLocationRange(n[1])},i.prototype.compositionControllerWillUpdateAttachment=function(a){return this.editor.recordUndoEntry("Edit Attachment",{context:a.id,consolidatable:!0})},i.prototype.compositionControllerDidRequestRemovalOfAttachment=function(a){return this.removeAttachment(a)},i.prototype.inputControllerWillHandleInput=function(){return this.handlingInput=!0,this.requestedRender=!1},i.prototype.inputControllerDidRequestRender=function(){return this.requestedRender=!0},i.prototype.inputControllerDidHandleInput=function(){return this.handlingInput=!1,this.requestedRender?(this.requestedRender=!1,this.render()):void 0},i.prototype.inputControllerDidAllowUnhandledInput=function(){return this.notifyEditorElement("change")},i.prototype.inputControllerDidRequestReparse=function(){return this.reparse()},i.prototype.inputControllerWillPerformTyping=function(){return this.recordTypingUndoEntry()},i.prototype.inputControllerWillPerformFormatting=function(a){return this.recordFormattingUndoEntry(a)},i.prototype.inputControllerWillCutText=function(){return this.editor.recordUndoEntry("Cut")},i.prototype.inputControllerWillPaste=function(a){return this.editor.recordUndoEntry("Paste"),this.pasting=!0,this.notifyEditorElement("before-paste",{paste:a})},i.prototype.inputControllerDidPaste=function(a){return a.range=this.pastedRange,this.pastedRange=null,this.pasting=null,this.notifyEditorElement("paste",{paste:a})},i.prototype.inputControllerWillMoveText=function(){return this.editor.recordUndoEntry("Move")},i.prototype.inputControllerWillAttachFiles=function(){return this.editor.recordUndoEntry("Drop Files")},i.prototype.inputControllerWillPerformUndo=function(){return this.editor.undo()},i.prototype.inputControllerWillPerformRedo=function(){return this.editor.redo()},i.prototype.inputControllerDidReceiveKeyboardCommand=function(a){return this.toolbarController.applyKeyboardCommand(a)},i.prototype.inputControllerDidStartDrag=function(){return this.locationRangeBeforeDrag=this.selectionManager.getLocationRange()},i.prototype.inputControllerDidReceiveDragOverPoint=function(a){return this.selectionManager.setLocationRangeFromPointRange(a)},i.prototype.inputControllerDidCancelDrag=function(){return this.selectionManager.setLocationRange(this.locationRangeBeforeDrag),this.locationRangeBeforeDrag=null},i.prototype.locationRangeDidChange=function(a){return this.composition.updateCurrentAttributes(),this.updateCurrentActions(),this.attachmentLocationRange&&!l(this.attachmentLocationRange,a)&&this.composition.stopEditingAttachment(),this.notifyEditorElement("selection-change")},i.prototype.toolbarDidClickButton=function(){return this.getLocationRange()?void 0:this.setLocationRange({index:0,offset:0})},i.prototype.toolbarDidInvokeAction=function(a){return this.invokeAction(a)},i.prototype.toolbarDidToggleAttribute=function(a){return this.recordFormattingUndoEntry(a),this.composition.toggleCurrentAttribute(a),this.render(),this.selectionFrozen?void 0:this.editorElement.focus()},i.prototype.toolbarDidUpdateAttribute=function(a,n){return this.recordFormattingUndoEntry(a),this.composition.setCurrentAttribute(a,n),this.render(),this.selectionFrozen?void 0:this.editorElement.focus()},i.prototype.toolbarDidRemoveAttribute=function(a){return this.recordFormattingUndoEntry(a),this.composition.removeCurrentAttribute(a),this.render(),this.selectionFrozen?void 0:this.editorElement.focus()},i.prototype.toolbarWillShowDialog=function(){return this.composition.expandSelectionForEditing(),this.freezeSelection()},i.prototype.toolbarDidShowDialog=function(a){return this.notifyEditorElement("toolbar-dialog-show",{dialogName:a})},i.prototype.toolbarDidHideDialog=function(a){return this.thawSelection(),this.editorElement.focus(),this.notifyEditorElement("toolbar-dialog-hide",{dialogName:a})},i.prototype.freezeSelection=function(){return this.selectionFrozen?void 0:(this.selectionManager.lock(),this.composition.freezeSelection(),this.selectionFrozen=!0,this.render())},i.prototype.thawSelection=function(){return this.selectionFrozen?(this.composition.thawSelection(),this.selectionManager.unlock(),this.selectionFrozen=!1,this.render()):void 0},i.prototype.actions={undo:{test:function(){return this.editor.canUndo()},perform:function(){return this.editor.undo()}},redo:{test:function(){return this.editor.canRedo()},perform:function(){return this.editor.redo()}},link:{test:function(){return this.editor.canActivateAttribute("href")}},increaseNestingLevel:{test:function(){return this.editor.canIncreaseNestingLevel()},perform:function(){return this.editor.increaseNestingLevel()&&this.render()}},decreaseNestingLevel:{test:function(){return this.editor.canDecreaseNestingLevel()},perform:function(){return this.editor.decreaseNestingLevel()&&this.render()}},attachFiles:{test:function(){return!0},perform:function(){return v.config.input.pickFiles(this.editor.insertFiles)}}},i.prototype.canInvokeAction=function(a){var n,p;return!!this.actionIsExternal(a)||!!(null!=(n=this.actions[a])&&null!=(p=n.test)?p.call(this):void 0)},i.prototype.invokeAction=function(a){var n,p;return this.actionIsExternal(a)?this.notifyEditorElement("action-invoke",{actionName:a}):null!=(n=this.actions[a])&&null!=(p=n.perform)?p.call(this):void 0},i.prototype.actionIsExternal=function(a){return/^x-./.test(a)},i.prototype.getCurrentActions=function(){var a,n;for(a in n={},this.actions)n[a]=this.canInvokeAction(a);return n},i.prototype.updateCurrentActions=function(){var a;return a=this.getCurrentActions(),b(a,this.currentActions)?void 0:(this.currentActions=a,this.toolbarController.updateActions(this.currentActions),this.notifyEditorElement("actions-change",{actions:this.currentActions}))},i.prototype.runEditorFilters=function(){var a,p,u,m,t,r,h;for(h=this.composition.getSnapshot(),p=0,u=(m=this.editor.filters).length;u>p;p++)a=h.document,r=h.selectedRange,null==(h=null!=(t=m[p].call(this.editor,h))?t:{}).document&&(h.document=a),null==h.selectedRange&&(h.selectedRange=r);return c(h,this.composition.getSnapshot())?void 0:this.composition.loadSnapshot(h)},c=function(a,n){return l(a.selectedRange,n.selectedRange)&&a.document.isEqualTo(n.document)},i.prototype.updateInputElement=function(){var a,n;return a=this.compositionController.getSerializableElement(),n=v.serializeToContentType(a,"text/html"),this.editorElement.setInputElementValue(n)},i.prototype.notifyEditorElement=function(a,n){switch(a){case"document-change":this.documentChangedSinceLastRender=!0;break;case"render":this.documentChangedSinceLastRender&&(this.documentChangedSinceLastRender=!1,this.notifyEditorElement("change"));break;case"change":case"attachment-add":case"attachment-edit":case"attachment-remove":this.updateInputElement()}return this.editorElement.notify(a,n)},i.prototype.removeAttachment=function(a){return this.editor.recordUndoEntry("Delete Attachment"),this.composition.removeAttachment(a),this.render()},i.prototype.recordFormattingUndoEntry=function(a){var n,p;return n=E(a),p=this.selectionManager.getLocationRange(),n||!y(p)?this.editor.recordUndoEntry("Formatting",{context:this.getUndoContext(),consolidatable:!0}):void 0},i.prototype.recordTypingUndoEntry=function(){return this.editor.recordUndoEntry("Typing",{context:this.getUndoContext(this.currentAttributes),consolidatable:!0})},i.prototype.getUndoContext=function(){var a;return a=1<=arguments.length?s.call(arguments,0):[],[this.getLocationContext(),this.getTimeContext()].concat(s.call(a))},i.prototype.getLocationContext=function(){var a;return a=this.selectionManager.getLocationRange(),y(a)?a[0].index:a},i.prototype.getTimeContext=function(){return v.config.undoInterval>0?Math.floor((new Date).getTime()/v.config.undoInterval):0},i.prototype.isFocused=function(){var a;return this.editorElement===(null!=(a=this.editorElement.ownerDocument)?a.activeElement:void 0)},i.prototype.isFocusedInvisibly=function(){return this.isFocused()&&!this.getLocationRange()},i}(v.Controller)}.call(this),function(){var E,y,l,o,e,s,i,c,a,n,p,u,m,t,r,d=[].indexOf||function(i){for(var c=0,a=this.length;a>c;c++)if(c in this&&this[c]===i)return c;return-1};e=v.makeElement,s=v.triggerEvent,l=v.handleEvent,o=v.handleEventOnce,y=v.findClosestElementFromNode,v.registerElement("trix-editor",(m=0,c=function(h){return!document.querySelector(":focus")&&h.hasAttribute("autofocus")&&document.querySelector("[autofocus]")===h?h.focus():void 0},t=function(h){return h.hasAttribute("contenteditable")?void 0:(h.setAttribute("contenteditable",""),o("focus",{onElement:h,withCallback:function(){return a(h)}}))},a=function(h){return p(h),r(h)},p=function(h){return("function"==typeof document.queryCommandSupported?document.queryCommandSupported("enableObjectResizing"):void 0)?(document.execCommand("enableObjectResizing",!1,!1),l("mscontrolselect",{onElement:h,preventDefault:!0})):void 0},r=function(){var h;return!("function"==typeof document.queryCommandSupported?document.queryCommandSupported("DefaultParagraphSeparator"):void 0)||"div"!==(h=v.config.blockAttributes.default.tagName)&&"p"!==h?void 0:document.execCommand("DefaultParagraphSeparator",!1,h)},i=function(h){return h.hasAttribute("role")?void 0:h.setAttribute("role","textbox")},u=function(h){var A;if(!h.hasAttribute("aria-label")&&!h.hasAttribute("aria-labelledby"))return(A=function(){var f,g;return(g=function(){var k,O,j,L;for(L=[],k=0,O=(j=h.labels).length;O>k;k++)(f=j[k]).contains(h)||L.push(f.textContent);return L}().join(" "))?h.setAttribute("aria-label",g):h.removeAttribute("aria-label")})(),l("focus",{onElement:h,withCallback:A})},{defaultCSS:"%t {\n  display: block;\n}\n\n%t:empty:not(:focus)::before {\n  content: attr(placeholder);\n  color: graytext;\n  cursor: text;\n  pointer-events: none;\n}\n\n%t a[contenteditable=false] {\n  cursor: text;\n}\n\n%t img {\n  max-width: 100%;\n  height: auto;\n}\n\n%t "+(E=v.AttachmentView.attachmentSelector)+" figcaption textarea {\n  resize: none;\n}\n\n%t "+E+" figcaption textarea.trix-autoresize-clone {\n  position: absolute;\n  left: -9999px;\n  max-height: 0px;\n}\n\n%t "+E+" figcaption[data-trix-placeholder]:empty::before {\n  content: attr(data-trix-placeholder);\n  color: graytext;\n}\n\n%t [data-trix-cursor-target] {\n  display: "+(n=v.browser.forcesObjectResizing?{display:"inline",width:"auto"}:{display:"inline-block",width:"1px"}).display+" !important;\n  width: "+n.width+" !important;\n  padding: 0 !important;\n  margin: 0 !important;\n  border: none !important;\n}\n\n%t [data-trix-cursor-target=left] {\n  vertical-align: top !important;\n  margin-left: -1px !important;\n}\n\n%t [data-trix-cursor-target=right] {\n  vertical-align: bottom !important;\n  margin-right: -1px !important;\n}",trixId:{get:function(){return this.hasAttribute("trix-id")?this.getAttribute("trix-id"):(this.setAttribute("trix-id",++m),this.trixId)}},labels:{get:function(){var h,A,f;return A=[],this.id&&this.ownerDocument&&A.push.apply(A,this.ownerDocument.querySelectorAll("label[for='"+this.id+"']")),(h=y(this,{matchingSelector:"label"}))&&((f=h.control)===this||null===f)&&A.push(h),A}},toolbarElement:{get:function(){var h,A,f;return this.hasAttribute("toolbar")?null!=(A=this.ownerDocument)?A.getElementById(this.getAttribute("toolbar")):void 0:this.parentNode?(this.setAttribute("toolbar",f="trix-toolbar-"+this.trixId),h=e("trix-toolbar",{id:f}),this.parentNode.insertBefore(h,this),h):void 0}},inputElement:{get:function(){var h,A,f;return this.hasAttribute("input")?null!=(f=this.ownerDocument)?f.getElementById(this.getAttribute("input")):void 0:this.parentNode?(this.setAttribute("input",A="trix-input-"+this.trixId),h=e("input",{type:"hidden",id:A}),this.parentNode.insertBefore(h,this.nextElementSibling),h):void 0}},editor:{get:function(){var h;return null!=(h=this.editorController)?h.editor:void 0}},name:{get:function(){var h;return null!=(h=this.inputElement)?h.name:void 0}},value:{get:function(){var h;return null!=(h=this.inputElement)?h.value:void 0},set:function(h){var A;return this.defaultValue=h,null!=(A=this.editor)?A.loadHTML(this.defaultValue):void 0}},notify:function(h,A){return this.editorController?s("trix-"+h,{onElement:this,attributes:A}):void 0},setInputElementValue:function(h){var A;return null!=(A=this.inputElement)?A.value=h:void 0},initialize:function(){return this.hasAttribute("data-trix-internal")?void 0:(t(this),i(this),u(this))},connect:function(){return this.hasAttribute("data-trix-internal")?void 0:(this.editorController||(s("trix-before-initialize",{onElement:this}),this.editorController=new v.EditorController({editorElement:this,html:this.defaultValue=this.value}),requestAnimationFrame((h=this,function(){return s("trix-initialize",{onElement:h})}))),this.editorController.registerSelectionManager(),this.registerResetListener(),this.registerClickListener(),c(this));var h},disconnect:function(){var h;return null!=(h=this.editorController)&&h.unregisterSelectionManager(),this.unregisterResetListener(),this.unregisterClickListener()},registerResetListener:function(){return this.resetListener=this.resetBubbled.bind(this),window.addEventListener("reset",this.resetListener,!1)},unregisterResetListener:function(){return window.removeEventListener("reset",this.resetListener,!1)},registerClickListener:function(){return this.clickListener=this.clickBubbled.bind(this),window.addEventListener("click",this.clickListener,!1)},unregisterClickListener:function(){return window.removeEventListener("click",this.clickListener,!1)},resetBubbled:function(h){var A;if(!h.defaultPrevented&&h.target===(null!=(A=this.inputElement)?A.form:void 0))return this.reset()},clickBubbled:function(h){var A;if(!(h.defaultPrevented||this.contains(h.target)||!(A=y(h.target,{matchingSelector:"label"}))||d.call(this.labels,A)<0))return this.focus()},reset:function(){return this.value=this.defaultValue}}))}.call(this),function(){}.call(this)}).call(this),Ut.exports?Ut.exports=v:void 0!==(ve="function"==typeof(he=v)?he.call(zt,Yt,zt,Ut):he)&&(Ut.exports=ve)}.call(this)},609:function(Ut,zt,Yt){"use strict";var he,ve,Kt=this&&this.__spreadArray||function(v,E,b){if(b||2===arguments.length)for(var o,y=0,l=E.length;y<l;y++)(o||!(y in E))&&(o||(o=Array.prototype.slice.call(E,0,y)),o[y]=E[y]);return v.concat(o||Array.prototype.slice.call(E))};he=function(){!function(_){var S=_.performance;function D(G){S&&S.mark&&S.mark(G)}function N(G,I){S&&S.measure&&S.measure(G,I)}D("Zone");var W=_.__Zone_symbol_prefix||"__zone_symbol__";function V(G){return W+G}var z=!0===_[V("forceDuplicateZoneCheck")];if(_.Zone){if(z||"function"!=typeof _.Zone.__symbol__)throw new Error("Zone already loaded.");return _.Zone}var K=function(){function G(I,M){this._parent=I,this._name=M?M.name||"unnamed":"<root>",this._properties=M&&M.properties||{},this._zoneDelegate=new et(this,this._parent&&this._parent._zoneDelegate,M)}return G.assertZonePatched=function(){if(_.Promise!==lt.ZoneAwarePromise)throw new Error("Zone.js has detected that ZoneAwarePromise `(window|global).Promise` has been overwritten.\nMost likely cause is that a Promise polyfill has been loaded after Zone.js (Polyfilling Promise api is not necessary when zone.js is loaded. If you must load one, do so before loading zone.js.)")},Object.defineProperty(G,"root",{get:function(){for(var I=G.current;I.parent;)I=I.parent;return I},enumerable:!1,configurable:!0}),Object.defineProperty(G,"current",{get:function(){return Nt.zone},enumerable:!1,configurable:!0}),Object.defineProperty(G,"currentTask",{get:function(){return le},enumerable:!1,configurable:!0}),G.__load_patch=function(I,M,F){if(void 0===F&&(F=!1),lt.hasOwnProperty(I)){if(!F&&z)throw Error("Already loaded patch: "+I)}else if(!_["__Zone_disable_"+I]){var st="Zone:"+I;D(st),lt[I]=M(_,G,Mt),N(st,st)}},Object.defineProperty(G.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),G.prototype.get=function(I){var M=this.getZoneWith(I);if(M)return M._properties[I]},G.prototype.getZoneWith=function(I){for(var M=this;M;){if(M._properties.hasOwnProperty(I))return M;M=M._parent}return null},G.prototype.fork=function(I){if(!I)throw new Error("ZoneSpec required!");return this._zoneDelegate.fork(this,I)},G.prototype.wrap=function(I,M){if("function"!=typeof I)throw new Error("Expecting function got: "+I);var F=this._zoneDelegate.intercept(this,I,M),st=this;return function(){return st.runGuarded(F,this,arguments,M)}},G.prototype.run=function(I,M,F,st){Nt={parent:Nt,zone:this};try{return this._zoneDelegate.invoke(this,I,M,F,st)}finally{Nt=Nt.parent}},G.prototype.runGuarded=function(I,M,F,st){void 0===M&&(M=null),Nt={parent:Nt,zone:this};try{try{return this._zoneDelegate.invoke(this,I,M,F,st)}catch(Ft){if(this._zoneDelegate.handleError(this,Ft))throw Ft}}finally{Nt=Nt.parent}},G.prototype.runTask=function(I,M,F){if(I.zone!=this)throw new Error("A task can only be run in the zone of creation! (Creation: "+(I.zone||it).name+"; Execution: "+this.name+")");if(I.state!==Pt||I.type!==Et&&I.type!==ct){var st=I.state!=Rt;st&&I._transitionTo(Rt,St),I.runCount++;var Ft=le;le=I,Nt={parent:Nt,zone:this};try{I.type==ct&&I.data&&!I.data.isPeriodic&&(I.cancelFn=void 0);try{return this._zoneDelegate.invokeTask(this,I,M,F)}catch(ge){if(this._zoneDelegate.handleError(this,ge))throw ge}}finally{I.state!==Pt&&I.state!==It&&(I.type==Et||I.data&&I.data.isPeriodic?st&&I._transitionTo(St,Rt):(I.runCount=0,this._updateTaskCount(I,-1),st&&I._transitionTo(Pt,Rt,Pt))),Nt=Nt.parent,le=Ft}}},G.prototype.scheduleTask=function(I){if(I.zone&&I.zone!==this)for(var M=this;M;){if(M===I.zone)throw Error("can not reschedule task to ".concat(this.name," which is descendants of the original zone ").concat(I.zone.name));M=M.parent}I._transitionTo(kt,Pt);var F=[];I._zoneDelegates=F,I._zone=this;try{I=this._zoneDelegate.scheduleTask(this,I)}catch(st){throw I._transitionTo(It,kt,Pt),this._zoneDelegate.handleError(this,st),st}return I._zoneDelegates===F&&this._updateTaskCount(I,1),I.state==kt&&I._transitionTo(St,kt),I},G.prototype.scheduleMicroTask=function(I,M,F,st){return this.scheduleTask(new Y(vt,I,M,F,st,void 0))},G.prototype.scheduleMacroTask=function(I,M,F,st,Ft){return this.scheduleTask(new Y(ct,I,M,F,st,Ft))},G.prototype.scheduleEventTask=function(I,M,F,st,Ft){return this.scheduleTask(new Y(Et,I,M,F,st,Ft))},G.prototype.cancelTask=function(I){if(I.zone!=this)throw new Error("A task can only be cancelled in the zone of creation! (Creation: "+(I.zone||it).name+"; Execution: "+this.name+")");I._transitionTo(at,St,Rt);try{this._zoneDelegate.cancelTask(this,I)}catch(M){throw I._transitionTo(It,at),this._zoneDelegate.handleError(this,M),M}return this._updateTaskCount(I,-1),I._transitionTo(Pt,at),I.runCount=0,I},G.prototype._updateTaskCount=function(I,M){var F=I._zoneDelegates;-1==M&&(I._zoneDelegates=null);for(var st=0;st<F.length;st++)F[st]._updateTaskCount(I.type,M)},G}();K.__symbol__=V;var Gt,$={name:"",onHasTask:function(G,I,M,F){return G.hasTask(M,F)},onScheduleTask:function(G,I,M,F){return G.scheduleTask(M,F)},onInvokeTask:function(G,I,M,F,st,Ft){return G.invokeTask(M,F,st,Ft)},onCancelTask:function(G,I,M,F){return G.cancelTask(M,F)}},et=function(){function G(I,M,F){this._taskCounts={microTask:0,macroTask:0,eventTask:0},this.zone=I,this._parentDelegate=M,this._forkZS=F&&(F&&F.onFork?F:M._forkZS),this._forkDlgt=F&&(F.onFork?M:M._forkDlgt),this._forkCurrZone=F&&(F.onFork?this.zone:M._forkCurrZone),this._interceptZS=F&&(F.onIntercept?F:M._interceptZS),this._interceptDlgt=F&&(F.onIntercept?M:M._interceptDlgt),this._interceptCurrZone=F&&(F.onIntercept?this.zone:M._interceptCurrZone),this._invokeZS=F&&(F.onInvoke?F:M._invokeZS),this._invokeDlgt=F&&(F.onInvoke?M:M._invokeDlgt),this._invokeCurrZone=F&&(F.onInvoke?this.zone:M._invokeCurrZone),this._handleErrorZS=F&&(F.onHandleError?F:M._handleErrorZS),this._handleErrorDlgt=F&&(F.onHandleError?M:M._handleErrorDlgt),this._handleErrorCurrZone=F&&(F.onHandleError?this.zone:M._handleErrorCurrZone),this._scheduleTaskZS=F&&(F.onScheduleTask?F:M._scheduleTaskZS),this._scheduleTaskDlgt=F&&(F.onScheduleTask?M:M._scheduleTaskDlgt),this._scheduleTaskCurrZone=F&&(F.onScheduleTask?this.zone:M._scheduleTaskCurrZone),this._invokeTaskZS=F&&(F.onInvokeTask?F:M._invokeTaskZS),this._invokeTaskDlgt=F&&(F.onInvokeTask?M:M._invokeTaskDlgt),this._invokeTaskCurrZone=F&&(F.onInvokeTask?this.zone:M._invokeTaskCurrZone),this._cancelTaskZS=F&&(F.onCancelTask?F:M._cancelTaskZS),this._cancelTaskDlgt=F&&(F.onCancelTask?M:M._cancelTaskDlgt),this._cancelTaskCurrZone=F&&(F.onCancelTask?this.zone:M._cancelTaskCurrZone),this._hasTaskZS=null,this._hasTaskDlgt=null,this._hasTaskDlgtOwner=null,this._hasTaskCurrZone=null;var st=F&&F.onHasTask;(st||M&&M._hasTaskZS)&&(this._hasTaskZS=st?F:$,this._hasTaskDlgt=M,this._hasTaskDlgtOwner=this,this._hasTaskCurrZone=I,F.onScheduleTask||(this._scheduleTaskZS=$,this._scheduleTaskDlgt=M,this._scheduleTaskCurrZone=this.zone),F.onInvokeTask||(this._invokeTaskZS=$,this._invokeTaskDlgt=M,this._invokeTaskCurrZone=this.zone),F.onCancelTask||(this._cancelTaskZS=$,this._cancelTaskDlgt=M,this._cancelTaskCurrZone=this.zone))}return G.prototype.fork=function(I,M){return this._forkZS?this._forkZS.onFork(this._forkDlgt,this.zone,I,M):new K(I,M)},G.prototype.intercept=function(I,M,F){return this._interceptZS?this._interceptZS.onIntercept(this._interceptDlgt,this._interceptCurrZone,I,M,F):M},G.prototype.invoke=function(I,M,F,st,Ft){return this._invokeZS?this._invokeZS.onInvoke(this._invokeDlgt,this._invokeCurrZone,I,M,F,st,Ft):M.apply(F,st)},G.prototype.handleError=function(I,M){return!this._handleErrorZS||this._handleErrorZS.onHandleError(this._handleErrorDlgt,this._handleErrorCurrZone,I,M)},G.prototype.scheduleTask=function(I,M){var F=M;if(this._scheduleTaskZS)this._hasTaskZS&&F._zoneDelegates.push(this._hasTaskDlgtOwner),(F=this._scheduleTaskZS.onScheduleTask(this._scheduleTaskDlgt,this._scheduleTaskCurrZone,I,M))||(F=M);else if(M.scheduleFn)M.scheduleFn(M);else{if(M.type!=vt)throw new Error("Task is missing scheduleFn.");Vt(M)}return F},G.prototype.invokeTask=function(I,M,F,st){return this._invokeTaskZS?this._invokeTaskZS.onInvokeTask(this._invokeTaskDlgt,this._invokeTaskCurrZone,I,M,F,st):M.callback.apply(F,st)},G.prototype.cancelTask=function(I,M){var F;if(this._cancelTaskZS)F=this._cancelTaskZS.onCancelTask(this._cancelTaskDlgt,this._cancelTaskCurrZone,I,M);else{if(!M.cancelFn)throw Error("Task is not cancelable");F=M.cancelFn(M)}return F},G.prototype.hasTask=function(I,M){try{this._hasTaskZS&&this._hasTaskZS.onHasTask(this._hasTaskDlgt,this._hasTaskCurrZone,I,M)}catch(F){this.handleError(I,F)}},G.prototype._updateTaskCount=function(I,M){var F=this._taskCounts,st=F[I],Ft=F[I]=st+M;if(Ft<0)throw new Error("More tasks executed then were scheduled.");0!=st&&0!=Ft||this.hasTask(this.zone,{microTask:F.microTask>0,macroTask:F.macroTask>0,eventTask:F.eventTask>0,change:I})},G}(),Y=function(){function G(I,M,F,st,Ft,ge){if(this._zone=null,this.runCount=0,this._zoneDelegates=null,this._state="notScheduled",this.type=I,this.source=M,this.data=st,this.scheduleFn=Ft,this.cancelFn=ge,!F)throw new Error("callback is not defined");this.callback=F;var U=this;this.invoke=I===Et&&st&&st.useG?G.invokeTask:function(){return G.invokeTask.call(_,U,this,arguments)}}return G.invokeTask=function(I,M,F){I||(I=this),Ht++;try{return I.runCount++,I.zone.runTask(I,M,F)}finally{1==Ht&&Ct(),Ht--}},Object.defineProperty(G.prototype,"zone",{get:function(){return this._zone},enumerable:!1,configurable:!0}),Object.defineProperty(G.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),G.prototype.cancelScheduleRequest=function(){this._transitionTo(Pt,kt)},G.prototype._transitionTo=function(I,M,F){if(this._state!==M&&this._state!==F)throw new Error("".concat(this.type," '").concat(this.source,"': can not transition to '").concat(I,"', expecting state '").concat(M,"'").concat(F?" or '"+F+"'":"",", was '").concat(this._state,"'."));this._state=I,I==Pt&&(this._zoneDelegates=null)},G.prototype.toString=function(){return this.data&&void 0!==this.data.handleId?this.data.handleId.toString():Object.prototype.toString.call(this)},G.prototype.toJSON=function(){return{type:this.type,state:this.state,source:this.source,zone:this.zone.name,runCount:this.runCount}},G}(),rt=V("setTimeout"),nt=V("Promise"),dt=V("then"),gt=[],Tt=!1;function Lt(G){if(Gt||_[nt]&&(Gt=_[nt].resolve(0)),Gt){var I=Gt[dt];I||(I=Gt.then),I.call(Gt,G)}else _[rt](G,0)}function Vt(G){0===Ht&&0===gt.length&&Lt(Ct),G&&gt.push(G)}function Ct(){if(!Tt){for(Tt=!0;gt.length;){var G=gt;gt=[];for(var I=0;I<G.length;I++){var M=G[I];try{M.zone.runTask(M,null,null)}catch(F){Mt.onUnhandledError(F)}}}Mt.microtaskDrainDone(),Tt=!1}}var it={name:"NO ZONE"},Pt="notScheduled",kt="scheduling",St="scheduled",Rt="running",at="canceling",It="unknown",vt="microTask",ct="macroTask",Et="eventTask",lt={},Mt={symbol:V,currentZoneFrame:function(){return Nt},onUnhandledError:Bt,microtaskDrainDone:Bt,scheduleMicroTask:Vt,showUncaughtError:function(){return!K[V("ignoreConsoleErrorUncaughtError")]},patchEventTarget:function(){return[]},patchOnProperties:Bt,patchMethod:function(){return Bt},bindArguments:function(){return[]},patchThen:function(){return Bt},patchMacroTask:function(){return Bt},patchEventPrototype:function(){return Bt},isIEOrEdge:function(){return!1},getGlobalObjects:function(){},ObjectDefineProperty:function(){return Bt},ObjectGetOwnPropertyDescriptor:function(){},ObjectCreate:function(){},ArraySlice:function(){return[]},patchClass:function(){return Bt},wrapWithCurrentZone:function(){return Bt},filterProperties:function(){return[]},attachOriginToPatched:function(){return Bt},_redefineProperty:function(){return Bt},patchCallbacks:function(){return Bt},nativeScheduleMicroTask:Lt},Nt={parent:null,zone:new K(null,null)},le=null,Ht=0;function Bt(){}N("Zone","Zone"),_.Zone=K}("undefined"!=typeof window&&window||"undefined"!=typeof self&&self||global);var v=Object.getOwnPropertyDescriptor,E=Object.defineProperty,b=Object.getPrototypeOf,y=Object.create,l=Array.prototype.slice,o="addEventListener",e="removeEventListener",s=Zone.__symbol__(o),d=Zone.__symbol__(e),i="true",c="false",a=Zone.__symbol__("");function n(_,S){return Zone.current.wrap(_,S)}function p(_,S,D,N,W){return Zone.current.scheduleMacroTask(_,S,D,N,W)}var u=Zone.__symbol__,m="undefined"!=typeof window,t=m?window:void 0,r=m&&t||"object"==typeof self&&self||global;function A(_,S){for(var D=_.length-1;D>=0;D--)"function"==typeof _[D]&&(_[D]=n(_[D],S+"_"+D));return _}function g(_){return!_||!1!==_.writable&&!("function"==typeof _.get&&void 0===_.set)}var w="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope,k=!("nw"in r)&&void 0!==r.process&&"[object process]"==={}.toString.call(r.process),O=!k&&!w&&!(!m||!t.HTMLElement),j=void 0!==r.process&&"[object process]"==={}.toString.call(r.process)&&!w&&!(!m||!t.HTMLElement),L={},R=function(_){if(_=_||r.event){var S=L[_.type];S||(S=L[_.type]=u("ON_PROPERTY"+_.type));var W,D=this||_.target||r,N=D[S];return O&&D===t&&"error"===_.type?!0===(W=N&&N.call(this,_.message,_.filename,_.lineno,_.colno,_.error))&&_.preventDefault():null!=(W=N&&N.apply(this,arguments))&&!W&&_.preventDefault(),W}};function T(_,S,D){var N=v(_,S);if(!N&&D&&v(D,S)&&(N={enumerable:!0,configurable:!0}),N&&N.configurable){var V=u("on"+S+"patched");if(!_.hasOwnProperty(V)||!_[V]){delete N.writable,delete N.value;var z=N.get,K=N.set,$=S.substr(2),et=L[$];et||(et=L[$]=u("ON_PROPERTY"+$)),N.set=function(Y){var rt=this;!rt&&_===r&&(rt=r),rt&&("function"==typeof rt[et]&&rt.removeEventListener($,R),K&&K.call(rt,null),rt[et]=Y,"function"==typeof Y&&rt.addEventListener($,R,!1))},N.get=function(){var Y=this;if(!Y&&_===r&&(Y=r),!Y)return null;var rt=Y[et];if(rt)return rt;if(z){var nt=z.call(this);if(nt)return N.set.call(this,nt),"function"==typeof Y.removeAttribute&&Y.removeAttribute(S),nt}return null},E(_,S,N),_[V]=!0}}}function C(_,S,D){if(S)for(var N=0;N<S.length;N++)T(_,"on"+S[N],D);else{var W=[];for(var V in _)"on"==V.substr(0,2)&&W.push(V);for(var z=0;z<W.length;z++)T(_,W[z],D)}}var x=u("originalInstance");function B(_){var S=r[_];if(S){r[u(_)]=S,r[_]=function(){var W=A(arguments,_);switch(W.length){case 0:this[x]=new S;break;case 1:this[x]=new S(W[0]);break;case 2:this[x]=new S(W[0],W[1]);break;case 3:this[x]=new S(W[0],W[1],W[2]);break;case 4:this[x]=new S(W[0],W[1],W[2],W[3]);break;default:throw new Error("Arg list too long.")}},At(r[_],S);var N,D=new S(function(){});for(N in D)"XMLHttpRequest"===_&&"responseBlob"===N||function(W){"function"==typeof D[W]?r[_].prototype[W]=function(){return this[x][W].apply(this[x],arguments)}:E(r[_].prototype,W,{set:function(V){"function"==typeof V?(this[x][W]=n(V,_+"."+W),At(this[x][W],V)):this[x][W]=V},get:function(){return this[x][W]}})}(N);for(N in S)"prototype"!==N&&S.hasOwnProperty(N)&&(r[_][N]=S[N])}}function Z(_,S,D){for(var N=_;N&&!N.hasOwnProperty(S);)N=b(N);!N&&_[S]&&(N=_);var W=u(S),V=null;if(N&&(!(V=N[W])||!N.hasOwnProperty(W))&&(V=N[W]=N[S],g(N&&v(N,S)))){var K=D(V,W,S);N[S]=function(){return K(this,arguments)},At(N[S],V)}return V}function ft(_,S,D){var N=null;function W(V){var z=V.data;return z.args[z.cbIdx]=function(){V.invoke.apply(this,arguments)},N.apply(z.target,z.args),V}N=Z(_,S,function(V){return function(z,K){var $=D(z,K);return $.cbIdx>=0&&"function"==typeof K[$.cbIdx]?p($.name,K[$.cbIdx],$,W):V.apply(z,K)}})}function At(_,S){_[u("OriginalDelegate")]=S}var Wt=!1,Dt=!1;function fe(){if(Wt)return Dt;Wt=!0;try{var _=t.navigator.userAgent;(-1!==_.indexOf("MSIE ")||-1!==_.indexOf("Trident/")||-1!==_.indexOf("Edge/"))&&(Dt=!0)}catch(S){}return Dt}Zone.__load_patch("ZoneAwarePromise",function(_,S,D){var N=Object.getOwnPropertyDescriptor,W=Object.defineProperty;var z=D.symbol,K=[],$=!0===_[z("DISABLE_WRAPPING_UNCAUGHT_PROMISE_REJECTION")],et=z("Promise"),Y=z("then");D.onUnhandledError=function(U){if(D.showUncaughtError()){var X=U&&U.rejection;X?console.error("Unhandled Promise rejection:",X instanceof Error?X.message:X,"; Zone:",U.zone.name,"; Task:",U.task&&U.task.source,"; Value:",X,X instanceof Error?X.stack:void 0):console.error(U)}},D.microtaskDrainDone=function(){for(var U=function(){var X=K.shift();try{X.zone.runGuarded(function(){throw X.throwOriginal?X.rejection:X})}catch(J){!function dt(U){D.onUnhandledError(U);try{var X=S[nt];"function"==typeof X&&X.call(this,U)}catch(J){}}(J)}};K.length;)U()};var nt=z("unhandledPromiseRejectionHandler");function gt(U){return U&&U.then}function Tt(U){return U}function Gt(U){return M.reject(U)}var Lt=z("state"),Vt=z("value"),Ct=z("finally"),it=z("parentPromiseValue"),Pt=z("parentPromiseState"),St=null,at=!1;function vt(U,X){return function(J){try{Mt(U,X,J)}catch(H){Mt(U,!1,H)}}}var lt=z("currentTaskTrace");function Mt(U,X,J){var H=function(){var U=!1;return function(J){return function(){U||(U=!0,J.apply(null,arguments))}}}();if(U===J)throw new TypeError("Promise resolved with itself");if(U[Lt]===St){var ot=null;try{("object"==typeof J||"function"==typeof J)&&(ot=J&&J.then)}catch(wt){return H(function(){Mt(U,!1,wt)})(),U}if(X!==at&&J instanceof M&&J.hasOwnProperty(Lt)&&J.hasOwnProperty(Vt)&&J[Lt]!==St)le(J),Mt(U,J[Lt],J[Vt]);else if(X!==at&&"function"==typeof ot)try{ot.call(J,H(vt(U,X)),H(vt(U,!1)))}catch(wt){H(function(){Mt(U,!1,wt)})()}else{U[Lt]=X;var mt=U[Vt];if(U[Vt]=J,U[Ct]===Ct&&true===X&&(U[Lt]=U[Pt],U[Vt]=U[it]),X===at&&J instanceof Error){var ht=S.currentTask&&S.currentTask.data&&S.currentTask.data.__creationTrace__;ht&&W(J,lt,{configurable:!0,enumerable:!1,writable:!0,value:ht})}for(var yt=0;yt<mt.length;)Ht(U,mt[yt++],mt[yt++],mt[yt++],mt[yt++]);if(0==mt.length&&X==at){U[Lt]=0;var bt=J;try{throw new Error("Uncaught (in promise): "+function V(U){return U&&U.toString===Object.prototype.toString?(U.constructor&&U.constructor.name||"")+": "+JSON.stringify(U):U?U.toString():Object.prototype.toString.call(U)}(J)+(J&&J.stack?"\n"+J.stack:""))}catch(wt){bt=wt}$&&(bt.throwOriginal=!0),bt.rejection=J,bt.promise=U,bt.zone=S.current,bt.task=S.currentTask,K.push(bt),D.scheduleMicroTask()}}}return U}var Nt=z("rejectionHandledHandler");function le(U){if(0===U[Lt]){try{var X=S[Nt];X&&"function"==typeof X&&X.call(this,{rejection:U[Vt],promise:U})}catch(H){}U[Lt]=at;for(var J=0;J<K.length;J++)U===K[J].promise&&K.splice(J,1)}}function Ht(U,X,J,H,ot){le(U);var mt=U[Lt],ht=mt?"function"==typeof H?H:Tt:"function"==typeof ot?ot:Gt;X.scheduleMicroTask("Promise.then",function(){try{var yt=U[Vt],bt=!!J&&Ct===J[Ct];bt&&(J[it]=yt,J[Pt]=mt);var wt=X.run(ht,void 0,bt&&ht!==Gt&&ht!==Tt?[]:[yt]);Mt(J,!0,wt)}catch(_t){Mt(J,!1,_t)}},J)}var G=function(){},I=_.AggregateError,M=function(){function U(X){var J=this;if(!(J instanceof U))throw new Error("Must be an instanceof Promise.");J[Lt]=St,J[Vt]=[];try{X&&X(vt(J,true),vt(J,at))}catch(H){Mt(J,!1,H)}}return U.toString=function(){return"function ZoneAwarePromise() { [native code] }"},U.resolve=function(X){return Mt(new this(null),true,X)},U.reject=function(X){return Mt(new this(null),at,X)},U.any=function(X){if(!X||"function"!=typeof X[Symbol.iterator])return Promise.reject(new I([],"All promises were rejected"));var J=[],H=0;try{for(var ot=0,mt=X;ot<mt.length;ot++)H++,J.push(U.resolve(mt[ot]))}catch(wt){return Promise.reject(new I([],"All promises were rejected"))}if(0===H)return Promise.reject(new I([],"All promises were rejected"));var yt=!1,bt=[];return new U(function(wt,_t){for(var jt=0;jt<J.length;jt++)J[jt].then(function(ee){yt||(yt=!0,wt(ee))},function(ee){bt.push(ee),0==--H&&(yt=!0,_t(new I(bt,"All promises were rejected")))})})},U.race=function(X){var J,H,ot=new this(function(_t,jt){J=_t,H=jt});function mt(_t){J(_t)}function ht(_t){H(_t)}for(var yt=0,bt=X;yt<bt.length;yt++){var wt=bt[yt];gt(wt)||(wt=this.resolve(wt)),wt.then(mt,ht)}return ot},U.all=function(X){return U.allWithCallback(X)},U.allSettled=function(X){return(this&&this.prototype instanceof U?this:U).allWithCallback(X,{thenCallback:function(H){return{status:"fulfilled",value:H}},errorCallback:function(H){return{status:"rejected",reason:H}}})},U.allWithCallback=function(X,J){for(var H,ot,mt=new this(function(Xt,$t){H=Xt,ot=$t}),ht=2,yt=0,bt=[],wt=function(Xt){gt(Xt)||(Xt=_t.resolve(Xt));var $t=yt;try{Xt.then(function(Jt){bt[$t]=J?J.thenCallback(Jt):Jt,0==--ht&&H(bt)},function(Jt){J?(bt[$t]=J.errorCallback(Jt),0==--ht&&H(bt)):ot(Jt)})}catch(Jt){ot(Jt)}ht++,yt++},_t=this,jt=0,ee=X;jt<ee.length;jt++)wt(ee[jt]);return 0==(ht-=2)&&H(bt),mt},Object.defineProperty(U.prototype,Symbol.toStringTag,{get:function(){return"Promise"},enumerable:!1,configurable:!0}),Object.defineProperty(U.prototype,Symbol.species,{get:function(){return U},enumerable:!1,configurable:!0}),U.prototype.then=function(X,J){var H=this.constructor[Symbol.species];(!H||"function"!=typeof H)&&(H=this.constructor||U);var ot=new H(G),mt=S.current;return this[Lt]==St?this[Vt].push(mt,ot,X,J):Ht(this,mt,ot,X,J),ot},U.prototype.catch=function(X){return this.then(null,X)},U.prototype.finally=function(X){var J=this.constructor[Symbol.species];(!J||"function"!=typeof J)&&(J=U);var H=new J(G);H[Ct]=Ct;var ot=S.current;return this[Lt]==St?this[Vt].push(ot,H,X,X):Ht(this,ot,H,X,X),H},U}();M.resolve=M.resolve,M.reject=M.reject,M.race=M.race,M.all=M.all;var F=_[et]=_.Promise;_.Promise=M;var st=z("thenPatched");function Ft(U){var X=U.prototype,J=N(X,"then");if(!J||!1!==J.writable&&J.configurable){var H=X.then;X[Y]=H,U.prototype.then=function(ot,mt){var ht=this;return new M(function(bt,wt){H.call(ht,bt,wt)}).then(ot,mt)},U[st]=!0}}return D.patchThen=Ft,F&&(Ft(F),Z(_,"fetch",function(U){return function ge(U){return function(X,J){var H=U.apply(X,J);if(H instanceof M)return H;var ot=H.constructor;return ot[st]||Ft(ot),H}}(U)})),Promise[S.__symbol__("uncaughtPromiseErrors")]=K,M}),Zone.__load_patch("toString",function(_){var S=Function.prototype.toString,D=u("OriginalDelegate"),N=u("Promise"),W=u("Error"),V=function(){if("function"==typeof this){var et=this[D];if(et)return"function"==typeof et?S.call(et):Object.prototype.toString.call(et);if(this===Promise){var Y=_[N];if(Y)return S.call(Y)}if(this===Error){var rt=_[W];if(rt)return S.call(rt)}}return S.call(this)};V[D]=S,Function.prototype.toString=V;var z=Object.prototype.toString;Object.prototype.toString=function(){return"function"==typeof Promise&&this instanceof Promise?"[object Promise]":z.call(this)}});var oe=!1;if("undefined"!=typeof window)try{var pe=Object.defineProperty({},"passive",{get:function(){oe=!0}});window.addEventListener("test",pe,pe),window.removeEventListener("test",pe,pe)}catch(_){oe=!1}var Ce,me,_e,Ue,ye,ue={useG:!0},P={},q={},Q=new RegExp("^"+a+"(\\w+)(true|false)$"),tt=u("propagationStopped");function ut(_,S){var D=(S?S(_):_)+c,N=(S?S(_):_)+i,W=a+D,V=a+N;P[_]={},P[_][c]=W,P[_][i]=V}function pt(_,S,D,N){var W=N&&N.add||o,V=N&&N.rm||e,z=N&&N.listeners||"eventListeners",K=N&&N.rmAll||"removeAllListeners",$=u(W),et="."+W+":",Y="prependListener",nt=function(Ct,it,Pt){if(!Ct.isRemoved){var St,kt=Ct.callback;"object"==typeof kt&&kt.handleEvent&&(Ct.callback=function(It){return kt.handleEvent(It)},Ct.originalDelegate=kt);try{Ct.invoke(Ct,it,[Pt])}catch(It){St=It}var Rt=Ct.options;return Rt&&"object"==typeof Rt&&Rt.once&&it[V].call(it,Pt.type,Ct.originalDelegate?Ct.originalDelegate:Ct.callback,Rt),St}};function dt(Ct,it,Pt){if(it=it||_.event){var kt=Ct||it.target||_,St=kt[P[it.type][Pt?i:c]];if(St){var Rt=[];if(1===St.length)(at=nt(St[0],kt,it))&&Rt.push(at);else for(var It=St.slice(),vt=0;vt<It.length&&(!it||!0!==it[tt]);vt++){var at;(at=nt(It[vt],kt,it))&&Rt.push(at)}if(1===Rt.length)throw Rt[0];var ct=function(Et){var lt=Rt[Et];S.nativeScheduleMicroTask(function(){throw lt})};for(vt=0;vt<Rt.length;vt++)ct(vt)}}}var gt=function(Ct){return dt(this,Ct,!1)},Tt=function(Ct){return dt(this,Ct,!0)};function Gt(Ct,it){if(!Ct)return!1;var Pt=!0;it&&void 0!==it.useG&&(Pt=it.useG);var kt=it&&it.vh,St=!0;it&&void 0!==it.chkDup&&(St=it.chkDup);var Rt=!1;it&&void 0!==it.rt&&(Rt=it.rt);for(var at=Ct;at&&!at.hasOwnProperty(W);)at=b(at);if(!at&&Ct[W]&&(at=Ct),!at||at[$])return!1;var Nt,It=it&&it.eventNameToString,vt={},ct=at[$]=at[W],Et=at[u(V)]=at[V],lt=at[u(z)]=at[z],Mt=at[u(K)]=at[K];function le(H,ot){return!oe&&"object"==typeof H&&H?!!H.capture:oe&&ot?"boolean"==typeof H?{capture:H,passive:!0}:H?"object"==typeof H&&!1!==H.passive?Object.assign(Object.assign({},H),{passive:!0}):H:{passive:!0}:H}it&&it.prepend&&(Nt=at[u(it.prepend)]=at[it.prepend]);var F=Pt?function(H){if(!vt.isExisting)return ct.call(vt.target,vt.eventName,vt.capture?Tt:gt,vt.options)}:function(H){return ct.call(vt.target,vt.eventName,H.invoke,vt.options)},st=Pt?function(H){if(!H.isRemoved){var ot=P[H.eventName],mt=void 0;ot&&(mt=ot[H.capture?i:c]);var ht=mt&&H.target[mt];if(ht)for(var yt=0;yt<ht.length;yt++)if(ht[yt]===H){ht.splice(yt,1),H.isRemoved=!0,0===ht.length&&(H.allRemoved=!0,H.target[mt]=null);break}}if(H.allRemoved)return Et.call(H.target,H.eventName,H.capture?Tt:gt,H.options)}:function(H){return Et.call(H.target,H.eventName,H.invoke,H.options)},ge=it&&it.diff?it.diff:function(H,ot){var mt=typeof ot;return"function"===mt&&H.callback===ot||"object"===mt&&H.originalDelegate===ot},U=Zone[u("UNPATCHED_EVENTS")],X=_[u("PASSIVE_EVENTS")],J=function(H,ot,mt,ht,yt,bt){return void 0===yt&&(yt=!1),void 0===bt&&(bt=!1),function(){var wt=this||_,_t=arguments[0];it&&it.transferEventName&&(_t=it.transferEventName(_t));var jt=arguments[1];if(!jt)return H.apply(this,arguments);if(k&&"uncaughtException"===_t)return H.apply(this,arguments);var ee=!1;if("function"!=typeof jt){if(!jt.handleEvent)return H.apply(this,arguments);ee=!0}if(!kt||kt(H,jt,wt,arguments)){var Ee=oe&&!!X&&-1!==X.indexOf(_t),Xt=le(arguments[2],Ee);if(U)for(var $t=0;$t<U.length;$t++)if(_t===U[$t])return Ee?H.call(wt,_t,jt,Xt):H.apply(this,arguments);var Jt=!!Xt&&("boolean"==typeof Xt||Xt.capture),Pe=!(!Xt||"object"!=typeof Xt)&&Xt.once,rn=Zone.current,Je=P[_t];Je||(ut(_t,It),Je=P[_t]);var Ke=Je[Jt?i:c],Ne=wt[Ke],Xe=!1;if(Ne){if(Xe=!0,St)for($t=0;$t<Ne.length;$t++)if(ge(Ne[$t],jt))return}else Ne=wt[Ke]=[];var Ge,Ye=wt.constructor.name,$e=q[Ye];$e&&(Ge=$e[_t]),Ge||(Ge=Ye+ot+(It?It(_t):_t)),vt.options=Xt,Pe&&(vt.options.once=!1),vt.target=wt,vt.capture=Jt,vt.eventName=_t,vt.isExisting=Xe;var He=Pt?ue:void 0;He&&(He.taskData=vt);var Te=rn.scheduleEventTask(Ge,jt,He,mt,ht);if(vt.target=null,He&&(He.taskData=null),Pe&&(Xt.once=!0),!oe&&"boolean"==typeof Te.options||(Te.options=Xt),Te.target=wt,Te.capture=Jt,Te.eventName=_t,ee&&(Te.originalDelegate=jt),bt?Ne.unshift(Te):Ne.push(Te),yt)return wt}}};return at[W]=J(ct,et,F,st,Rt),Nt&&(at[Y]=J(Nt,".prependListener:",function(H){return Nt.call(vt.target,vt.eventName,H.invoke,vt.options)},st,Rt,!0)),at[V]=function(){var H=this||_,ot=arguments[0];it&&it.transferEventName&&(ot=it.transferEventName(ot));var mt=arguments[2],ht=!!mt&&("boolean"==typeof mt||mt.capture),yt=arguments[1];if(!yt)return Et.apply(this,arguments);if(!kt||kt(Et,yt,H,arguments)){var wt,bt=P[ot];bt&&(wt=bt[ht?i:c]);var _t=wt&&H[wt];if(_t)for(var jt=0;jt<_t.length;jt++){var ee=_t[jt];if(ge(ee,yt))return _t.splice(jt,1),ee.isRemoved=!0,0===_t.length&&(ee.allRemoved=!0,H[wt]=null,"string"==typeof ot)&&(H[a+"ON_PROPERTY"+ot]=null),ee.zone.cancelTask(ee),Rt?H:void 0}return Et.apply(this,arguments)}},at[z]=function(){var H=this||_,ot=arguments[0];it&&it.transferEventName&&(ot=it.transferEventName(ot));for(var mt=[],ht=xt(H,It?It(ot):ot),yt=0;yt<ht.length;yt++){var bt=ht[yt];mt.push(bt.originalDelegate?bt.originalDelegate:bt.callback)}return mt},at[K]=function(){var H=this||_,ot=arguments[0];if(ot){it&&it.transferEventName&&(ot=it.transferEventName(ot));var _t=P[ot];if(_t){var Ee=H[_t[c]],Xt=H[_t[i]];if(Ee)for(var $t=Ee.slice(),ht=0;ht<$t.length;ht++)this[V].call(this,ot,(Jt=$t[ht]).originalDelegate?Jt.originalDelegate:Jt.callback,Jt.options);if(Xt)for($t=Xt.slice(),ht=0;ht<$t.length;ht++){var Jt;this[V].call(this,ot,(Jt=$t[ht]).originalDelegate?Jt.originalDelegate:Jt.callback,Jt.options)}}}else{var mt=Object.keys(H);for(ht=0;ht<mt.length;ht++){var bt=Q.exec(mt[ht]),wt=bt&&bt[1];wt&&"removeListener"!==wt&&this[K].call(this,wt)}this[K].call(this,"removeListener")}if(Rt)return this},At(at[W],ct),At(at[V],Et),Mt&&At(at[K],Mt),lt&&At(at[z],lt),!0}for(var Lt=[],Vt=0;Vt<D.length;Vt++)Lt[Vt]=Gt(D[Vt],N);return Lt}function xt(_,S){if(!S){var D=[];for(var N in _){var W=Q.exec(N),V=W&&W[1];if(V&&(!S||V===S)){var z=_[N];if(z)for(var K=0;K<z.length;K++)D.push(z[K])}}return D}var $=P[S];$||(ut(S),$=P[S]);var et=_[$[c]],Y=_[$[i]];return et?Y?et.concat(Y):et.slice():Y?Y.slice():[]}function qt(_,S){var D=_.Event;D&&D.prototype&&S.patchMethod(D.prototype,"stopImmediatePropagation",function(N){return function(W,V){W[tt]=!0,N&&N.apply(W,V)}})}function te(_,S,D,N,W){var V=Zone.__symbol__(N);if(!S[V]){var z=S[V]=S[N];S[N]=function(K,$,et){return $&&$.prototype&&W.forEach(function(Y){var rt="".concat(D,".").concat(N,"::")+Y,nt=$.prototype;if(nt.hasOwnProperty(Y)){var dt=_.ObjectGetOwnPropertyDescriptor(nt,Y);dt&&dt.value?(dt.value=_.wrapWithCurrentZone(dt.value,rt),_._redefineProperty($.prototype,Y,dt)):nt[Y]&&(nt[Y]=_.wrapWithCurrentZone(nt[Y],rt))}else nt[Y]&&(nt[Y]=_.wrapWithCurrentZone(nt[Y],rt))}),z.call(S,K,$,et)},_.attachOriginToPatched(S[N],z)}}function ne(_,S,D){if(!D||0===D.length)return S;var N=D.filter(function(V){return V.target===_});if(!N||0===N.length)return S;var W=N[0].ignoreProperties;return S.filter(function(V){return-1===W.indexOf(V)})}function re(_,S,D,N){_&&C(_,ne(_,S,D),N)}function de(_){return Object.getOwnPropertyNames(_).filter(function(S){return S.startsWith("on")&&S.length>2}).map(function(S){return S.substring(2)})}function ke(_,S){if((!k||j)&&!Zone[_.symbol("patchEvents")]){var D=S.__Zone_ignore_on_properties,N=[];if(O){var W=window;N=N.concat(["Document","SVGElement","Element","HTMLElement","HTMLBodyElement","HTMLMediaElement","HTMLFrameSetElement","HTMLFrameElement","HTMLIFrameElement","HTMLMarqueeElement","Worker"]);var V=function Zt(){try{var _=t.navigator.userAgent;if(-1!==_.indexOf("MSIE ")||-1!==_.indexOf("Trident/"))return!0}catch(S){}return!1}()?[{target:W,ignoreProperties:["error"]}]:[];re(W,de(W),D&&D.concat(V),b(W))}N=N.concat(["XMLHttpRequest","XMLHttpRequestEventTarget","IDBIndex","IDBRequest","IDBOpenDBRequest","IDBDatabase","IDBTransaction","IDBCursor","WebSocket"]);for(var z=0;z<N.length;z++){var K=S[N[z]];K&&K.prototype&&re(K.prototype,de(K.prototype),D)}}}function Be(_,S,D){var N=D.configurable;return Fe(_,S,D=ae(_,S,D),N)}function ce(_,S){return _&&_[ye]&&_[ye][S]}function ae(_,S,D){return Object.isFrozen(D)||(D.configurable=!0),D.configurable||(!_[ye]&&!Object.isFrozen(_)&&me(_,ye,{writable:!0,value:{}}),_[ye]&&(_[ye][S]=!0)),D}function Fe(_,S,D,N){try{return me(_,S,D)}catch(z){if(!D.configurable)throw z;void 0===N?delete D.configurable:D.configurable=N;try{return me(_,S,D)}catch(K){var W=!1;if(("createdCallback"===S||"attachedCallback"===S||"detachedCallback"===S||"attributeChangedCallback"===S)&&(W=!0),!W)throw K;var V=null;try{V=JSON.stringify(D)}catch($){V=D.toString()}console.log("Attempting to configure '".concat(S,"' with descriptor '").concat(V,"' on object '").concat(_,"' and got error, giving up: ").concat(K))}}}function je(_,S){var D=_.getGlobalObjects();if((!D.isNode||D.isMix)&&!function We(_,S){var D=_.getGlobalObjects();if((D.isBrowser||D.isMix)&&!_.ObjectGetOwnPropertyDescriptor(HTMLElement.prototype,"onclick")&&"undefined"!=typeof Element){var V=_.ObjectGetOwnPropertyDescriptor(Element.prototype,"onclick");if(V&&!V.configurable)return!1;if(V){_.ObjectDefineProperty(Element.prototype,"onclick",{enumerable:!0,configurable:!0,get:function(){return!0}});var K=!!document.createElement("div").onclick;return _.ObjectDefineProperty(Element.prototype,"onclick",V),K}}var $=S.XMLHttpRequest;if(!$)return!1;var et="onreadystatechange",Y=$.prototype,rt=_.ObjectGetOwnPropertyDescriptor(Y,et);if(rt)return _.ObjectDefineProperty(Y,et,{enumerable:!0,configurable:!0,get:function(){return!0}}),K=!!(nt=new $).onreadystatechange,_.ObjectDefineProperty(Y,et,rt||{}),K;var dt=_.symbol("fake");_.ObjectDefineProperty(Y,et,{enumerable:!0,configurable:!0,get:function(){return this[dt]},set:function(Lt){this[dt]=Lt}});var nt,gt=function(){};return(nt=new $).onreadystatechange=gt,K=nt[dt]===gt,nt.onreadystatechange=null,K}(_,S)){var V="undefined"!=typeof WebSocket;(function se(_){for(var S=_.symbol("unbound"),D=function(W){var V=ie[W],z="on"+V;self.addEventListener(V,function(K){var et,Y,$=K.target;for(Y=$?$.constructor.name+"."+z:"unknown."+z;$;)$[z]&&!$[z][S]&&((et=_.wrapWithCurrentZone($[z],Y))[S]=$[z],$[z]=et),$=$.parentElement},!0)},N=0;N<ie.length;N++)D(N)})(_),_.patchClass("XMLHttpRequest"),V&&function be(_,S){var D=_.getGlobalObjects(),N=D.ADD_EVENT_LISTENER_STR,W=D.REMOVE_EVENT_LISTENER_STR,V=S.WebSocket;S.EventTarget||_.patchEventTarget(S,_,[V.prototype]),S.WebSocket=function($,et){var rt,nt,Y=arguments.length>1?new V($,et):new V($),dt=_.ObjectGetOwnPropertyDescriptor(Y,"onmessage");return dt&&!1===dt.configurable?(rt=_.ObjectCreate(Y),nt=Y,[N,W,"send","close"].forEach(function(gt){rt[gt]=function(){var Tt=_.ArraySlice.call(arguments);if(gt===N||gt===W){var Gt=Tt.length>0?Tt[0]:void 0;if(Gt){var Lt=Zone.__symbol__("ON_PROPERTY"+Gt);Y[Lt]=rt[Lt]}}return Y[gt].apply(Y,Tt)}})):rt=Y,_.patchOnProperties(rt,["close","error","message","open"],nt),rt};var z=S.WebSocket;for(var K in V)z[K]=V[K]}(_,S),Zone[_.symbol("patchEvents")]=!0}}Zone.__load_patch("util",function(_,S,D){var N=de(_);D.patchOnProperties=C,D.patchMethod=Z,D.bindArguments=A,D.patchMacroTask=ft;var W=S.__symbol__("BLACK_LISTED_EVENTS"),V=S.__symbol__("UNPATCHED_EVENTS");_[V]&&(_[W]=_[V]),_[W]&&(S[W]=S[V]=_[W]),D.patchEventPrototype=qt,D.patchEventTarget=pt,D.isIEOrEdge=fe,D.ObjectDefineProperty=E,D.ObjectGetOwnPropertyDescriptor=v,D.ObjectCreate=y,D.ArraySlice=l,D.patchClass=B,D.wrapWithCurrentZone=n,D.filterProperties=ne,D.attachOriginToPatched=At,D._redefineProperty=Object.defineProperty,D.patchCallbacks=te,D.getGlobalObjects=function(){return{globalSources:q,zoneSymbolEventNames:P,eventNames:N,isBrowser:O,isMix:j,isNode:k,TRUE_STR:i,FALSE_STR:c,ZONE_SYMBOL_PREFIX:a,ADD_EVENT_LISTENER_STR:o,REMOVE_EVENT_LISTENER_STR:e}}});var _,S,ie=Kt(Kt(Kt(Kt(Kt(Kt(Kt(Kt([],["abort","animationcancel","animationend","animationiteration","auxclick","beforeinput","blur","cancel","canplay","canplaythrough","change","compositionstart","compositionupdate","compositionend","cuechange","click","close","contextmenu","curechange","dblclick","drag","dragend","dragenter","dragexit","dragleave","dragover","drop","durationchange","emptied","ended","error","focus","focusin","focusout","gotpointercapture","input","invalid","keydown","keypress","keyup","load","loadstart","loadeddata","loadedmetadata","lostpointercapture","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","mousewheel","orientationchange","pause","play","playing","pointercancel","pointerdown","pointerenter","pointerleave","pointerlockchange","mozpointerlockchange","webkitpointerlockerchange","pointerlockerror","mozpointerlockerror","webkitpointerlockerror","pointermove","pointout","pointerover","pointerup","progress","ratechange","reset","resize","scroll","seeked","seeking","select","selectionchange","selectstart","show","sort","stalled","submit","suspend","timeupdate","volumechange","touchcancel","touchmove","touchstart","touchend","transitioncancel","transitionend","waiting","wheel"],!0),["webglcontextrestored","webglcontextlost","webglcontextcreationerror"],!0),["autocomplete","autocompleteerror"],!0),["toggle"],!0),["afterscriptexecute","beforescriptexecute","DOMContentLoaded","freeze","fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange","fullscreenerror","mozfullscreenerror","webkitfullscreenerror","msfullscreenerror","readystatechange","visibilitychange","resume"],!0),["absolutedeviceorientation","afterinput","afterprint","appinstalled","beforeinstallprompt","beforeprint","beforeunload","devicelight","devicemotion","deviceorientation","deviceorientationabsolute","deviceproximity","hashchange","languagechange","message","mozbeforepaint","offline","online","paint","pageshow","pagehide","popstate","rejectionhandled","storage","unhandledrejection","unload","userproximity","vrdisplayconnected","vrdisplaydisconnected","vrdisplaypresentchange"],!0),["beforecopy","beforecut","beforepaste","copy","cut","paste","dragstart","loadend","animationstart","search","transitionrun","transitionstart","webkitanimationend","webkitanimationiteration","webkitanimationstart","webkittransitionend"],!0),["activate","afterupdate","ariarequest","beforeactivate","beforedeactivate","beforeeditfocus","beforeupdate","cellchange","controlselect","dataavailable","datasetchanged","datasetcomplete","errorupdate","filterchange","layoutcomplete","losecapture","move","moveend","movestart","propertychange","resizeend","resizestart","rowenter","rowexit","rowsdelete","rowsinserted","command","compassneedscalibration","deactivate","help","mscontentzoom","msmanipulationstatechanged","msgesturechange","msgesturedoubletap","msgestureend","msgesturehold","msgesturestart","msgesturetap","msgotpointercapture","msinertiastart","mslostpointercapture","mspointercancel","mspointerdown","mspointerenter","mspointerhover","mspointerleave","mspointermove","mspointerout","mspointerover","mspointerup","pointerout","mssitemodejumplistitemremoved","msthumbnailclick","stop","storagecommit"],!0);_="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},S=_.__Zone_symbol_prefix||"__zone_symbol__",_[function D(N){return S+N}("legacyPatch")]=function(){var N=_.Zone;N.__load_patch("defineProperty",function(W,V,z){z._redefineProperty=Be,function Me(){Ce=Zone.__symbol__,me=Object[Ce("defineProperty")]=Object.defineProperty,_e=Object[Ce("getOwnPropertyDescriptor")]=Object.getOwnPropertyDescriptor,Ue=Object.create,ye=Ce("unconfigurables"),Object.defineProperty=function(_,S,D){if(ce(_,S))throw new TypeError("Cannot assign to read only property '"+S+"' of "+_);var N=D.configurable;return"prototype"!==S&&(D=ae(_,S,D)),Fe(_,S,D,N)},Object.defineProperties=function(_,S){Object.keys(S).forEach(function(z){Object.defineProperty(_,z,S[z])});for(var D=0,N=Object.getOwnPropertySymbols(S);D<N.length;D++){var W=N[D],V=Object.getOwnPropertyDescriptor(S,W);(null==V?void 0:V.enumerable)&&Object.defineProperty(_,W,S[W])}return _},Object.create=function(_,S){return"object"==typeof S&&!Object.isFrozen(S)&&Object.keys(S).forEach(function(D){S[D]=ae(_,D,S[D])}),Ue(_,S)},Object.getOwnPropertyDescriptor=function(_,S){var D=_e(_,S);return D&&ce(_,S)&&(D.configurable=!1),D}}()}),N.__load_patch("registerElement",function(W,V,z){!function Oe(_,S){var D=S.getGlobalObjects();(D.isBrowser||D.isMix)&&"registerElement"in _.document&&S.patchCallbacks(S,document,"Document","registerElement",["createdCallback","attachedCallback","detachedCallback","attributeChangedCallback"])}(W,z)}),N.__load_patch("EventTargetLegacy",function(W,V,z){(function Ot(_,S){var D=S.getGlobalObjects(),N=D.eventNames,W=D.globalSources,V=D.zoneSymbolEventNames,z=D.TRUE_STR,K=D.FALSE_STR,$=D.ZONE_SYMBOL_PREFIX,Y="ApplicationCache,EventSource,FileReader,InputMethodContext,MediaController,MessagePort,Node,Performance,SVGElementInstance,SharedWorker,TextTrack,TextTrackCue,TextTrackList,WebKitNamedFlow,Window,Worker,WorkerGlobalScope,XMLHttpRequest,XMLHttpRequestEventTarget,XMLHttpRequestUpload,IDBRequest,IDBOpenDBRequest,IDBDatabase,IDBTransaction,IDBCursor,DBIndex,WebSocket".split(","),rt="EventTarget",nt=[],dt=_.wtf,gt="Anchor,Area,Audio,BR,Base,BaseFont,Body,Button,Canvas,Content,DList,Directory,Div,Embed,FieldSet,Font,Form,Frame,FrameSet,HR,Head,Heading,Html,IFrame,Image,Input,Keygen,LI,Label,Legend,Link,Map,Marquee,Media,Menu,Meta,Meter,Mod,OList,Object,OptGroup,Option,Output,Paragraph,Pre,Progress,Quote,Script,Select,Source,Span,Style,TableCaption,TableCell,TableCol,Table,TableRow,TableSection,TextArea,Title,Track,UList,Unknown,Video".split(",");dt?nt=gt.map(function(Ht){return"HTML"+Ht+"Element"}).concat(Y):_[rt]?nt.push(rt):nt=Y;for(var Tt=_.__Zone_disable_IE_check||!1,Gt=_.__Zone_enable_cross_context_check||!1,Lt=S.isIEOrEdge(),Ct="[object FunctionWrapper]",it="function __BROWSERTOOLS_CONSOLE_SAFEFUNC() { [native code] }",Pt={MSPointerCancel:"pointercancel",MSPointerDown:"pointerdown",MSPointerEnter:"pointerenter",MSPointerHover:"pointerhover",MSPointerLeave:"pointerleave",MSPointerMove:"pointermove",MSPointerOut:"pointerout",MSPointerOver:"pointerover",MSPointerUp:"pointerup"},kt=0;kt<N.length;kt++){var It=$+((St=N[kt])+K),vt=$+(St+z);V[St]={},V[St][K]=It,V[St][z]=vt}for(kt=0;kt<gt.length;kt++)for(var ct=gt[kt],Et=W[ct]={},lt=0;lt<N.length;lt++){var St;Et[St=N[lt]]=ct+".addEventListener:"+St}var Nt=[];for(kt=0;kt<nt.length;kt++){var le=_[nt[kt]];Nt.push(le&&le.prototype)}return S.patchEventTarget(_,S,Nt,{vh:function(Ht,Bt,G,I){if(!Tt&&Lt)if(Gt)try{if((M=Bt.toString())===Ct||M==it)return Ht.apply(G,I),!1}catch(F){return Ht.apply(G,I),!1}else{var M;if((M=Bt.toString())===Ct||M==it)return Ht.apply(G,I),!1}else if(Gt)try{Bt.toString()}catch(F){return Ht.apply(G,I),!1}return!0},transferEventName:function(Ht){return Pt[Ht]||Ht}}),Zone[S.symbol("patchEventTarget")]=!!_[rt],!0})(W,z),je(z,W)})};var Ae=u("zoneTask");function we(_,S,D,N){var W=null,V=null;D+=N;var z={};function K(et){var Y=et.data;return Y.args[0]=function(){return et.invoke.apply(this,arguments)},Y.handleId=W.apply(_,Y.args),et}function $(et){return V.call(_,et.data.handleId)}W=Z(_,S+=N,function(et){return function(Y,rt){if("function"==typeof rt[0]){var nt={isPeriodic:"Interval"===N,delay:"Timeout"===N||"Interval"===N?rt[1]||0:void 0,args:rt},dt=rt[0];rt[0]=function(){try{return dt.apply(this,arguments)}finally{nt.isPeriodic||("number"==typeof nt.handleId?delete z[nt.handleId]:nt.handleId&&(nt.handleId[Ae]=null))}};var gt=p(S,rt[0],nt,K,$);if(!gt)return gt;var Tt=gt.data.handleId;return"number"==typeof Tt?z[Tt]=gt:Tt&&(Tt[Ae]=gt),Tt&&Tt.ref&&Tt.unref&&"function"==typeof Tt.ref&&"function"==typeof Tt.unref&&(gt.ref=Tt.ref.bind(Tt),gt.unref=Tt.unref.bind(Tt)),"number"==typeof Tt||Tt?Tt:gt}return et.apply(_,rt)}}),V=Z(_,D,function(et){return function(Y,rt){var dt,nt=rt[0];"number"==typeof nt?dt=z[nt]:(dt=nt&&nt[Ae])||(dt=nt),dt&&"string"==typeof dt.type?"notScheduled"!==dt.state&&(dt.cancelFn&&dt.data.isPeriodic||0===dt.runCount)&&("number"==typeof nt?delete z[nt]:nt&&(nt[Ae]=null),dt.zone.cancelTask(dt)):et.apply(_,rt)}})}Zone.__load_patch("legacy",function(_){var S=_[Zone.__symbol__("legacyPatch")];S&&S()}),Zone.__load_patch("queueMicrotask",function(_,S,D){D.patchMethod(_,"queueMicrotask",function(N){return function(W,V){S.current.scheduleMicroTask("queueMicrotask",V[0])}})}),Zone.__load_patch("timers",function(_){var S="set",D="clear";we(_,S,D,"Timeout"),we(_,S,D,"Interval"),we(_,S,D,"Immediate")}),Zone.__load_patch("requestAnimationFrame",function(_){we(_,"request","cancel","AnimationFrame"),we(_,"mozRequest","mozCancel","AnimationFrame"),we(_,"webkitRequest","webkitCancel","AnimationFrame")}),Zone.__load_patch("blocking",function(_,S){for(var D=["alert","prompt","confirm"],N=0;N<D.length;N++)Z(_,D[N],function(V,z,K){return function($,et){return S.current.run(V,_,et,K)}})}),Zone.__load_patch("EventTarget",function(_,S,D){(function nn(_,S){S.patchEventPrototype(_,S)})(_,D),function en(_,S){if(!Zone[S.symbol("patchEventTarget")]){for(var D=S.getGlobalObjects(),N=D.eventNames,W=D.zoneSymbolEventNames,V=D.TRUE_STR,z=D.FALSE_STR,K=D.ZONE_SYMBOL_PREFIX,$=0;$<N.length;$++){var et=N[$],nt=K+(et+z),dt=K+(et+V);W[et]={},W[et][z]=nt,W[et][V]=dt}var gt=_.EventTarget;if(gt&&gt.prototype)return S.patchEventTarget(_,S,[gt&&gt.prototype]),!0}}(_,D);var N=_.XMLHttpRequestEventTarget;N&&N.prototype&&D.patchEventTarget(_,D,[N.prototype])}),Zone.__load_patch("MutationObserver",function(_,S,D){B("MutationObserver"),B("WebKitMutationObserver")}),Zone.__load_patch("IntersectionObserver",function(_,S,D){B("IntersectionObserver")}),Zone.__load_patch("FileReader",function(_,S,D){B("FileReader")}),Zone.__load_patch("on_property",function(_,S,D){ke(D,_)}),Zone.__load_patch("customElements",function(_,S,D){!function Ze(_,S){var D=S.getGlobalObjects();(D.isBrowser||D.isMix)&&_.customElements&&"customElements"in _&&S.patchCallbacks(S,_.customElements,"customElements","define",["connectedCallback","disconnectedCallback","adoptedCallback","attributeChangedCallback"])}(_,D)}),Zone.__load_patch("XHR",function(_,S){!function $(et){var Y=et.XMLHttpRequest;if(Y){var rt=Y.prototype,dt=rt[s],gt=rt[d];if(!dt){var Tt=et.XMLHttpRequestEventTarget;if(Tt){var Gt=Tt.prototype;dt=Gt[s],gt=Gt[d]}}var Lt="readystatechange",Vt="scheduled",kt=Z(rt,"open",function(){return function(ct,Et){return ct[N]=0==Et[2],ct[z]=Et[1],kt.apply(ct,Et)}}),Rt=u("fetchTaskAborting"),at=u("fetchTaskScheduling"),It=Z(rt,"send",function(){return function(ct,Et){if(!0===S.current[at]||ct[N])return It.apply(ct,Et);var lt={target:ct,url:ct[z],isPeriodic:!1,args:Et,aborted:!1},Mt=p("XMLHttpRequest.send",it,lt,Ct,Pt);ct&&!0===ct[K]&&!lt.aborted&&Mt.state===Vt&&Mt.invoke()}}),vt=Z(rt,"abort",function(){return function(ct,Et){var lt=function nt(ct){return ct[D]}(ct);if(lt&&"string"==typeof lt.type){if(null==lt.cancelFn||lt.data&&lt.data.aborted)return;lt.zone.cancelTask(lt)}else if(!0===S.current[Rt])return vt.apply(ct,Et)}})}function Ct(ct){var Et=ct.data,lt=Et.target;lt[V]=!1,lt[K]=!1;var Mt=lt[W];dt||(dt=lt[s],gt=lt[d]),Mt&&gt.call(lt,Lt,Mt);var Nt=lt[W]=function(){if(lt.readyState===lt.DONE)if(!Et.aborted&&lt[V]&&ct.state===Vt){var Ht=lt[S.__symbol__("loadfalse")];if(0!==lt.status&&Ht&&Ht.length>0){var Bt=ct.invoke;ct.invoke=function(){for(var G=lt[S.__symbol__("loadfalse")],I=0;I<G.length;I++)G[I]===ct&&G.splice(I,1);!Et.aborted&&ct.state===Vt&&Bt.call(ct)},Ht.push(ct)}else ct.invoke()}else!Et.aborted&&!1===lt[V]&&(lt[K]=!0)};return dt.call(lt,Lt,Nt),lt[D]||(lt[D]=ct),It.apply(lt,Et.args),lt[V]=!0,ct}function it(){}function Pt(ct){var Et=ct.data;return Et.aborted=!0,vt.apply(Et.target,Et.args)}}(_);var D=u("xhrTask"),N=u("xhrSync"),W=u("xhrListener"),V=u("xhrScheduled"),z=u("xhrURL"),K=u("xhrErrorBeforeScheduled")}),Zone.__load_patch("geolocation",function(_){_.navigator&&_.navigator.geolocation&&function f(_,S){for(var D=_.constructor.name,N=function(V){var et,Y,z=S[V],K=_[z];if(K){if(!g(v(_,z)))return"continue";_[z]=(Y=function(){return et.apply(this,A(arguments,D+"."+z))},At(Y,et=K),Y)}},W=0;W<S.length;W++)N(W)}(_.navigator.geolocation,["getCurrentPosition","watchPosition"])}),Zone.__load_patch("PromiseRejectionEvent",function(_,S){function D(N){return function(W){xt(_,N).forEach(function(z){var K=_.PromiseRejectionEvent;if(K){var $=new K(N,{promise:W.promise,reason:W.rejection});z.invoke($)}})}}_.PromiseRejectionEvent&&(S[u("unhandledPromiseRejectionHandler")]=D("unhandledrejection"),S[u("rejectionHandledHandler")]=D("rejectionhandled"))})},void 0!==(ve=he.call(zt,Yt,zt,Ut))&&(Ut.exports=ve)}},Ut=>{Ut(Ut.s=5948)}]);